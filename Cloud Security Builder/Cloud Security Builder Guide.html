<!DOCTYPE html>
<!-- saved from url=(0040)file:///C:/Users/chara/Downloads/IG.html -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="viewport" content="width=device-width initial-scale=1">

<link href="./IG-v1_files/css" rel="stylesheet" type="text/css"><style type="text/css">html {overflow-x: initial !important;}:root { --bg-color: #ffffff; --text-color: #333333; --select-text-bg-color: #B5D6FC; --select-text-font-color: auto; --monospace: "Lucida Console",Consolas,"Courier",monospace; --title-bar-height: 20px; }
.mac-os-11 { --title-bar-height: 28px; }
html { font-size: 14px; background-color: var(--bg-color); color: var(--text-color); font-family: "Helvetica Neue", Helvetica, Arial, sans-serif; -webkit-font-smoothing: antialiased; }
h1, h2, h3, h4, h5 { white-space: pre-wrap; }
body { margin: 0px; padding: 0px; height: auto; inset: 0px; font-size: 1rem; line-height: 1.428571; overflow-x: hidden; background: inherit; tab-size: 4; }
iframe { margin: auto; }
a.url { word-break: break-all; }
a:active, a:hover { outline: 0px; }
.in-text-selection, ::selection { text-shadow: none; background: var(--select-text-bg-color); color: var(--select-text-font-color); }
#write { margin: 0px auto; height: auto; width: inherit; word-break: normal; overflow-wrap: break-word; position: relative; white-space: normal; overflow-x: visible; padding-top: 36px; }
#write.first-line-indent p { text-indent: 2em; }
#write.first-line-indent li p, #write.first-line-indent p * { text-indent: 0px; }
#write.first-line-indent li { margin-left: 2em; }
.for-image #write { padding-left: 8px; padding-right: 8px; }
body.typora-export { padding-left: 30px; padding-right: 30px; }
.typora-export .footnote-line, .typora-export li, .typora-export p { white-space: pre-wrap; }
.typora-export .task-list-item input { pointer-events: none; }
@media screen and (max-width: 500px) {
  body.typora-export { padding-left: 0px; padding-right: 0px; }
  #write { padding-left: 20px; padding-right: 20px; }
}
#write li > figure:last-child { margin-bottom: 0.5rem; }
#write ol, #write ul { position: relative; }
img { max-width: 100%; vertical-align: middle; image-orientation: from-image; }
button, input, select, textarea { color: inherit; font-style: inherit; font-variant-caps: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; font-size-adjust: inherit; font-kerning: inherit; font-variant-alternates: inherit; font-variant-ligatures: inherit; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-variant-position: inherit; font-feature-settings: inherit; font-optical-sizing: inherit; font-variation-settings: inherit; }
input[type="checkbox"], input[type="radio"] { line-height: normal; padding: 0px; }
*, ::after, ::before { box-sizing: border-box; }
#write h1, #write h2, #write h3, #write h4, #write h5, #write h6, #write p, #write pre { width: inherit; }
#write h1, #write h2, #write h3, #write h4, #write h5, #write h6, #write p { position: relative; }
p { line-height: inherit; }
h1, h2, h3, h4, h5, h6 { break-after: avoid-page; break-inside: avoid; orphans: 4; }
p { orphans: 4; }
h1 { font-size: 2rem; }
h2 { font-size: 1.8rem; }
h3 { font-size: 1.6rem; }
h4 { font-size: 1.4rem; }
h5 { font-size: 1.2rem; }
h6 { font-size: 1rem; }
.md-math-block, .md-rawblock, h1, h2, h3, h4, h5, h6, p { margin-top: 1rem; margin-bottom: 1rem; }
.hidden { display: none; }
.md-blockmeta { color: rgb(204, 204, 204); font-weight: 700; font-style: italic; }
a { cursor: pointer; }
sup.md-footnote { padding: 2px 4px; background-color: rgba(238, 238, 238, 0.7); color: rgb(85, 85, 85); border-radius: 4px; cursor: pointer; }
sup.md-footnote a, sup.md-footnote a:hover { color: inherit; text-transform: inherit; text-decoration: inherit; }
#write input[type="checkbox"] { cursor: pointer; width: inherit; height: inherit; }
figure { overflow-x: auto; margin: 1.2em 0px; max-width: calc(100% + 16px); padding: 0px; }
figure > table { margin: 0px; }
thead, tr { break-inside: avoid; break-after: auto; }
thead { display: table-header-group; }
table { border-collapse: collapse; border-spacing: 0px; width: 100%; overflow: auto; break-inside: auto; text-align: left; }
table.md-table td { min-width: 32px; }
.CodeMirror-gutters { border-right-width: 0px; border-right-style: none; border-right-color: currentcolor; background-color: inherit; }
.CodeMirror-linenumber { -webkit-user-select: none; }
.CodeMirror { text-align: left; }
.CodeMirror-placeholder { opacity: 0.3; }
.CodeMirror pre { padding: 0px 4px; }
.CodeMirror-lines { padding: 0px; }
div.hr:focus { cursor: none; }
#write pre { white-space: pre-wrap; }
#write.fences-no-line-wrapping pre { white-space: pre; }
#write pre.ty-contain-cm { white-space: normal; }
.CodeMirror-gutters { margin-right: 4px; }
.md-fences { font-size: 0.9rem; display: block; break-inside: avoid; text-align: left; overflow: visible; white-space: pre; background: inherit; position: relative !important; }
.md-fences-adv-panel { width: 100%; margin-top: 10px; text-align: center; padding-top: 0px; padding-bottom: 8px; overflow-x: auto; }
#write .md-fences.mock-cm { white-space: pre-wrap; }
.md-fences.md-fences-with-lineno { padding-left: 0px; }
#write.fences-no-line-wrapping .md-fences.mock-cm { white-space: pre; overflow-x: auto; }
.md-fences.mock-cm.md-fences-with-lineno { padding-left: 8px; }
.CodeMirror-line, twitterwidget { break-inside: avoid; }
svg { break-inside: avoid; }
.footnotes { opacity: 0.8; font-size: 0.9rem; margin-top: 1em; margin-bottom: 1em; }
.footnotes + .footnotes { margin-top: 0px; }
.md-reset { margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: top; background: 0px 0px; text-decoration: none; text-shadow: none; float: none; position: static; width: auto; height: auto; white-space: nowrap; cursor: inherit; line-height: normal; font-weight: 400; text-align: left; box-sizing: content-box; direction: ltr; }
li div { padding-top: 0px; }
blockquote { margin: 1rem 0px; }
li .mathjax-block, li p { margin: 0.5rem 0px; }
li blockquote { margin: 1rem 0px; }
li { margin: 0px; position: relative; }
blockquote > :last-child { margin-bottom: 0px; }
blockquote > :first-child, li > :first-child { margin-top: 0px; }
.footnotes-area { color: rgb(136, 136, 136); margin-top: 0.714rem; padding-bottom: 0.143rem; white-space: normal; }
#write .footnote-line { white-space: pre-wrap; }
@media print {
  body, html { border: 1px solid transparent; height: 99%; break-after: avoid; break-before: avoid; font-variant-ligatures: no-common-ligatures; }
  #write { margin-top: 0px; border-color: transparent !important; padding-top: 0px !important; padding-bottom: 0px !important; }
  .typora-export * { print-color-adjust: exact; }
  .typora-export #write { break-after: avoid; }
  .typora-export #write::after { height: 0px; }
  .is-mac table { break-inside: avoid; }
  #write > p:nth-child(1) { margin-top: 0px; }
  .typora-export-show-outline .typora-export-sidebar { display: none; }
  figure { overflow-x: visible; }
}
.footnote-line { margin-top: 0.714em; font-size: 0.7em; }
a img, img a { cursor: pointer; }
pre.md-meta-block { font-size: 0.8rem; min-height: 0.8rem; white-space: pre-wrap; background: rgb(204, 204, 204); display: block; overflow-x: hidden; }
p > .md-image:only-child:not(.md-img-error) img, p > img:only-child { display: block; margin: auto; }
#write.first-line-indent p > .md-image:only-child:not(.md-img-error) img { left: -2em; position: relative; }
p > .md-image:only-child { display: inline-block; width: 100%; }
#write .MathJax_Display { margin: 0.8em 0px 0px; }
.md-math-block { width: 100%; }
.md-math-block:not(:empty)::after { display: none; }
.MathJax_ref { fill: currentcolor; }
[contenteditable="true"]:active, [contenteditable="true"]:focus, [contenteditable="false"]:active, [contenteditable="false"]:focus { outline: 0px; box-shadow: none; }
.md-task-list-item { position: relative; list-style-type: none; }
.task-list-item.md-task-list-item { padding-left: 0px; }
.md-task-list-item > input { position: absolute; top: 0px; left: 0px; margin-left: -1.2em; margin-top: calc(1em - 10px); border: medium; }
.math { font-size: 1rem; }
.md-toc { min-height: 3.58rem; position: relative; font-size: 0.9rem; border-radius: 10px; }
.md-toc-content { position: relative; margin-left: 0px; }
.md-toc-content::after, .md-toc::after { display: none; }
.md-toc-item { display: block; color: rgb(65, 131, 196); }
.md-toc-item a { text-decoration: none; }
.md-toc-inner:hover { text-decoration: underline; }
.md-toc-inner { display: inline-block; cursor: pointer; }
.md-toc-h1 .md-toc-inner { margin-left: 0px; font-weight: 700; }
.md-toc-h2 .md-toc-inner { margin-left: 2em; }
.md-toc-h3 .md-toc-inner { margin-left: 4em; }
.md-toc-h4 .md-toc-inner { margin-left: 6em; }
.md-toc-h5 .md-toc-inner { margin-left: 8em; }
.md-toc-h6 .md-toc-inner { margin-left: 10em; }
@media screen and (max-width: 48em) {
  .md-toc-h3 .md-toc-inner { margin-left: 3.5em; }
  .md-toc-h4 .md-toc-inner { margin-left: 5em; }
  .md-toc-h5 .md-toc-inner { margin-left: 6.5em; }
  .md-toc-h6 .md-toc-inner { margin-left: 8em; }
}
a.md-toc-inner { font-size: inherit; font-style: inherit; font-weight: inherit; line-height: inherit; }
.footnote-line a:not(.reversefootnote) { color: inherit; }
.reversefootnote { font-family: ui-monospace, sans-serif; }
.md-attr { display: none; }
.md-fn-count::after { content: "."; }
code, pre, samp, tt { font-family: var(--monospace); }
kbd { margin: 0px 0.1em; padding: 0.1em 0.6em; font-size: 0.8em; color: rgb(36, 39, 41); background: rgb(255, 255, 255); border: 1px solid rgb(173, 179, 185); border-radius: 3px; box-shadow: rgba(12, 13, 14, 0.2) 0px 1px 0px, rgb(255, 255, 255) 0px 0px 0px 2px inset; white-space: nowrap; vertical-align: middle; }
.md-comment { color: rgb(162, 127, 3); opacity: 0.6; font-family: var(--monospace); }
code { text-align: left; vertical-align: initial; }
a.md-print-anchor { white-space: pre !important; border-width: medium !important; border-style: none !important; border-color: currentcolor !important; display: inline-block !important; position: absolute !important; width: 1px !important; right: 0px !important; outline: 0px !important; background: 0px 0px !important; text-decoration: initial !important; text-shadow: initial !important; }
.os-windows.monocolor-emoji .md-emoji { font-family: "Segoe UI Symbol", sans-serif; }
.md-diagram-panel > svg { max-width: 100%; }
[lang="flow"] svg, [lang="mermaid"] svg { max-width: 100%; height: auto; }
[lang="mermaid"] .node text { font-size: 1rem; }
table tr th { border-bottom-width: 0px; border-bottom-style: none; border-bottom-color: currentcolor; }
video { max-width: 100%; display: block; margin: 0px auto; }
iframe { max-width: 100%; width: 100%; border: medium; }
.highlight td, .highlight tr { border: 0px; }
mark { background: rgb(255, 255, 0); color: rgb(0, 0, 0); }
.md-html-inline .md-plain, .md-html-inline strong, mark .md-inline-math, mark strong { color: inherit; }
.md-expand mark .md-meta { opacity: 0.3 !important; }
mark .md-meta { color: rgb(0, 0, 0); }
@media print {
  .typora-export h1, .typora-export h2, .typora-export h3, .typora-export h4, .typora-export h5, .typora-export h6 { break-inside: avoid; }
}
.md-diagram-panel .messageText { stroke: none !important; }
.md-diagram-panel .start-state { fill: var(--node-fill); }
.md-diagram-panel .edgeLabel rect { opacity: 1 !important; }
.md-fences.md-fences-math { font-size: 1em; }
.md-fences-advanced:not(.md-focus) { padding: 0px; white-space: nowrap; border: 0px; }
.md-fences-advanced:not(.md-focus) { background: inherit; }
.typora-export-show-outline .typora-export-content { max-width: 1440px; margin: auto; display: flex; flex-direction: row; }
.typora-export-sidebar { width: 300px; font-size: 0.8rem; margin-top: 80px; margin-right: 18px; }
.typora-export-show-outline #write { --webkit-flex: 2; flex: 2 1 0%; }
.typora-export-sidebar .outline-content { position: fixed; top: 0px; max-height: 100%; overflow: hidden auto; padding-bottom: 30px; padding-top: 60px; width: 300px; }
@media screen and (max-width: 1024px) {
  .typora-export-sidebar, .typora-export-sidebar .outline-content { width: 240px; }
}
@media screen and (max-width: 800px) {
  .typora-export-sidebar { display: none; }
}
.outline-content li, .outline-content ul { margin-left: 0px; margin-right: 0px; padding-left: 0px; padding-right: 0px; list-style: none; overflow-wrap: anywhere; }
.outline-content ul { margin-top: 0px; margin-bottom: 0px; }
.outline-content strong { font-weight: 400; }
.outline-expander { width: 1rem; height: 1.428571rem; position: relative; display: table-cell; vertical-align: middle; cursor: pointer; padding-left: 4px; }
.outline-expander::before { content: ""; position: relative; font-family: Ionicons; display: inline-block; font-size: 8px; vertical-align: middle; }
.outline-item { padding-top: 3px; padding-bottom: 3px; cursor: pointer; }
.outline-expander:hover::before { content: ""; }
.outline-h1 > .outline-item { padding-left: 0px; }
.outline-h2 > .outline-item { padding-left: 1em; }
.outline-h3 > .outline-item { padding-left: 2em; }
.outline-h4 > .outline-item { padding-left: 3em; }
.outline-h5 > .outline-item { padding-left: 4em; }
.outline-h6 > .outline-item { padding-left: 5em; }
.outline-label { cursor: pointer; display: table-cell; vertical-align: middle; text-decoration: none; color: inherit; }
.outline-label:hover { text-decoration: underline; }
.outline-item:hover { border-color: rgb(245, 245, 245); background-color: var(--item-hover-bg-color); }
.outline-item:hover { margin-left: -28px; margin-right: -28px; border-left-width: 28px; border-left-style: solid; border-left-color: transparent; border-right-width: 28px; border-right-style: solid; border-right-color: transparent; }
.outline-item-single .outline-expander::before, .outline-item-single .outline-expander:hover::before { display: none; }
.outline-item-open > .outline-item > .outline-expander::before { content: ""; }
.outline-children { display: none; }
.info-panel-tab-wrapper { display: none; }
.outline-item-open > .outline-children { display: block; }
.typora-export .outline-item { padding-top: 1px; padding-bottom: 1px; }
.typora-export .outline-item:hover { margin-right: -8px; border-right-width: 8px; border-right-style: solid; border-right-color: transparent; }
.typora-export .outline-expander::before { content: "+"; font-family: inherit; top: -1px; }
.typora-export .outline-expander:hover::before, .typora-export .outline-item-open > .outline-item > .outline-expander::before { content: "−"; }
.typora-export-collapse-outline .outline-children { display: none; }
.typora-export-collapse-outline .outline-item-open > .outline-children, .typora-export-no-collapse-outline .outline-children { display: block; }
.typora-export-no-collapse-outline .outline-expander::before { content: "" !important; }
.typora-export-show-outline .outline-item-active > .outline-item .outline-label { font-weight: 700; }
.md-inline-math-container mjx-container { zoom: 0.95; }
mjx-container { break-inside: avoid; }


.CodeMirror { height: auto; }
.CodeMirror.cm-s-inner { background: inherit; }
.CodeMirror-scroll { overflow: auto hidden; z-index: 3; }
.CodeMirror-gutter-filler, .CodeMirror-scrollbar-filler { background-color: rgb(255, 255, 255); }
.CodeMirror-gutters { border-right-width: 1px; border-right-style: solid; border-right-color: rgb(221, 221, 221); background: inherit; white-space: nowrap; }
.CodeMirror-linenumber { padding: 0px 3px 0px 5px; text-align: right; color: rgb(153, 153, 153); }
.cm-s-inner .cm-keyword { color: rgb(119, 0, 136); }
.cm-s-inner .cm-atom, .cm-s-inner.cm-atom { color: rgb(34, 17, 153); }
.cm-s-inner .cm-number { color: rgb(17, 102, 68); }
.cm-s-inner .cm-def { color: rgb(0, 0, 255); }
.cm-s-inner .cm-variable { color: rgb(0, 0, 0); }
.cm-s-inner .cm-variable-2 { color: rgb(0, 85, 170); }
.cm-s-inner .cm-variable-3 { color: rgb(0, 136, 85); }
.cm-s-inner .cm-string { color: rgb(170, 17, 17); }
.cm-s-inner .cm-property { color: rgb(0, 0, 0); }
.cm-s-inner .cm-operator { color: rgb(152, 26, 26); }
.cm-s-inner .cm-comment, .cm-s-inner.cm-comment { color: rgb(170, 85, 0); }
.cm-s-inner .cm-string-2 { color: rgb(255, 85, 0); }
.cm-s-inner .cm-meta { color: rgb(85, 85, 85); }
.cm-s-inner .cm-qualifier { color: rgb(85, 85, 85); }
.cm-s-inner .cm-builtin { color: rgb(51, 0, 170); }
.cm-s-inner .cm-bracket { color: rgb(153, 153, 119); }
.cm-s-inner .cm-tag { color: rgb(17, 119, 0); }
.cm-s-inner .cm-attribute { color: rgb(0, 0, 204); }
.cm-s-inner .cm-header, .cm-s-inner.cm-header { color: rgb(0, 0, 255); }
.cm-s-inner .cm-quote, .cm-s-inner.cm-quote { color: rgb(0, 153, 0); }
.cm-s-inner .cm-hr, .cm-s-inner.cm-hr { color: rgb(153, 153, 153); }
.cm-s-inner .cm-link, .cm-s-inner.cm-link { color: rgb(0, 0, 204); }
.cm-negative { color: rgb(221, 68, 68); }
.cm-positive { color: rgb(34, 153, 34); }
.cm-header, .cm-strong { font-weight: 700; }
.cm-del { text-decoration: line-through; }
.cm-em { font-style: italic; }
.cm-link { text-decoration: underline; }
.cm-error { color: red; }
.cm-invalidchar { color: red; }
.cm-constant { color: rgb(38, 139, 210); }
.cm-defined { color: rgb(181, 137, 0); }
div.CodeMirror span.CodeMirror-matchingbracket { color: rgb(0, 255, 0); }
div.CodeMirror span.CodeMirror-nonmatchingbracket { color: rgb(255, 34, 34); }
.cm-s-inner .CodeMirror-activeline-background { background: inherit; }
.CodeMirror { position: relative; overflow: hidden; }
.CodeMirror-scroll { height: 100%; outline: 0px; position: relative; box-sizing: content-box; background: inherit; }
.CodeMirror-sizer { position: relative; }
.CodeMirror-gutter-filler, .CodeMirror-hscrollbar, .CodeMirror-scrollbar-filler, .CodeMirror-vscrollbar { position: absolute; z-index: 6; display: none; outline: 0px; }
.CodeMirror-vscrollbar { right: 0px; top: 0px; overflow: hidden; }
.CodeMirror-hscrollbar { bottom: 0px; left: 0px; overflow: auto hidden; }
.CodeMirror-scrollbar-filler { right: 0px; bottom: 0px; }
.CodeMirror-gutter-filler { left: 0px; bottom: 0px; }
.CodeMirror-gutters { position: absolute; left: 0px; top: 0px; padding-bottom: 10px; z-index: 3; overflow-y: hidden; }
.CodeMirror-gutter { white-space: normal; height: 100%; box-sizing: content-box; padding-bottom: 30px; margin-bottom: -32px; display: inline-block; }
.CodeMirror-gutter-wrapper { position: absolute; z-index: 4; background: 0px 0px !important; border: medium !important; }
.CodeMirror-gutter-background { position: absolute; top: 0px; bottom: 0px; z-index: 4; }
.CodeMirror-gutter-elt { position: absolute; cursor: default; z-index: 4; }
.CodeMirror-lines { cursor: text; }
.CodeMirror pre { border-radius: 0px; border-width: 0px; background: 0px 0px; font-family: inherit; font-size: inherit; margin: 0px; white-space: pre; overflow-wrap: normal; color: inherit; z-index: 2; position: relative; overflow: visible; }
.CodeMirror-wrap pre { overflow-wrap: break-word; white-space: pre-wrap; word-break: normal; }
.CodeMirror-code pre { border-right-width: 30px; border-right-style: solid; border-right-color: transparent; width: fit-content; }
.CodeMirror-wrap .CodeMirror-code pre { border-right-width: medium; border-right-style: none; border-right-color: currentcolor; width: auto; }
.CodeMirror-linebackground { position: absolute; inset: 0px; z-index: 0; }
.CodeMirror-linewidget { position: relative; z-index: 2; overflow: auto; }
.CodeMirror-wrap .CodeMirror-scroll { overflow-x: hidden; }
.CodeMirror-measure { position: absolute; width: 100%; height: 0px; overflow: hidden; visibility: hidden; }
.CodeMirror-measure pre { position: static; }
.CodeMirror div.CodeMirror-cursor { position: absolute; visibility: hidden; border-right-width: medium; border-right-style: none; border-right-color: currentcolor; width: 0px; }
.CodeMirror div.CodeMirror-cursor { visibility: hidden; }
.CodeMirror-focused div.CodeMirror-cursor { visibility: inherit; }
.cm-searching { background: rgba(255, 255, 0, 0.4); }
span.cm-underlined { text-decoration: underline; }
span.cm-strikethrough { text-decoration: line-through; }
.cm-tw-syntaxerror { color: rgb(255, 255, 255); background-color: rgb(153, 0, 0); }
.cm-tw-deleted { text-decoration: line-through; }
.cm-tw-header5 { font-weight: 700; }
.cm-tw-listitem:first-child { padding-left: 10px; }
.cm-tw-box { border-style: solid; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-color: inherit; border-top-width: 0px !important; }
.cm-tw-underline { text-decoration: underline; }
@media print {
  .CodeMirror div.CodeMirror-cursor { visibility: hidden; }
}


:root {
    --side-bar-bg-color: #fafafa;
    --control-text-color: #777;
}

@include-when-export url(https://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,700,400&subset=latin,latin-ext);

/* open-sans-regular - latin-ext_latin */
  /* open-sans-italic - latin-ext_latin */
    /* open-sans-700 - latin-ext_latin */
    /* open-sans-700italic - latin-ext_latin */
  html {
    font-size: 16px;
    -webkit-font-smoothing: antialiased;
}

body {
    font-family: "Open Sans","Clear Sans", "Helvetica Neue", Helvetica, Arial, 'Segoe UI Emoji', sans-serif;
    color: rgb(51, 51, 51);
    line-height: 1.6;
}

#write {
    max-width: 860px;
  	margin: 0 auto;
  	padding: 30px;
    padding-bottom: 100px;
}

@media only screen and (min-width: 1400px) {
	#write {
		max-width: 1024px;
	}
}

@media only screen and (min-width: 1800px) {
	#write {
		max-width: 1200px;
	}
}

#write > ul:first-child,
#write > ol:first-child{
    margin-top: 30px;
}

a {
    color: #4183C4;
}
h1,
h2,
h3,
h4,
h5,
h6 {
    position: relative;
    margin-top: 1rem;
    margin-bottom: 1rem;
    font-weight: bold;
    line-height: 1.4;
    cursor: text;
}
h1:hover a.anchor,
h2:hover a.anchor,
h3:hover a.anchor,
h4:hover a.anchor,
h5:hover a.anchor,
h6:hover a.anchor {
    text-decoration: none;
}
h1 tt,
h1 code {
    font-size: inherit;
}
h2 tt,
h2 code {
    font-size: inherit;
}
h3 tt,
h3 code {
    font-size: inherit;
}
h4 tt,
h4 code {
    font-size: inherit;
}
h5 tt,
h5 code {
    font-size: inherit;
}
h6 tt,
h6 code {
    font-size: inherit;
}
h1 {
    font-size: 2.25em;
    line-height: 1.2;
    border-bottom: 1px solid #eee;
}
h2 {
    font-size: 1.75em;
    line-height: 1.225;
    border-bottom: 1px solid #eee;
}

/*@media print {
    .typora-export h1,
    .typora-export h2 {
        border-bottom: none;
        padding-bottom: initial;
    }

    .typora-export h1::after,
    .typora-export h2::after {
        content: "";
        display: block;
        height: 100px;
        margin-top: -96px;
        border-top: 1px solid #eee;
    }
}*/

h3 {
    font-size: 1.5em;
    line-height: 1.43;
}
h4 {
    font-size: 1.25em;
}
h5 {
    font-size: 1em;
}
h6 {
   font-size: 1em;
    color: #777;
}
p,
blockquote,
ul,
ol,
dl,
table{
    margin: 0.8em 0;
}
li>ol,
li>ul {
    margin: 0 0;
}
hr {
    height: 2px;
    padding: 0;
    margin: 16px 0;
    background-color: #e7e7e7;
    border: 0 none;
    overflow: hidden;
    box-sizing: content-box;
}

li p.first {
    display: inline-block;
}
ul,
ol {
    padding-left: 30px;
}
ul:first-child,
ol:first-child {
    margin-top: 0;
}
ul:last-child,
ol:last-child {
    margin-bottom: 0;
}
blockquote {
    border-left: 4px solid #dfe2e5;
    padding: 0 15px;
    color: #777777;
}
blockquote blockquote {
    padding-right: 0;
}
table {
    padding: 0;
    word-break: initial;
}
table tr {
    border: 1px solid #dfe2e5;
    margin: 0;
    padding: 0;
}
table tr:nth-child(2n),
thead {
    background-color: #f8f8f8;
}
table th {
    font-weight: bold;
    border: 1px solid #dfe2e5;
    border-bottom: 0;
    margin: 0;
    padding: 6px 13px;
}
table td {
    border: 1px solid #dfe2e5;
    margin: 0;
    padding: 6px 13px;
}
table th:first-child,
table td:first-child {
    margin-top: 0;
}
table th:last-child,
table td:last-child {
    margin-bottom: 0;
}

.CodeMirror-lines {
    padding-left: 4px;
}

.code-tooltip {
    box-shadow: 0 1px 1px 0 rgba(0,28,36,.3);
    border-top: 1px solid #eef2f2;
}

.md-fences,
code,
tt {
    border: 1px solid #e7eaed;
    background-color: #f8f8f8;
    border-radius: 3px;
    padding: 0;
    padding: 2px 4px 0px 4px;
    font-size: 0.9em;
}

code {
    background-color: #f3f4f4;
    padding: 0 2px 0 2px;
}

.md-fences {
    margin-bottom: 15px;
    margin-top: 15px;
    padding-top: 8px;
    padding-bottom: 6px;
}


.md-task-list-item > input {
  margin-left: -1.3em;
}

@media print {
    html {
        font-size: 13px;
    }
    pre {
        page-break-inside: avoid;
        word-wrap: break-word;
    }
}

.md-fences {
	background-color: #f8f8f8;
}
#write pre.md-meta-block {
	padding: 1rem;
    font-size: 85%;
    line-height: 1.45;
    background-color: #f7f7f7;
    border: 0;
    border-radius: 3px;
    color: #777777;
    margin-top: 0 !important;
}

.mathjax-block>.code-tooltip {
	bottom: .375rem;
}

.md-mathjax-midline {
    background: #fafafa;
}

#write>h3.md-focus:before{
	left: -1.5625rem;
	top: .375rem;
}
#write>h4.md-focus:before{
	left: -1.5625rem;
	top: .285714286rem;
}
#write>h5.md-focus:before{
	left: -1.5625rem;
	top: .285714286rem;
}
#write>h6.md-focus:before{
	left: -1.5625rem;
	top: .285714286rem;
}
.md-image>.md-meta {
    /*border: 1px solid #ddd;*/
    border-radius: 3px;
    padding: 2px 0px 0px 4px;
    font-size: 0.9em;
    color: inherit;
}

.md-tag {
    color: #a7a7a7;
    opacity: 1;
}

.md-toc { 
    margin-top:20px;
    padding-bottom:20px;
}

.sidebar-tabs {
    border-bottom: none;
}

#typora-quick-open {
    border: 1px solid #ddd;
    background-color: #f8f8f8;
}

#typora-quick-open-item {
    background-color: #FAFAFA;
    border-color: #FEFEFE #e5e5e5 #e5e5e5 #eee;
    border-style: solid;
    border-width: 1px;
}

/** focus mode */
.on-focus-mode blockquote {
    border-left-color: rgba(85, 85, 85, 0.12);
}

header, .context-menu, .megamenu-content, footer{
    font-family: "Segoe UI", "Arial", sans-serif;
}

.file-node-content:hover .file-node-icon,
.file-node-content:hover .file-node-open-state{
    visibility: visible;
}

.mac-seamless-mode #typora-sidebar {
    background-color: #fafafa;
    background-color: var(--side-bar-bg-color);
}

.md-lang {
    color: #b4654d;
}

/*.html-for-mac {
    --item-hover-bg-color: #E6F0FE;
}*/

#md-notification .btn {
    border: 0;
}

.dropdown-menu .divider {
    border-color: #e5e5e5;
    opacity: 0.4;
}

.ty-preferences .window-content {
    background-color: #fafafa;
}

.ty-preferences .nav-group-item.active {
    color: white;
    background: #999;
}

.menu-item-container a.menu-style-btn {
    background-color: #f5f8fa;
    background-image: linear-gradient( 180deg , hsla(0, 0%, 100%, 0.8), hsla(0, 0%, 100%, 0)); 
}


 @media print { @page {margin: 0 0 0 0;} body.typora-export {padding-left: 0; padding-right: 0;} #write {padding:0;}}
</style><title>IG</title>
</head>
<body class="typora-export"><div class="typora-export-content">
<div id="write" class=""><link rel="stylesheet" href="./IG-v1_files/all.css"><h1 id="a-idtopainstructor-guide-securing-and-monitoring-resources-with-aws"><a id="top"></a><span>Guide: Securing and Monitoring Resources with AWS </span></h1><h2 id="table-of-contents"><span>Table of contents</span></h2><p><a href="file:///C:/Users/chara/Downloads/IG.html#howTo" target="_self"><span>How to use this guide</span></a>
<a href="file:///C:/Users/chara/Downloads/IG.html#intro" target="_self"><span>Introduction to the project</span></a>
<a href="file:///C:/Users/chara/Downloads/IG.html#prereq" target="_self"><span>Prerequisites</span></a>
<a href="file:///C:/Users/chara/Downloads/IG.html#guiding" target="_self"><span>Guiding students</span></a>
<a href="file:///C:/Users/chara/Downloads/IG.html#oando" target="_self"><span>Project overview and objectives</span></a>
<a href="file:///C:/Users/chara/Downloads/IG.html#scenario" target="_self"><span>Scenario</span></a>
<a href="file:///C:/Users/chara/Downloads/IG.html#sr" target="_self"><span>Solution requirements</span></a>
<a href="file:///C:/Users/chara/Downloads/IG.html#lpt" target="_self"><span>Lab project tips</span></a>
<a href="file:///C:/Users/chara/Downloads/IG.html#app" target="_self"><span>Approach</span></a>
<a href="file:///C:/Users/chara/Downloads/IG.html#p1" target="_self"><span>Phase 1: Securing data in Amazon S3</span></a>
<span>     </span><a href="file:///C:/Users/chara/Downloads/IG.html#p1t1" target="_self"><span>Task 1.1: Create a bucket, apply a bucket policy, and test access </span></a>
<span>     </span><a href="file:///C:/Users/chara/Downloads/IG.html#p1t2" target="_self"><span>Task 1.2: Enable versioning and object-level logging on a bucket</span></a>
<span>     </span><a href="file:///C:/Users/chara/Downloads/IG.html#p1t3" target="_self"><span>Task 1.3: Implement the S3 Inventory feature on a bucket</span></a>
<span>     </span><a href="file:///C:/Users/chara/Downloads/IG.html#p1t4" target="_self"><span>Task 1.4: Confirm that versioning works as intended</span></a>
<span>     </span><a href="file:///C:/Users/chara/Downloads/IG.html#p1t5" target="_self"><span>Task 1.5: Confirm object-level logging and query the access logs by using Athena</span></a>
<span>     </span><a href="file:///C:/Users/chara/Downloads/IG.html#p1t6" target="_self"><span>Task 1.6: Review the S3 Inventory report by using S3 Select</span></a>
<span>     </span><a href="file:///C:/Users/chara/Downloads/IG.html#p1cost" target="_self"><span>Cost assessment to secure Amazon S3</span></a>
<a href="file:///C:/Users/chara/Downloads/IG.html#p2" target="_self"><span>Phase 2: Securing VPCs </span></a>
<span>     </span><a href="file:///C:/Users/chara/Downloads/IG.html#p2t1" target="_self"><span>Task 2.1: Review LabVPC and its associated resources</span></a>
<span>     </span><a href="file:///C:/Users/chara/Downloads/IG.html#p2t2" target="_self"><span>Task 2.2: Create a VPC flow log</span></a>
<span>     </span><a href="file:///C:/Users/chara/Downloads/IG.html#p2t3" target="_self"><span>Task 2.3: Access the WebServer instance from the internet and review VPC flow logs in CloudWatch</span></a>
<span>     </span><a href="file:///C:/Users/chara/Downloads/IG.html#p2t4" target="_self"><span>Task 2.4: Configure route table and security group settings</span></a>
<span>     </span><a href="file:///C:/Users/chara/Downloads/IG.html#p2t5" target="_self"><span>Task 2.5: Secure the WebServerSubnet with a network ACL</span></a>
<span>     </span><a href="file:///C:/Users/chara/Downloads/IG.html#p2t6" target="_self"><span>Task 2.6: Review NetworkFirewallVPC and its associated resources</span></a>
<span>     </span><a href="file:///C:/Users/chara/Downloads/IG.html#p2dia" target="_self"><span>Diagramming activity</span></a>
<span>     </span><a href="file:///C:/Users/chara/Downloads/IG.html#p2t7" target="_self"><span>Task 2.7: Create a network firewall</span></a>
<span>     </span><a href="file:///C:/Users/chara/Downloads/IG.html#p2t8" target="_self"><span>Task 2.8: Create route tables</span></a>
<span>     </span><a href="file:///C:/Users/chara/Downloads/IG.html#p2t9" target="_self"><span>Task 2.9: Configure logging for the network firewall</span></a>
<span>     </span><a href="file:///C:/Users/chara/Downloads/IG.html#p2t10" target="_self"><span>Task 2.10: Configure the firewall policy and test access</span></a>
<span>     </span><a href="file:///C:/Users/chara/Downloads/IG.html#p2cea" target="_self"><span>Cost estimate to secure a VPC with a network firewall</span></a>
<a href="file:///C:/Users/chara/Downloads/IG.html#p3" target="_self"><span>Phase 3: Securing AWS resources by using AWS KMS</span></a>
<span>     </span><a href="file:///C:/Users/chara/Downloads/IG.html#p3t1" target="_self"><span>Task 3.1: Create a customer managed key and configure key rotation</span></a>
<span>     </span><a href="file:///C:/Users/chara/Downloads/IG.html#p3t2" target="_self"><span>Task 3.2: Update the AWS KMS key policy and analyze an IAM policy</span></a>
<span>     </span><a href="file:///C:/Users/chara/Downloads/IG.html#p3t3" target="_self"><span>Task 3.3: Use AWS KMS to encrypt data in Amazon S3</span></a>
<span>     </span><a href="file:///C:/Users/chara/Downloads/IG.html#p3t4" target="_self"><span>Task 3.4: Use AWS KMS to encrypt the root volume of an EC2 instance</span></a>
<span>     </span><a href="file:///C:/Users/chara/Downloads/IG.html#p3t5" target="_self"><span>Task 3.5: Use AWS KMS envelope encryption to encrypt data in place</span></a>
<span>     </span><a href="file:///C:/Users/chara/Downloads/IG.html#p3t6" target="_self"><span>Task 3.6: Use AWS KMS to encrypt a Secrets Manager secret</span></a>
<span>     </span><a href="file:///C:/Users/chara/Downloads/IG.html#p3ca" target="_self"><span>Cost assessment for using AWS KMS</span></a>
<a href="file:///C:/Users/chara/Downloads/IG.html#p4" target="_self"><span>Phase 4: Monitoring and logging</span></a>
<span>     </span><a href="file:///C:/Users/chara/Downloads/IG.html#p4t1" target="_self"><span>Task 4.1: Use CloudTrail to record Amazon S3 API calls</span></a>
<span>     </span><a href="file:///C:/Users/chara/Downloads/IG.html#p4t2" target="_self"><span>Task 4.2: Use CloudWatch Logs to monitor secure logs</span></a>
<span>     </span><a href="file:///C:/Users/chara/Downloads/IG.html#p4t3" target="_self"><span>Task 4.3: Create a CloudWatch alarm to send notifications for security incidents</span></a>
<span>     </span><a href="file:///C:/Users/chara/Downloads/IG.html#p4t4" target="_self"><span>Task 4.4: Configure AWS Config to assess security settings and remediate the configuration of AWS resources</span></a>
<span>     </span><a href="file:///C:/Users/chara/Downloads/IG.html#p4ca" target="_self"><span>Cost assessment for monitoring and logging </span></a>
<a href="file:///C:/Users/chara/Downloads/IG.html#app" target="_self"><span>Appendix</span></a>
<span>     </span><a href="file:///C:/Users/chara/Downloads/IG.html#app1" target="_self"><span>How to teach the project</span></a>
<span>     </span><a href="file:///C:/Users/chara/Downloads/IG.html#app2" target="_self"><span>References</span></a>
<span>     </span><a href="file:///C:/Users/chara/Downloads/IG.html#app3" target="_self"><span>Showcase presentation template</span></a>
<span>     </span><a href="file:///C:/Users/chara/Downloads/IG.html#app4" target="_self"><span>Grading rubric</span></a></p><p>&nbsp;</p><h2 id="a-idhowtoahow-to-use-this-guide"><a id="howTo"></a><span>How to use this guide</span></h2><p><a href="file:///C:/Users/chara/Downloads/IG.html#top" target="_self"><span>Return to&nbsp;table&nbsp;of&nbsp;contents</span></a></p><p><span>This guide provides step-by-step instructions for an example solution for the lab project. However, this guide doesn’t cover all possible solutions. You can use these instructions to help students complete the project.</span></p><p><span>Instructions for students are available in the lab environment. The project is meant to challenge students, so the project instructions do not always provide full step-by-step guidance.</span></p><p><i class="fa-solid fa-circle-exclamation" aria-label="Important icon"></i><span> </span><strong><span>Important:</span></strong><span> The lab instructions for students include information that isn't included in this instructor guide. Therefore, you must use this guide together with the lab instructions to lead students to complete the project.</span></p><p><span>The project materials include the following resources to support students to complete the lab project:</span></p><ul><li><p><strong><span>References:</span></strong><span> This section lists references that have been provided in the lab instructions to help students complete the project. Encourage students to use these resources. You might need to provide access to students for some materials, such as labs in other AWS Academy courses.</span></p></li><li><p><strong><span>Showcase presentation template:</span></strong><span> You can ask students to use this template to present their project.</span></p></li><li><p><strong><span>Grading rubric:</span></strong><span> You can use this document to provide feedback to students.</span></p></li><li><p><strong><span>How to teach this project:</span></strong><span> Suggestions are available in the </span><a href="file:///C:/Users/chara/Downloads/IG.html#app1" target="_self"><span>Appendix</span></a><span>.</span></p></li></ul><p><i class="fa-solid fa-note-sticky" aria-label="Note icon"></i><span> </span><strong><span>Note:</span></strong><span> The rubric and presentation template files are available to download from the Educator Files section of the course.</span></p><p>&nbsp;</p><h2 id="a-idintroaintroduction-to-the-project"><a id="intro"></a><span>Introduction to the project</span></h2><p><a href="file:///C:/Users/chara/Downloads/IG.html#top" target="_self"><span>Return to table of contents</span></a></p><p><em><span>The project is meant to challenge students</span></em><span>. The time that it takes students to complete the project will vary depending on student skill level. This project is anticipated to require </span><strong><span>10–14 hours</span></strong><span> to complete.</span></p><p><span>As mentioned, the project is meant to challenge students, so the project instructions don't always provide full step-by-step guidance. However, in some tasks, the instructions are more explicit. This is by design. The following are a few reasons for this design decision:</span></p><ul><li><p><span>By providing </span><em><span>some</span></em><span> specifics to students in their instructions, when students ask for assistance, the sample solution instructions in this guide are more likely to assist you in helping students. For example, by specifying the names of resources and some configuration details, the resources that students create will be more identifiable in the sample solution (which can be built by following the combined instructor guide and student guide details). Also, if you provide the instructor guide details for a specific step to a student, the guidance will be more usable to them.</span></p></li><li><p><span>Certain sections of the project, if done incorrectly, could lead to challenging scenarios that would be difficult to troubleshoot. The student might even need to redo several prior steps or reset the lab environment, which would require the student to start from the beginning of the project.</span></p></li><li><p><span>The lab environment that is provided has certain security settings applied to prevent misuse, but the environment must also support the actions that are needed to complete the project. If the project design were too open-ended, we wouldn't know what types of resources students would try to create and configurations they would try to use on those resources. We would not be able to secure the environment in a way that would allow students to succeed without hitting permissions issues.</span></p></li></ul><p><em><span>The lab environment is long lived</span></em><span>, meaning that if a student starts the lab on Monday, they could continue working on the lab on Tuesday or any following day. When the student starts the lab environment again, they will find that everything they created in the AWS account is still there, so they can continue where they left off. Also, at any point before the session timer reaches 0:00, you can choose </span><strong><span>Start Lab</span></strong><span> again to extend the lab session time.</span></p><p>&nbsp;</p><h2 id="a-idprereqastudent-prerequisites"><a id="prereq"></a><span>Student prerequisites</span></h2><p><a href="file:///C:/Users/chara/Downloads/IG.html#top" target="_self"><span>Return to table of contents</span></a></p><p><span>This project assumes that students have had some hands-on practice using a variety of AWS services.</span></p><p><span>Ideally, students should have already completed the AWS Academy Cloud Foundations course. In addition, they ideally would have completed the AWS Academy Cloud Security Foundations course or have equivalent hands-on practice with AWS services.</span></p><p><span>Knowledge of Linux Bash commands would be helpful but isn’t mandatory. </span></p><p><span>Finally, students should approach this project knowing that they are encouraged to be resourceful. For example, they can reference the AWS Documentation or a search engine to look for answers to technical questions.</span></p><p>&nbsp;</p><h2 id="a-idguidingaguiding-students"><a id="guiding"></a><span>Guiding students</span></h2><p><a href="file:///C:/Users/chara/Downloads/IG.html#top" target="_self"><span>Return to table of contents</span></a></p><p><span>The sections in this instructor guide that are titled </span><em><span>Phase</span></em><span> or </span><em><span>Task</span></em><span> provide details about how to complete the steps in the project where detailed guidance </span><em><span>isn't</span></em><span> provided to the student. The lab instructions include references to materials that might be helpful. Encourage students to use these resources, and use this instructor guide to provide additional guidance as needed.</span></p><p><i class="fa-solid fa-circle-exclamation" aria-label="Important icon"></i><span> </span><strong><span>Important:</span></strong><span> The solution in this guide works only if the code snippets are used exactly as instructed without modification.</span></p><h2 id="a-idoandoaproject-overview-and-objectives"><a id="oando"></a><span>Project overview and objectives</span></h2><p><em><span>Reference the lab instructions for the project overview and objectives details.</span></em></p><h2 id="a-idscenarioascenario"><a id="scenario"></a><span>Scenario</span></h2><p><em><span>Reference the lab instructions for the scenario details.</span></em></p><h2 id="a-idsrasolution-requirements"><a id="sr"></a><span>Solution requirements</span></h2><p><em><span>Reference the lab instructions for the solution requirements details.</span></em></p><h2 id="a-idlptalab-project-tips"><a id="lpt"></a><span>Lab project tips</span></h2><h2 id="a-idp1aphase-1-securing-data-in-amazon-s3"><a id="p1"></a><span>Phase 1: Securing data in Amazon S3</span></h2><p><a href="file:///C:/Users/chara/Downloads/IG.html#top" target="_self"><span>Return to table of contents</span></a></p><!--PER PRODUCT TEAM: This phase does NOT need to include a diagram activity.--><h3 id="a-idp1t1atask-11-create-a-bucket-apply-a-bucket-policy-and-test-access"><a id="p1t1"></a><span>Task 1.1: Create a bucket, apply a bucket policy, and test access</span></h3><p><a href="file:///C:/Users/chara/Downloads/IG.html#top" target="_self"><span>Return to table of contents</span></a></p><p><em><span>Reference the student instructions for details about what students should do in this task.</span></em></p><p><strong><span>Step 1:</span></strong><span> </span><em><span>Full click-level guidance is available in the student lab instructions.</span></em></p><p><strong><span>Solution to step 2:</span></strong></p><ul><li><p><span>In the AWS Management Console, in the search box next to </span><i class="fas fa-th"></i><span> </span><strong><span>Services</span></strong><span>, search for and choose </span><strong><span>S3</span></strong><span>.</span></p></li><li><p><span>Four buckets are listed:</span></p><ul><li><p><span>aws-config-</span><unique-id></unique-id></p></li><li><p><span>s3-inventory-</span><unique-id></unique-id></p></li><li><p><span>cloudtrail-logs-</span><unique-id></unique-id></p></li><li><p><span>s3-objects-access-log-</span><unique-id></unique-id></p></li></ul></li><li><p><span>Copy the unique ID from one of the buckets.</span></p></li></ul><p><strong><span>Solution to step 3:</span></strong></p><ul><li><p><span>Choose </span><strong><span>Create bucket</span></strong><span> and configure the following:</span></p><ul><li><p><strong><span>Bucket name:</span></strong><span> Enter </span><code>data-bucket-&lt;unique-id&gt;</code><span> where </span><unique-id><span> is the value that you copied from the name of the existing bucket.</span></unique-id></p></li><li><p><span>Keep the following default settings:</span></p><ul><li><p><span>AWS Region: </span><strong><span>US East (N. Virginia) us-east-1</span></strong></p></li><li><p><span>Object Ownership: </span><strong><span>ACLs disabled</span></strong></p></li><li><p><span>Block Public Access settings for this bucket: </span><strong><span>Block </span><em><span>all</span></em><span> public access</span></strong><span>.</span></p></li><li><p><span>Bucket Versioning: </span><strong><span>Disable</span></strong></p></li><li><p><span>Default encryption: </span><strong><span>Server-side encryption with Amazon S3 managed keys (SSE-S3)</span></strong></p></li><li><p><span>Bucket Key: </span><strong><span>Enable</span></strong></p></li><li><p><span>No changes are needed in the </span><strong><span>Advanced settings</span></strong><span> section.</span></p></li></ul></li><li><p><span>Choose </span><strong><span>Create bucket</span></strong><span>.</span></p><p><strong><span>Note</span></strong><span>: When students create the bucket, they are told to notice that server-side encryption is </span><em><span>enabled</span></em><span>. The default is server-side encryption with Amazon S3 managed keys (SSE-S3), which is what they should have chosen. This fact becomes relevant in a later phase of the project.</span></p><p><i class="fa-solid fa-circle-exclamation" aria-label="Important icon"></i><span>  </span><strong><span>Important</span></strong><span>: All future references to bucket names in these instructions will use the short name, without the unique ID. For example, </span><em><span>data-bucket-</span><unique-id></unique-id></em><span> will be referred to as </span><em><span>data-bucket</span></em><span>, and you will be expected to add the unique ID to match your actual bucket name.</span></p></li></ul></li></ul><p><strong><span>Solution to step 4:</span></strong></p><ul><li><p><span>Find a file or create one on your computer.</span></p><p><span>For example, create a file named </span><em><span>myfile.txt</span></em><span>, write "hello world" in the file, and save it.</span></p></li><li><p><span>In the Amazon S3 console, in the list of buckets, choose the name link for the </span><strong><span>data-bucket</span></strong><span>.</span></p></li><li><p><span>On the </span><strong><span>Objects</span></strong><span> tab, choose </span><strong><span>Upload</span></strong><span>.</span></p></li><li><p><span>Choose </span><strong><span>Add files</span></strong><span>.</span></p></li><li><p><span>Browse to and open the file that you want to upload.</span></p></li><li><p><span>Choose </span><strong><span>Upload</span></strong><span>.</span></p></li></ul><p><strong><span>Solution to step 5:</span></strong></p><ul><li><p><span>Retrieve the ARNs for the </span><em><span>paulo</span></em><span> and </span><em><span>sofia</span></em><span> IAM users:</span></p><ul><li><p><span>Navigate to the IAM console.</span></p></li><li><p><span>In the navigation pane, choose </span><strong><span>Users</span></strong><span>.</span></p></li><li><p><span>Choose the link for the </span><strong><span>paulo</span></strong><span> user, and copy the ARN to a text file or other location.</span></p></li><li><p><span>Return to the users list, choose the link for the </span><strong><span>sofia</span></strong><span> user, and copy the ARN to a text file or other location.</span></p></li></ul></li><li><p><span>Navigate to the list of buckets in the Amazon S3 console.</span></p></li><li><p><span>Choose the name link for </span><strong><span>data-bucket</span></strong><span>.</span></p></li><li><p><span>Choose the </span><strong><span>Permissions</span></strong><span> tab.</span></p></li><li><p><span>In the </span><strong><span>Bucket policy</span></strong><span> section, choose </span><strong><span>Edit</span></strong><span>.</span></p></li><li><p><span>Copy the </span><strong><span>Bucket ARN</span></strong><span> value to your clipboard.</span></p></li><li><p><span>Choose </span><strong><span>Policy generator</span></strong><span> and configure the following:</span></p><ul><li><p><span>Select Type of Policy: Choose </span><strong><span>S3 Bucket Policy</span></strong></p></li><li><p><span>Effect: Choose </span><strong><span>Allow</span></strong></p></li><li><p><span>Principal: Enter </span><code>*</code></p></li><li><p><span>AWS Service: </span><strong><span>Amazon S3</span></strong><span> is already selected.</span></p></li><li><p><span>Actions: Select </span><strong><span>All Actions</span></strong><span>.</span></p></li><li><p><span>Amazon Resource Name (ARN): Paste the </span><em><span>data-bucket</span></em><span> ARN, enter a comma, paste the </span><em><span>data-bucket</span></em><span> ARN again, and then enter </span><code>/*</code></p><p><span>The resulting value should be similar to the following: </span><code>arn:aws:s3:::data-bucket-&lt;unique-ID&gt;,arn:aws:s3:::data-bucket-&lt;unique-ID&gt;/*</code></p></li><li><p><span>Choose </span><strong><span>Add Conditions</span></strong><span> and configure the following:</span></p><ul><li><p><span>Condition: Choose </span><strong><span>ArnEquals</span></strong></p></li><li><p><span>Key: Choose </span><strong><span>aws:PrincipleArn</span></strong></p></li><li><p><span>Value:</span></p><ul><li><p><span>Paste the ARN for the </span><em><span>paulo</span></em><span> IAM user.</span></p></li><li><p><span>Enter a comma.</span></p></li><li><p><span>Paste the ARN for the </span><em><span>sofia</span></em><span> IAM user.</span></p></li><li><p><span>Enter a comma.</span></p></li><li><p><span>Paste the ARN for the </span><em><span>sofia</span></em><span> IAM user </span><em><span>again</span></em><span>.</span></p></li><li><p><span>In the last ARN that you pasted, change </span><code>user/sofia</code><span> to </span><code>role/voclabs</code></p></li></ul></li><li><p><span>Choose </span><strong><span>Add Condition</span></strong><span>.</span></p><p><span>A summary of the condition appears in a single-row table.</span></p></li></ul></li><li><p><span>Choose </span><strong><span>Add Statement</span></strong><span>, but </span><em><span>don't</span></em><span> generate the policy yet.</span></p><p><span>A summary of the policy statement appears in a single-row table.</span></p></li><li><p><span>Configure another statement:</span></p><ul><li><p><span>Effect: Choose </span><strong><span>Deny</span></strong><span> (Note the change from the first statement!)</span></p></li><li><p><span>Principal: Enter </span><code>*</code></p></li><li><p><span>AWS Service: </span><strong><span>Amazon S3</span></strong><span> is already selected.</span></p></li><li><p><span>Actions: Select </span><strong><span>All Actions</span></strong><span>.</span></p></li><li><p><span>Amazon Resource Name (ARN): Paste the </span><em><span>data-bucket</span></em><span> ARN, enter a comma, paste the </span><em><span>data-bucket</span></em><span> ARN again, and then enter </span><code>/*</code><span> </span></p><p><span>The resulting value should be similar to the following: </span><code>arn:aws:s3:::data-bucket-&lt;unique-ID&gt;,arn:aws:s3:::data-bucket-&lt;unique-ID&gt;/*</code></p></li></ul></li><li><p><span>Choose </span><strong><span>Add Conditions</span></strong><span> and configure the following:</span></p><ul><li><p><span>Condition: Choose </span><strong><span>ArnNotEquals</span></strong><span> (Note the change from the first statement!)</span></p></li><li><p><span>Key: Choose </span><strong><span>aws:PrincipleArn</span></strong></p></li><li><p><span>Value:</span></p><ul><li><p><span>Paste the ARN for the </span><em><span>paulo</span></em><span> IAM user.</span></p></li><li><p><span>Enter a comma.</span></p></li><li><p><span>Paste the ARN for the </span><em><span>sofia</span></em><span> IAM user.</span></p></li><li><p><span>Enter a comma.</span></p></li><li><p><span>Paste the ARN for the </span><em><span>sofia</span></em><span> IAM user </span><em><span>again</span></em><span>.</span></p></li><li><p><span>In the last ARN that you pasted, change </span><code>user/sofia</code><span> to </span><code>role/voclabs</code></p></li></ul></li><li><p><span>Choose </span><strong><span>Add Condition</span></strong><span>.</span></p><p><span>A summary of the condition appears in a single-row table.</span></p></li></ul></li><li><p><span>Choose </span><strong><span>Add Statement</span></strong><span>.</span></p><p><span>Confirm that the statements are formatted as shown in the following image (your account number and bucket name will be different):</span></p><p><img src="file:///C:/Users/chara/Downloads/images/statements-confirm.png" referrerpolicy="no-referrer" alt="screenshot of policy generator UI showing statement details"></p></li><li><p><span>Choose </span><strong><span>Generate Policy</span></strong><span>.</span></p></li><li><p><span>Copy the entire JSON document that appears to your clipboard.</span></p></li><li><p><span>In the browser tab that is open to the </span><strong><span>Edit bucket policy</span></strong><span> page in the Amazon S3 console, paste the entire JSON document into the </span><strong><span>Policy</span></strong><span> area.</span></p><p><span>The following code block provides an example of the policy. The </span><code>Id</code><span> and </span><code>Sid</code><span> lines are optional. Your account number and bucket name will be different.</span></p><!--This was created with policy generator--><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="json" style="break-inside: unset;"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="json"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: currentcolor;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: currentcolor;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">{</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-string cm-property">"Id"</span>: <span class="cm-string">"Policy1686584667615"</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-string cm-property">"Version"</span>: <span class="cm-string">"2012-10-17"</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-string cm-property">"Statement"</span>: [</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span class="cm-string cm-property">"Sid"</span>: <span class="cm-string">"Stmt1686584498435"</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span class="cm-string cm-property">"Action"</span>: <span class="cm-string">"s3:*"</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span class="cm-string cm-property">"Effect"</span>: <span class="cm-string">"Allow"</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span class="cm-string cm-property">"Resource"</span>: [</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-string">"arn:aws:s3:::data-bucket-096c40d9eee7bb9dc"</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-string">"arn:aws:s3:::data-bucket-096c40d9eee7bb9dc/*"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;  ],</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span class="cm-string cm-property">"Condition"</span>: {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-string cm-property">"ArnEquals"</span>: {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-string cm-property">"aws:PrincipalArn"</span>: [</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-string">"arn:aws:iam::259764046489:user/paulo"</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-string">"arn:aws:iam::259764046489:role/voclabs"</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-string">"arn:aws:iam::259764046489:user/sofia"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;  ]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;  },</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span class="cm-string cm-property">"Principal"</span>: <span class="cm-string">"*"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  },</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span class="cm-string cm-property">"Sid"</span>: <span class="cm-string">"Stmt1686584613254"</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span class="cm-string cm-property">"Action"</span>: <span class="cm-string">"s3:*"</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span class="cm-string cm-property">"Effect"</span>: <span class="cm-string">"Deny"</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span class="cm-string cm-property">"Resource"</span>: [</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-string">"arn:aws:s3:::data-bucket-096c40d9eee7bb9dc"</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-string">"arn:aws:s3:::data-bucket-096c40d9eee7bb9dc/*"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;  ],</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span class="cm-string cm-property">"Condition"</span>: {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-string cm-property">"ArnNotEquals"</span>: {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-string cm-property">"aws:PrincipalArn"</span>: [</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-string">"arn:aws:iam::259764046489:user/paulo"</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-string">"arn:aws:iam::259764046489:role/voclabs"</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-string">"arn:aws:iam::259764046489:user/sofia"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;  ]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;  },</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span class="cm-string cm-property">"Principal"</span>: <span class="cm-string">"*"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  ]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 968px;"></div><div class="CodeMirror-gutters" style="display: none; height: 968px;"></div></div></div></pre><p><strong><span>Tip</span></strong><span>: In the event that you decide to create your policy by copying and pasting the JSON shown above (instead of by using the policy generator), be sure to update the unique-ID in the data-bucket name as well as the AWS account number so that the values match what is in your AWS account.</span></p></li><li><p><span>Choose </span><strong><span>Save changes</span></strong><span>.</span></p><p><i class="fa-solid fa-note-sticky" aria-label="Note icon"></i><span> </span><strong><span>Note:</span></strong><span> The </span><em><span>mary</span></em><span> user isn’t included as a principal in this bucket policy. This is by design so that students can later compare her access against the </span><em><span>paulo</span></em><span> user's access.</span></p></li></ul></li></ul><p><strong><span>Solution to step 6:</span></strong></p><ul><li><p><span>Find the IAM user console sign-in link:</span></p><ul><li><p><span>In the IAM console navigation pane, choose </span><strong><span>Users</span></strong><span>.</span></p></li><li><p><span>Choose the link for </span><strong><span>paulo</span></strong><span>.</span></p></li><li><p><span>On the </span><strong><span>Security credentials</span></strong><span> tab, copy the </span><strong><span>Console sign-in link</span></strong><span>.</span></p></li></ul></li><li><p><span>Log in to the console as the </span><em><span>paulo</span></em><span> user:</span></p><ul><li><p><span>Open a new incognito or private browser window and load the sign-in page.</span></p></li><li><p><span>Log in with the following credentials:</span></p><ul><li><p><span>IAM user name: Enter </span><code>paulo</code></p></li><li><p><span>Password: To find the password, choose </span><strong><span>AWS Details</span></strong><span> above the student instructions in the lab environment.</span></p></li></ul></li></ul></li><li><p><span>Test the user's access to Amazon S3:</span></p><ul><li><p><span>Navigate to the Amazon S3 console.</span></p></li><li><p><span>In the navigation pane, choose </span><strong><span>Buckets</span></strong><span>.</span></p><p><span>All five buckets should be listed. The </span><strong><span>Access</span></strong><span> column should indicate that all the buckets and their objects are not public.</span></p></li><li><p><span>Choose the link for the </span><strong><span>data-bucket</span></strong><span>.</span></p><p><span>You should see the file that you uploaded to the bucket earlier.</span></p></li><li><p><span>Select the file, and then choose </span><strong><span>Download</span></strong><span>.</span></p><p><span>You should be able to download the file.</span></p></li><li><p><span>Return to the buckets list.</span></p></li><li><p><span>Choose the link for the </span><strong><span>aws-config</span></strong><span> bucket.</span></p><p><span>You should see an "Insufficient permissions to list objects" error. If you choose any other buckets, you should see the same error. </span></p></li></ul></li><li><p><span>To sign out of the console, choose </span><strong><span>paulo @ xxxxx</span></strong><span> in the top-right corner, and choose </span><strong><span>Sign out</span></strong><span>.</span></p></li></ul><ul><li><p><span>Return to the browser tab where you’re logged in to the console as the </span><em><span>voclabs</span></em><span> role.</span></p></li><li><p><span>Find the IAM user console sign-in link:</span></p><ul><li><p><span>In the IAM console navigation pane, choose </span><strong><span>Users</span></strong><span>.</span></p></li><li><p><span>Choose the link for </span><strong><span>mary</span></strong><span>.</span></p></li><li><p><span>On the </span><strong><span>Security credentials</span></strong><span> tab, copy the </span><strong><span>Console sign-in link</span></strong><span>.</span></p></li></ul></li><li><p><span>Log in to the console as the </span><em><span>mary</span></em><span> user:</span></p><ul><li><p><span>Open a new incognito or private browser window and load the sign-in page.</span></p></li><li><p><span>Log in with the following credentials:</span></p><ul><li><p><span>IAM user name: Enter </span><code>mary</code></p></li><li><p><span>Password: To find the password, choose </span><strong><span>AWS Details</span></strong><span> above the student instructions in the lab environment.</span></p></li></ul></li></ul></li><li><p><span>Test the user's access to Amazon S3:</span></p><ul><li><p><span>Navigate to the Amazon S3 console.</span></p></li><li><p><span>In the navigation pane, choose </span><strong><span>Buckets</span></strong><span>.</span></p><p><span>All five buckets should be listed. For four of the buckets, the </span><strong><span>Access</span></strong><span> column should indicate that all the buckets and their objects are not public. For the </span><strong><span>data-bucket</span></strong><span>, this column should show </span><em><span>Error</span></em><span>.</span></p></li></ul></li><li><p><span>Choose the link for the </span><strong><span>data-bucket</span></strong><span>.</span></p><p><span>You should see an "Insufficient permissions to list objects" error. If you choose any other buckets, you should see the same error. </span></p><p><strong><span>Example of a strong answer to the questions posed to students:</span></strong><span> You should see the "Insufficient permissions to list objects" error. The </span><em><span>mary</span></em><span> user shouldn’t be able to list or download any objects in any bucket. This is because Mary doesn’t have the s3:ListBucket permission as part of her IAM user policy, and this user doesn't have permissions through a bucket policy. Remember that when you implemented the bucket policy, only the </span><em><span>paulo</span></em><span> user was granted access. This illustrates an important concept: The Mary and Paulo users have the same S3 permissions granted to them in the </span><em><span>IAM policy</span></em><span> that is attached to the </span><em><span>AccountManagerGroup</span></em><span> IAM group that they are members of. However, resource policies, such as a bucket policy, provide an additional security tool to permit or deny access to resources.</span></p></li><li><p><span>To sign out of the console, choose </span><strong><span>mary @ xxxxx</span></strong><span> in the top-right corner, and choose </span><strong><span>Sign out</span></strong><span>.</span></p><p>&nbsp;</p></li></ul><h3 id="a-idp1t2atask-12-enable-versioning-and-object-level-logging-on-a-bucket"><a id="p1t2"></a><span>Task 1.2: Enable versioning and object-level logging on a bucket</span></h3><p><a href="file:///C:/Users/chara/Downloads/IG.html#top" target="_self"><span>Return to table of contents</span></a></p><p><em><span>Reference the student instructions for details about what students should do in this task.</span></em></p><p><strong><span>Step 1:</span></strong><span> </span><em><span>Full click-level guidance is available in the student lab instructions.</span></em></p><p><strong><span>Solution to step 2:</span></strong><span> </span><!--as voclabs--></p><ul><li><p><span>In the browser session where you're logged in to the console as the </span><em><span>voclabs</span></em><span> role, navigate to the Amazon S3 console.</span></p></li><li><p><span>In the buckets list, choose the link for </span><strong><span>data-bucket</span></strong><span>.</span></p></li><li><p><span>Choose the </span><strong><span>Properties</span></strong><span> tab.</span></p></li><li><p><span>In the </span><strong><span>Bucket Versioning</span></strong><span> section, choose </span><strong><span>Edit</span></strong><span>.</span></p></li><li><p><span>Choose </span><strong><span>Enable</span></strong><span>, and then choose </span><strong><span>Save changes</span></strong><span>.</span></p><p>&nbsp;</p></li></ul><p><strong><span>Solution to step 3:</span></strong><!--as voclabs--></p><ul><li><p><span>On the </span><em><span>data-bucket</span></em><span> details page, choose the </span><strong><span>Properties</span></strong><span> tab.</span></p></li><li><p><span>Scroll down to the </span><strong><span>Server access logging</span></strong><span> section, and choose </span><strong><span>Edit</span></strong><span>.</span></p></li><li><p><span>Choose </span><strong><span>Enable</span></strong><span>.</span></p><p><span>A message displays to indicate that the bucket policy will be updated.  </span></p></li><li><p><span>Choose </span><strong><span>Browse S3</span></strong><span>.</span></p></li><li><p><span>Choose the </span><strong><span>s3-objects-access-log</span></strong><span> bucket, and then select </span><strong><span>Choose path</span></strong><span>.</span></p></li><li><p><span>At the end of the </span><strong><span>Target bucket</span></strong><span> path, add </span><code>/data-bucket</code></p><p><span>The result should look similar to the following: </span><em><span>s3://s3-objects-access-log-.../data-bucket</span></em><span>.</span></p></li><li><p><span>Choose </span><strong><span>Save changes</span></strong><span>.</span></p><p>&nbsp;</p></li></ul><p><strong><span>Solution to step 4:</span></strong><span> </span><!--as voclabs--></p><ul><li><p><span>In the Amazon S3 console, on the </span><strong><span>Buckets</span></strong><span> page, choose the link for the </span><strong><span>s3-objects-access-log</span></strong><span> bucket.</span></p></li><li><p><span>Choose the </span><strong><span>Permissions</span></strong><span> tab, and scroll to the </span><strong><span>Bucket policy</span></strong><span> section.</span></p></li><li><p><span>Review the bucket policy. It should be similar to the following:</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="json" style="break-inside: unset;"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="json"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: currentcolor;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: currentcolor;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">{</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-string cm-property">"Version"</span>: <span class="cm-string">"2012-10-17"</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-string cm-property">"Id"</span>: <span class="cm-string">"S3-Console-Auto-Gen-Policy-1680884000752"</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-string cm-property">"Statement"</span>: [</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-string cm-property">"Sid"</span>: <span class="cm-string">"S3PolicyStmt-DO-NOT-MODIFY-1680884000384"</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-string cm-property">"Effect"</span>: <span class="cm-string">"Allow"</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-string cm-property">"Principal"</span>: {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-string cm-property">"Service"</span>: <span class="cm-string">"logging.s3.amazonaws.com"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  },</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-string cm-property">"Action"</span>: <span class="cm-string">"s3:PutObject"</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-string cm-property">"Resource"</span>: <span class="cm-string">"arn:aws:s3:::s3-objects-access-log-&lt;unique-ID&gt;/*"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  ]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 330px;"></div><div class="CodeMirror-gutters" style="display: none; height: 330px;"></div></div></div></pre></li></ul><p>&nbsp;</p><h3 id="a-idp1t3atask-13-implement-the-s3-inventory-feature-on-a-bucket"><a id="p1t3"></a><span>Task 1.3: Implement the S3 Inventory feature on a bucket</span></h3><p><a href="file:///C:/Users/chara/Downloads/IG.html#top" target="_self"><span>Return to table of contents</span></a></p><p><em><span>Reference the student instructions for details about what students should do in this task.</span></em></p><p><strong><span>Solution to step 1:</span></strong><span> </span><!--as voclabs--></p><ul><li><p><span>In the Amazon S3 console, on the </span><strong><span>Buckets</span></strong><span> page, choose the link for </span><strong><span>data-bucket</span></strong><span>.</span></p></li><li><p><span>Choose the </span><strong><span>Management</span></strong><span> tab.</span></p></li><li><p><span>In the </span><strong><span>Inventory configurations</span></strong><span> section, choose </span><strong><span>Create inventory configuration</span></strong><span> and configure the following:</span></p><ul><li><p><span>Inventory configuration name: </span><code>Inventory</code><span> </span></p></li><li><p><span>Object versions: </span><strong><span>Include all versions</span></strong><span> </span></p></li><li><p><span>In the </span><strong><span>Report details</span></strong><span> section:</span></p><ul><li><p><span>Destination: Choose </span><strong><span>Browse S3</span></strong><span> </span></p></li><li><p><span>Choose the </span><strong><span>s3-inventory</span></strong><span> bucket, and then choose </span><strong><span>Choose path</span></strong><span>.</span></p><p><strong><span>Analysis:</span></strong><span> The destination bucket permissions policy allows Amazon S3 to write objects to the </span><em><span>s3-inventory</span></em><span> bucket.</span></p></li><li><p><span>Output format: </span><strong><span>Apache Parquet</span></strong><span>.</span></p><p><i class="fa-solid fa-note-sticky" aria-label="Note icon"></i><span> </span><strong><span>Note:</span></strong><span> Apache Parquet is chosen because it will include the column headers from the source file. Column headers help new users of S3 Select to create queries and analyze them.</span></p></li></ul></li><li><p><span>In the </span><strong><span>Additional metadata fields</span></strong><span> section, select </span><em><span>all</span></em><span> fields in the </span><strong><span>Object</span></strong><span> list:</span></p><ul><li><p><span>Size</span></p></li><li><p><span>Last modified</span></p></li><li><p><span>Multipart upload</span></p></li><li><p><span>Replication status</span></p></li><li><p><span>Encryption</span></p></li><li><p><span>Bucket key status</span></p></li></ul></li></ul></li><li><p><span>Choose </span><strong><span>Create</span></strong><span>. </span></p><p><span>The inventory is created, and the configuration is listed in the </span><strong><span>Inventory configurations</span></strong><span> section, as shown in the following image:</span></p><p><img src="file:///C:/Users/chara/Downloads/images/task_4_inventory_configuration_listed.png" referrerpolicy="no-referrer" alt="Inventory configuration created"></p><p><i class="fa-solid fa-note-sticky" aria-label="Note icon"></i><span> </span><strong><span>Note:</span></strong><span> It can take up to 48 hours for AWS to deliver the first inventory report.</span></p></li></ul><p>&nbsp;</p><h3 id="a-idp1t4atask-14-confirm-that-versioning-works-as-intended"><a id="p1t4"></a><span>Task 1.4: Confirm that versioning works as intended</span></h3><p><a href="file:///C:/Users/chara/Downloads/IG.html#top" target="_self"><span>Return to table of contents</span></a></p><p><em><span>Reference the student instructions for details about what students should do in this task.</span></em></p><p><strong><span>Step 1:</span></strong><span> </span><em><span>Full click-level guidance is available in the student lab instructions.</span></em></p><p><strong><span>Solution to step 2:</span></strong></p><ul><li><p><span>Find the IAM user console sign-in link:</span></p><ul><li><p><span>In the IAM console navigation pane, choose </span><strong><span>Users</span></strong><span>.</span></p></li><li><p><span>Choose the link for </span><strong><span>paulo</span></strong><span>.</span></p></li><li><p><span>On the </span><strong><span>Security credentials</span></strong><span> tab, copy the </span><strong><span>Console sign-in link</span></strong><span>.</span></p></li></ul></li><li><p><span>Log into the console as the </span><em><span>paulo</span></em><span> user:</span></p><ul><li><p><span>Open a new incognito or private browser window and load the sign-in page.</span></p></li><li><p><span>Log in with the following credentials:</span></p><ul><li><p><span>IAM user name: Enter </span><code>paulo</code></p></li><li><p><span>Password: To find the password, choose </span><strong><span>AWS Details</span></strong><span> above the student instructions in the lab environment.</span></p></li></ul></li></ul></li><li><p><span>Upload a file to the </span><em><span>data-bucket</span></em><span>.</span></p><ul><li><p><span>Navigate to the Amazon S3 console.</span></p></li><li><p><span>On the buckets page, choose the link for </span><strong><span>data-bucket</span></strong><span>.</span></p></li><li><p><span>Choose </span><strong><span>Upload</span></strong><span>.</span></p></li><li><p><span>Choose </span><strong><span>Add files</span></strong><span>.</span></p></li><li><p><span>Browse to and select the </span><strong><span>customers.csv</span></strong><span> file, and then choose </span><strong><span>Open</span></strong><span>.</span></p></li><li><p><span>Choose </span><strong><span>Upload</span></strong><span>.</span></p></li><li><p><span>Choose </span><strong><span>Close</span></strong><span>.</span></p></li></ul></li><li><p><span>Review the encryption settings on the object:</span></p><ul><li><p><span>Choose the link for the </span><strong><span>customers.csv</span></strong><span> file.</span></p></li><li><p><span>On the </span><strong><span>Properties</span></strong><span> tab, review the </span><strong><span>Server-side encryption settings</span></strong><span> section.  </span></p><p><span>Notice that the object is encrypted with Amazon S3 managed keys (SSE-S3). This is because you accepted the default encryption settings when you created the bucket. </span></p></li></ul></li></ul><p><strong><span>Steps 3 and 4:</span></strong><span> </span><em><span>Full click-level guidance is available in the student lab instructions.</span></em></p><p><strong><span>Solution to step 5:</span></strong><span> </span><!--as paulo--></p><ul><li><p><span>In the browser window where you’re logged in as the </span><em><span>paulo</span></em><span> user, navigate to the Amazon S3 console.</span></p></li><li><p><span>On the buckets page, choose the link for </span><strong><span>data-bucket</span></strong><span>.</span></p></li><li><p><span>Choose </span><strong><span>Upload</span></strong><span>.</span></p></li><li><p><span>Choose </span><strong><span>Add files</span></strong><span>.</span></p></li><li><p><span>Browse to and select the updated </span><strong><span>customers.csv</span></strong><span> file, and then choose </span><strong><span>Open</span></strong><span>.</span></p></li><li><p><span>Choose </span><strong><span>Upload</span></strong><span>.</span></p></li><li><p><span>Choose </span><strong><span>Close</span></strong><span>.</span></p></li><li><p><span>Choose the link for the </span><strong><span>customers.csv</span></strong><span> file.</span></p></li><li><p><span>Choose the </span><strong><span>Versions</span></strong><span> tab.</span></p><p><span>Notice that two versions of the object are listed now. The page should look similar to the following.</span></p><p><img src="file:///C:/Users/chara/Downloads/images/task5_new_object_version.png" referrerpolicy="no-referrer" alt="New S3 object version"></p></li></ul><p><strong><span>Solution to step 6:</span></strong><span> </span><!--as paulo--></p><ul><li><p><span>On the </span><strong><span>Versions</span></strong><span> tab for the </span><em><span>customers.csv</span></em><span> object, select the </span><em><span>current version</span></em><span> and choose </span><strong><span>Open</span></strong><span>.</span></p><p><span>Confirm that the current version contains all four rows of records.</span></p></li><li><p><span>Select the </span><em><span>previous version</span></em><span> and choose </span><strong><span>Open</span></strong><span>.</span></p><p><span>Confirm that the previous version contains only two rows of records.</span></p></li></ul><p><strong><span>Solution to step 7 :</span></strong><span> </span><!--switching from paulo to mary and then signing out--></p><ul><li><p><span>To sign out of the console, choose </span><strong><span>paulo @ xxxxx</span></strong><span> in the top-right corner, and choose </span><strong><span>Sign out</span></strong><span>.</span></p></li><li><p><span>Return to the browser tab where you’re logged in to the console as the </span><em><span>voclabs</span></em><span> role.</span></p></li><li><p><span>Find the IAM user console sign-in link:</span></p><ul><li><p><span>In the IAM console navigation pane, choose </span><strong><span>Users</span></strong><span>.</span></p></li><li><p><span>Choose the link for </span><strong><span>mary</span></strong><span>.</span></p></li><li><p><span>On the </span><strong><span>Security credentials</span></strong><span> tab, copy the </span><strong><span>Console sign-in link</span></strong><span>.</span></p></li></ul></li><li><p><span>Log in to the console as the </span><em><span>mary</span></em><span> user:</span></p><ul><li><p><span>Open a new incognito or private browser window and load the sign-in page.</span></p></li><li><p><span>Log in with the following credentials:</span></p><ul><li><p><span>IAM user name: Enter </span><code>mary</code></p></li><li><p><span>Password: To find the password, choose </span><strong><span>AWS Details</span></strong><span> above the student instructions in the lab environment.</span></p></li></ul></li></ul></li><li><p><span>Take action in Amazon S3 as the </span><em><span>mary</span></em><span> user:</span></p><ul><li><p><span>Navigate to the Amazon S3 console.</span></p></li><li><p><span>From the buckets list, choose the link for </span><strong><span>data-bucket</span></strong><span>.</span></p><p><span>You receive an error message, as expected.</span></p></li></ul></li><li><p><span>To sign out of the console, choose </span><strong><span>mary @ xxxxx</span></strong><span> in the top-right corner, and choose </span><strong><span>Sign out</span></strong><span>.</span></p></li><li><p><span>Close the incognito or private window.</span></p></li></ul><h3 id="a-idp1t5atask-15-confirm-object-level-logging-and-query-the-access-logs-by-using-athena"><a id="p1t5"></a><span>Task 1.5: Confirm object-level logging and query the access logs by using Athena</span></h3><p><a href="file:///C:/Users/chara/Downloads/IG.html#top" target="_self"><span>Return to table of contents</span></a></p><p><em><span>Reference the student instructions for details about what students should do in this task.</span></em></p><p><strong><span>Solution to step 1:</span></strong><span> </span><!--as voclabs--></p><ul><li><p><span>In the browser session where you're logged in to the console as the </span><em><span>voclabs</span></em><span> role, navigate to the Amazon S3 console.</span></p></li><li><p><span>In the buckets list, choose the link for </span><strong><span>s3-objects-access-log</span></strong><span>.</span></p><p><span>On the </span><strong><span>Objects</span></strong><span> tab, notice that many log files are listed. </span></p></li><li><p><span>Download one of the files, open it, and review the contents.</span></p></li></ul><p><strong><span>Solution to step 2:</span></strong></p><ul><li><p><span>Create an S3 bucket named </span><code>athena-results-&lt;random-number&gt;</code><span> where </span><code>&lt;random-number&gt;</code><span> is some random number. Accept the default bucket settings.</span></p></li><li><p><span>Navigate to the Athena console.</span></p></li><li><p><span>Choose </span><strong><span>Launch query editor</span></strong><span>.</span></p></li><li><p><span>Choose </span><strong><span>Edit settings</span></strong><span> and configure the following:</span></p><ul><li><p><span>Location of query result: Choose </span><strong><span>Browse S3</span></strong><span>, choose the </span><strong><span>athena-results</span></strong><span> bucket, and select </span><strong><span>Choose</span></strong><span>.</span></p></li><li><p><span>Choose </span><strong><span>Save</span></strong><span>.</span></p></li></ul></li><li><p><span>Choose the </span><strong><span>Editor</span></strong><span> tab.</span></p></li><li><p><span>Paste the following query into the query area:</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="sql" style="break-inside: unset;"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="sql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: currentcolor;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: currentcolor;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">CREATE</span> EXTERNAL <span class="cm-keyword">TABLE</span> <span class="cm-variable-2">`default.bucket_logs`</span><span class="cm-bracket">(</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable-2">`bucketowner`</span> STRING<span class="cm-punctuation">,</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable-2">`bucket_name`</span> STRING<span class="cm-punctuation">,</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable-2">`requestdatetime`</span> STRING<span class="cm-punctuation">,</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable-2">`remoteip`</span> STRING<span class="cm-punctuation">,</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable-2">`requester`</span> STRING<span class="cm-punctuation">,</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable-2">`requestid`</span> STRING<span class="cm-punctuation">,</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable-2">`operation`</span> STRING<span class="cm-punctuation">,</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable-2">`key`</span> STRING<span class="cm-punctuation">,</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable-2">`request_uri`</span> STRING<span class="cm-punctuation">,</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable-2">`httpstatus`</span> STRING<span class="cm-punctuation">,</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable-2">`errorcode`</span> STRING<span class="cm-punctuation">,</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable-2">`bytessent`</span> <span class="cm-type">BIGINT</span><span class="cm-punctuation">,</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable-2">`objectsize`</span> <span class="cm-type">BIGINT</span><span class="cm-punctuation">,</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable-2">`totaltime`</span> STRING<span class="cm-punctuation">,</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable-2">`turnaroundtime`</span> STRING<span class="cm-punctuation">,</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable-2">`referrer`</span> STRING<span class="cm-punctuation">,</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable-2">`useragent`</span> STRING<span class="cm-punctuation">,</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable-2">`versionid`</span> STRING<span class="cm-punctuation">,</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable-2">`hostid`</span> STRING<span class="cm-punctuation">,</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable-2">`sigv`</span> STRING<span class="cm-punctuation">,</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable-2">`ciphersuite`</span> STRING<span class="cm-punctuation">,</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable-2">`authtype`</span> STRING<span class="cm-punctuation">,</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable-2">`endpoint`</span> STRING<span class="cm-punctuation">,</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable-2">`tlsversion`</span> STRING<span class="cm-punctuation">,</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable-2">`accesspointarn`</span> STRING<span class="cm-punctuation">,</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable-2">`aclrequired`</span> STRING<span class="cm-bracket">)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">ROW</span> FORMAT SERDE </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-string">'org.apache.hadoop.hive.serde2.RegexSerDe'</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">WITH</span> SERDEPROPERTIES <span class="cm-bracket">(</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-string">'input.regex'</span><span class="cm-operator">=</span><span class="cm-string">'([^ ]*) ([^ ]*) \\[(.*?)\\] ([^ ]*) ([^ ]*) ([^ ]*) ([^ ]*) ([^ ]*) (\"[^\"]*\"|-) (-|[0-9]*) ([^ ]*) ([^ ]*) ([^ ]*) ([^ ]*) ([^ ]*) ([^ ]*) (\"[^\"]*\"|-) ([^ ]*)(?: ([^ ]*) ([^ ]*) ([^ ]*) ([^ ]*) ([^ ]*) ([^ ]*) ([^ ]*) ([^ ]*))?.*$'</span><span class="cm-bracket">)</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">STORED <span class="cm-keyword">AS</span> INPUTFORMAT </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-string">'org.apache.hadoop.mapred.TextInputFormat'</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">OUTPUTFORMAT </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-string">'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat'</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">LOCATION</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-string">'s3://s3-objects-access-log-&lt;UNIQUE-ID&gt;/'</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 858px;"></div><div class="CodeMirror-gutters" style="display: none; height: 858px;"></div></div></div></pre><p><i class="fa-solid fa-note-sticky" aria-label="Note icon"></i><span> </span><strong><span>Note:</span></strong><span> This query is from </span><a href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/using-s3-access-logs-to-identify-requests.html#querying-s3-access-logs-for-requests"><span>Querying Access Logs for Requests Using Amazon Athena</span></a><span> in the </span><em><span>Amazon S3 User Guide</span></em><span>.</span></p><ul><li><p><span>Before you run the query, replace the </span><code>&lt;UNIQUE-ID&gt;</code><span> placeholder on the last line with the unique ID from the name of your </span><em><span>s3-objects-access-log</span></em><span> bucket.</span></p></li></ul></li></ul><ul><li><p><span>Run the query.</span></p><p><span>The </span><strong><span>Query results</span></strong><span> tab indicates that the query was successful. A table named </span><em><span>bucket_logs</span></em><span> is now available in the </span><strong><span>Tables</span></strong><span> area on the left.</span></p></li></ul><p><strong><span>Solution to Step 3:</span></strong><span> </span></p><ul><li><p><span>In the </span><strong><span>Tables</span></strong><span> area, to the right of the </span><strong><span>bucket_logs</span></strong><span> table name, choose the ellipsis icon, and then choose </span><strong><span>Preview Table</span></strong><span>.</span></p><p><span>On the </span><strong><span>Query results</span></strong><span> tab, notice that rows of data from the S3 object-level logs appear. If data doesn't appear, you might need to wait longer before running the query.</span></p></li><li><p><span>Run the following query.</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="sql"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="sql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: currentcolor;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: currentcolor;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">SELECT</span> requester<span class="cm-punctuation">,</span> operation<span class="cm-punctuation">,</span> <span class="cm-keyword">key</span><span class="cm-punctuation">,</span> httpstatus</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-keyword">FROM</span> <span class="cm-string">"default"</span>.<span class="cm-string">"bucket_logs"</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-keyword">WHERE</span> requester <span class="cm-keyword">LIKE</span> <span class="cm-string">'arn:aws:iam%'</span><span class="cm-punctuation">;</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 66px;"></div><div class="CodeMirror-gutters" style="display: none; height: 66px;"></div></div></div></pre></li></ul><p><span>The following image provides an example of the query results from step 3. (This image is not provided to students.):</span></p><p><img src="file:///C:/Users/chara/Downloads/images/athena-results.png" referrerpolicy="no-referrer" alt="screenshot of log query results including entries from paulo and mary actions"></p><p><strong><span>Instructional note</span></strong><span>: In steps 2 and 3, students use Athena to query the object-level logs. Step 3 provides a sample query for students to run, but you could encourage students to run other queries to gain other insights. For examples, see </span><a href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/using-s3-access-logs-to-identify-requests.html#querying-s3-access-logs-for-requests"><span>Querying Access Logs for Requests Using Amazon Athena</span></a><span> in the </span><em><span>Amazon S3 User Guide</span></em><span>.</span></p><p>&nbsp;</p><h3 id="a-idp1t6atask-16-review-the-s3-inventory-report-by-using-s3-select"><a id="p1t6"></a><span>Task 1.6: Review the S3 Inventory report by using S3 Select</span></h3><p><a href="file:///C:/Users/chara/Downloads/IG.html#top" target="_self"><span>Return to table of contents</span></a></p><p><em><span>Reference the student instructions for details about what students should do in this task.</span></em></p><p>&nbsp;</p><p><strong><span>Solution to step 1:</span></strong></p><ul><li><p><span>In the Amazon S3 console, in the buckets list, choose the link for </span><strong><span>data-bucket</span></strong><span>.</span></p></li><li><p><span>Choose the </span><strong><span>Management</span></strong><span> tab.</span></p></li><li><p><span>In the </span><strong><span>Inventory configurations</span></strong><span> section, choose the </span><strong><span>Destination</span></strong><span> link for the </span><strong><span>Inventory</span></strong><span> configuration. </span></p><p><span>You are taken to the </span><em><span>s3-inventory</span></em><span> bucket.</span></p></li></ul><p><strong><span>Solution to step 2:</span></strong></p><ul><li><p><span>On the </span><em><span>s3-inventory</span></em><span> bucket details page, open the </span><strong><span>data-bucket</span></strong><span> folder.</span></p></li><li><p><span>Open the </span><strong><span>Inventory</span></strong><span> folder, and then open the </span><strong><span>data</span></strong><span> folder.</span></p></li><li><p><span>Select the </span><em><span>latest</span></em><span> .parquet file (you might only see one).</span></p><p><i class="fa-solid fa-circle-exclamation" aria-label="Important icon"></i><span>  </span><strong><span>Important:</span></strong><span> It can take up to 48 hours for AWS to deliver the first inventory report. If you don't yet see data, you might need to skip this task and return to it later.</span></p></li><li><p><span>Choose </span><strong><span>Actions</span></strong><span> &gt; </span><strong><span>Query with S3 Select</span></strong><span>, and configure the following</span></p><ul><li><p><span>Input settings - Format: </span><strong><span>Apache Parquet</span></strong></p></li><li><p><span>Output settings - Format: </span><strong><span>JSON</span></strong></p></li><li><p><span>Choose </span><strong><span>Run SQL query</span></strong><span>.</span></p></li></ul></li><li><p><span>Review the query results.</span></p></li></ul><h3 id="a-idp1costacost-assessment-to-secure-amazon-s3"><a id="p1cost"></a><span>Cost assessment to secure Amazon S3</span></h3><p><a href="file:///C:/Users/chara/Downloads/IG.html#top" target="_self"><span>Return to table of contents</span></a></p><p><strong><span>Question</span></strong>
<span>In this lab, does your use of these Amazon S3 security features result in additional cost in the account? If so, how much do you estimate that it will cost?</span></p><p><strong><span>Answer</span></strong>
<span>When students answer this question, they need to focus on the context of the solution. Three costs are associated with this phase:</span></p><ul><li><p><strong><span>Storage:</span></strong><span> In this lab, you are using the S3 Standard storage class. The other storage classes (such as S3 Intelligent-Tiering and S3 Glacier) have different costs and considerations. The rate that you're charged depends on object size, how long objects are stored, and storage class. The fact that students enabled versioning, means there may be multiple versions of some objects and so that can increase storage costs.</span></p></li><li><p><strong><span>Data transfer:</span></strong><span> You pay for all bandwidth into and out of Amazon S3. Querying the logs stored in S3 could incur a data transfer cost.</span></p></li><li><p><strong><span>Management and insights:</span></strong><span> The S3 Inventory feature incurs a cost (per million objects listed) when enabled.</span></p></li></ul><p>&nbsp;</p><h2 id="a-idp2aphase-2-securing-vpcs"><a id="p2"></a><span>Phase 2: Securing VPCs </span></h2><p><a href="file:///C:/Users/chara/Downloads/IG.html#top" target="_self"><span>Return to table of contents</span></a></p><!--PER PRODUCT TEAM: This phase should provide diagrams for all tasks (to the student) - except for the Network Firewall task where we ask the student to create a diagram. --><h3 id="a-idp2t1atask-21-review-labvpc-and-its-associated-resources"><a id="p2t1"></a><span>Task 2.1: Review LabVPC and its associated resources</span></h3><p><a href="file:///C:/Users/chara/Downloads/IG.html#top" target="_self"><span>Return to table of contents</span></a></p><p><em><span>Reference the student instructions for details about what students should do in this task.</span></em></p><p><strong><span>Solution to step 1:</span></strong></p><ul><li><p><span>Navigate to the Amazon VPC console.</span></p></li><li><p><span>Choose </span><strong><span>VPCs</span></strong><span>.</span></p></li><li><p><span>Choose the </span><strong><span>VPC ID</span></strong><span> link for </span><strong><span>LabVPC</span></strong><span>.</span></p></li><li><p><span>In the </span><strong><span>Resource map</span></strong><span> tab, choose </span><strong><span>Show details</span></strong><span>.  </span></p><p><span>The VPC details display. The following image provides an example:</span></p><p><img src="file:///C:/Users/chara/Downloads/images/resource_map.png" referrerpolicy="no-referrer" alt="VPC Resource map screenshot"></p><p>&nbsp;</p></li></ul><p><strong><span>Solution to step 2:</span></strong></p><ul><li><p><span>Navigate to the IAM console.</span></p></li><li><p><span>In the navigation pane, choose </span><strong><span>Roles</span></strong><span>.</span></p></li><li><p><span>Choose the link for </span><strong><span>VPCFlowLogsRole</span></strong><span>.</span></p></li><li><p><span>In the </span><strong><span>Permissions policies</span></strong><span> section, expand </span><strong><span>VPCFlowLogPolicy</span></strong><span>, and review the permissions that the policy provides.</span></p><p>&nbsp;</p></li></ul><p><strong><span>Solution to step 3:</span></strong></p><ul><li><p><span>Navigate to the Amazon EC2 console.</span></p></li><li><p><span>Choose </span><strong><span>Instances</span></strong><span>.</span></p></li><li><p><span>Select the </span><strong><span>WebServer</span></strong><span> instance.</span></p><p><span>Details about the instance appear in the lower pane.</span></p></li><li><p><span>On the </span><strong><span>Details</span></strong><span> tab, observe the public IPv4 address.</span></p></li><li><p><span>On the </span><strong><span>Security</span></strong><span> tab, you can see that an IAM role named </span><em><span>WebServerRole</span></em><span> is attached. You can also see that a security group named </span><em><span>WebServerSecurityGroup</span></em><span> is associated with the instance.</span></p></li><li><p><span>On the </span><strong><span>Networking</span></strong><span> tab, observe that the instance runs in a subnet named </span><em><span>WebServerSubnet</span></em><span>. </span></p></li></ul><p>&nbsp;</p><h3 id="a-idp2t2atask-22-create-a-vpc-flow-log"><a id="p2t2"></a><span>Task 2.2: Create a VPC flow log</span></h3><p><a href="file:///C:/Users/chara/Downloads/IG.html#top" target="_self"><span>Return to table of contents</span></a></p><p><em><span>Reference the student instructions for details about what students should do in this task.</span></em></p><p><strong><span>Solution:</span></strong></p><ul><li><p><span>Navigate to the Amazon VPC console.</span></p></li><li><p><span>Choose </span><strong><span>VPCs</span></strong><span>.</span></p></li><li><p><span>Select </span><strong><span>LabVPC</span></strong><span>.</span></p></li><li><p><span>In the lower pane, choose the </span><strong><span>Flow logs</span></strong><span> tab.</span></p></li><li><p><span>Choose </span><strong><span>Create flow log</span></strong><span>, and configure the following:</span></p><ul><li><p><span>Name: </span><code>LabVPCFlowLogs</code></p></li><li><p><span>Filter: </span><strong><span>All</span></strong></p></li><li><p><span>Maximum aggregation interval: </span><strong><span>1 minute</span></strong></p></li><li><p><span>Destination: </span><strong><span>Send to CloudWatch Logs</span></strong></p></li><li><p><span>Destination log group: Enter </span><code>LabVPCFlowLogs</code><span> (It will be a new log group.)</span></p></li><li><p><span>IAM role: </span><strong><span>VPCFlowLogsRole</span></strong></p></li><li><p><span>Log record format: </span><strong><span>AWS default format</span></strong></p></li><li><p><span>Choose </span><strong><span>Create flow log</span></strong><span>.</span></p></li></ul></li><li><p><span>With </span><em><span>LabVPC</span></em><span> selected, choose the </span><strong><span>Flow logs</span></strong><span> tab in the lower pane again.</span></p><p><span>Confirm that the flow log was created. The tab should look similar to the following image:</span></p><p><img src="file:///C:/Users/chara/Downloads/images/vpc_flow_log_created.png" referrerpolicy="no-referrer" alt="Screenshot showing VPC Flow Log created"></p></li></ul><p>&nbsp;</p><h3 id="a-idp2t3atask-23-access-the-webserver-instance-from-the-internet-and-review-vpc-flow-logs-in-cloudwatch"><a id="p2t3"></a><span>Task 2.3: Access the WebServer instance from the internet and review VPC flow logs in CloudWatch</span></h3><p><a href="file:///C:/Users/chara/Downloads/IG.html#top" target="_self"><span>Return to table of contents</span></a></p><p><em><span>Reference the student instructions for details about what students should do in this task.</span></em></p><p><strong><span>Solution to step 1:</span></strong></p><ul><li><p><span>Retrieve the public IPv4 address for the </span><em><span>WebServer</span></em><span> instance.</span></p><ul><li><p><span>Navigate to the Amazon EC2 console.</span></p></li><li><p><span>Choose </span><strong><span>Instances</span></strong><span>.</span></p></li><li><p><span>Select the </span><strong><span>WebServer</span></strong><span> instance.</span></p></li><li><p><span>From the </span><strong><span>Details</span></strong><span> tab in the lower pane, copy the </span><strong><span>Public IPv4 address</span></strong><span>.</span></p></li></ul></li><li><p><span>In a new browser tab, try to load </span><code>http://&lt;WebServer-public-IP&gt;</code><span> where </span><code>&lt;WebServer-public-IP&gt;</code><span> is the IP address that you copied.</span></p><p><strong><span>Analysis</span></strong><span> (</span><em><span>not provided in student instructions</span></em><span>): You can’t connect to website for two reasons. First, the security group that is associated with this instance has inbound traffic blocked on port 80. Second, a route for traffic to or from the internet isn't configured for the instance.</span></p><p>&nbsp;</p></li></ul><p><strong><span>Solution to step 2:</span></strong></p><ul><li><p><span>Navigate to the AWS Cloud9 console.</span></p></li><li><p><span>In the environments list, choose the </span><strong><span>Open</span></strong><span> link for the </span><strong><span>Cloud9Instance</span></strong><span> environment.</span></p></li><li><p><span>To try to access the instance over the standard HTTP port (80), run the following command, replacing the placeholder with the correct value:</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="bash"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: currentcolor;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: currentcolor;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">nc</span> <span class="cm-attribute">-vz</span> &lt;WebServer-public-IP&gt; <span class="cm-number">80</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 22px;"></div><div class="CodeMirror-gutters" style="display: none; height: 22px;"></div></div></div></pre><p><span>After some time passes, the connection fails or times out.</span></p><p><i class="fa-solid fa-lightbulb" aria-label="Tip icon"></i><span> </span><strong><span>Tip:</span></strong><span> To stop the command before the connection fails or times out, press Ctrl+C.</span></p></li><li><p><span>Next, try to access the instance over the standard SSH port (22), by running the following command, replacing the placeholder with the correct value:</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="bash"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: currentcolor;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: currentcolor;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">nc</span> <span class="cm-attribute">-vz</span> &lt;WebServer-public-IP&gt; <span class="cm-number">22</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 22px;"></div><div class="CodeMirror-gutters" style="display: none; height: 22px;"></div></div></div></pre><p><span>This second connection also fails or times out. </span></p><p>&nbsp;</p></li></ul><p><strong><span>Solution to step 3:</span></strong></p><ul><li><p><span>Navigate to the CloudWatch console.</span></p></li><li><p><span>In the navigation pane, choose </span><strong><span>Log groups</span></strong><span>.</span></p></li><li><p><span>Choose the link for the </span><strong><span>LabVPCFlowLogs</span></strong><span> log group.</span></p></li><li><p><span>Choose the link for the only log stream that is listed.</span></p><p>&nbsp;</p></li></ul><p><strong><span>Solution to step 4:</span></strong></p><ul><li><p><span>To retrieve the public IP address of the AWS Cloud9 instance, run the following command:</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="bash"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: currentcolor;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: currentcolor;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">curl</span> http://169.254.169.254/latest/meta-data/public-ipv4</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 22px;"></div><div class="CodeMirror-gutters" style="display: none; height: 22px;"></div></div></div></pre><p><strong><span>Note</span></strong><span>: Alternatively, you could find the IP address in the Amazon EC2 console, on the </span><strong><span>Details</span></strong><span> tab for the </span><em><span>aws-cloud9</span></em><span> instance.</span></p></li><li><p><span>Copy the IP address that is returned.</span></p></li><li><p><span>Return to the </span><strong><span>Log events</span></strong><span> page for </span><em><span>LabVPCFlowLogs</span></em><span> in the CloudWatch console.</span></p></li><li><p><span>Paste the IP address in the search field above the list of events, and press Enter. </span></p></li><li><p><strong><span>Optional:</span></strong><span> Filter the log entries by the IP address of your computer:</span></p><ul><li><p><span>In a new browser tab, go to </span><a href="http://www.whatismyip.com/" target="_blank" class="url">www.whatismyip.com</a><span>.</span></p></li><li><p><span>Copy your public IPv4 address.</span></p></li><li><p><span>Return to the </span><strong><span>Log events</span></strong><span> page for </span><em><span>LabVPCFlowLogs</span></em><span> in the CloudWatch console.</span></p></li><li><p><span>Paste the IP address in the search field above the list of events, and press Enter.</span></p><p>&nbsp;</p></li></ul></li></ul><h3 id="a-idp2t4atask-24-configure-route-table-and-security-group-settings"><a id="p2t4"></a><span>Task 2.4: Configure route table and security group settings</span></h3><p><a href="file:///C:/Users/chara/Downloads/IG.html#top" target="_self"><span>Return to table of contents</span></a></p><p><em><span>Reference the student instructions for details about what students should do in this task.</span></em></p><p><strong><span>Solution to step 1:</span></strong></p><ul><li><p><span>Navigate to the Amazon VPC console.</span></p></li><li><p><span>In the navigation pane, from the </span><strong><span>Filter by VPC</span></strong><span> dropdown menu, select </span><strong><span>LabVPC</span></strong><span>.</span></p></li><li><p><span>Choose </span><strong><span>Route tables</span></strong><span>.</span></p></li><li><p><span>Choose the </span><strong><span>Route table ID</span></strong><span> link for the route table that is associated with </span><em><span>LabVPC</span></em><span>.</span></p><p><span>Notice that only one route is defined in this route table. The route has a target of </span><em><span>local</span></em><span>, which means that the route table only routes traffic between servers that are running in the same VPC.</span></p></li><li><p><span>Choose </span><strong><span>Edit routes</span></strong><span>.</span></p></li><li><p><span>Choose </span><strong><span>Add route</span></strong><span> and configure the following:</span></p><ul><li><p><span>Destination: </span><code>0.0.0.0/0</code></p></li><li><p><span>Target: Choose </span><strong><span>Internet Gateway</span></strong><span>, and then choose </span><strong><span>LabVPCIG</span></strong><span>.</span></p></li><li><p><span>Choose </span><strong><span>Save changes</span></strong><span>.</span></p></li></ul></li></ul><p><strong><span>Solution to step 2:</span></strong></p><ul><li><p><span>To test access from port 80 to the </span><em><span>WebServer</span></em><span> instance again, return to the AWS Cloud9 IDE and run the following command. Replace </span><code>&lt;WebServer-public-IP&gt;</code><span> with the public IP address of the </span><em><span>WebServer</span></em><span> instance.</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="bash"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: currentcolor;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: currentcolor;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">nc</span> <span class="cm-attribute">-vz</span> &lt;WebServer-public-IP&gt; <span class="cm-number">80</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 22px;"></div><div class="CodeMirror-gutters" style="display: none; height: 22px;"></div></div></div></pre></li></ul><p><strong><span>Solution to step 3:</span></strong></p><ul><li><p><span>Navigate to the Amazon EC2 console.</span></p></li><li><p><span>Choose </span><strong><span>Instances</span></strong><span>.</span></p></li><li><p><span>Select the </span><strong><span>WebServer</span></strong><span> instance.</span></p></li><li><p><span>On the </span><strong><span>Security</span></strong><span> tab, choose the link for </span><strong><span>WebServerSecurityGroup</span></strong><span>, which is already associated with the instance.</span></p></li><li><p><span>On the </span><strong><span>Inbound rules</span></strong><span> tab, choose </span><strong><span>Edit inbound rules</span></strong><span>.</span></p></li><li><p><span>Delete the existing </span><em><span>port 8080</span></em><span> rule.</span></p></li><li><p><span>Choose </span><strong><span>Add rule</span></strong><span> and configure the following:</span></p><ul><li><p><span>Type: </span><strong><span>HTTP</span></strong></p></li><li><p><span>Source: </span><strong><span>Anywhere-IPv4</span></strong><span> </span></p></li><li><p><span>Description: </span><code>HTTP from anywhere</code><span> </span></p><p><i class="fa-solid fa-circle-exclamation" aria-label="Important icon"></i><span>  </span><strong><span>Important:</span></strong><span> Don’t save the changes yet. You will return to this browser tab in a moment.</span></p></li></ul></li><li><p><span>Retrieve the public IP address for the AWS Cloud9 instance:</span></p><ul><li><p><span>In a separate browser tab, return to the AWS Cloud9 IDE.</span>
<span>Run the following command:</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="bash"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: currentcolor;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: currentcolor;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">curl</span> http://169.254.169.254/latest/meta-data/public-ipv4</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 22px;"></div><div class="CodeMirror-gutters" style="display: none; height: 22px;"></div></div></div></pre><p><strong><span>Note</span></strong><span>: Alternatively, you could find the IP address in the Amazon EC2 console, on the </span><strong><span>Details</span></strong><span> tab for the </span><em><span>aws-cloud9</span></em><span> instance.</span></p></li></ul></li><li><p><span>Return to the tab where you are updating the security group.</span></p></li><li><p><span>Choose </span><strong><span>Add rule</span></strong><span> and configure the following:</span></p><ul><li><p><span>Type: </span><strong><span>SSH</span></strong></p></li><li><p><span>Source: Paste the public IP address for the AWS Cloud9, and then append </span><code>/32</code><span> to it.</span></p></li><li><p><span>Description: </span><code>SSH from Cloud9</code><span> </span></p><p><i class="fa-solid fa-circle-exclamation" aria-label="Important icon"></i><span>  </span><strong><span>Important:</span></strong><span> Don’t save the changes yet. You will return to this browser tab in a moment.</span></p></li></ul></li><li><p><span>Discover the IP address range to allow you to use EC2 Instance Connect to connect to the </span><em><span>WebServer</span></em><span> instance:</span></p><ul><li><p><span>In a separate browser tab, return to the AWS Cloud9 IDE.</span></p></li><li><p><span>Run the following commands:</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="bash"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: currentcolor;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: currentcolor;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">sudo</span> yum install <span class="cm-attribute">-y</span> jq</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">curl</span> https://ip-ranges.amazonaws.com/ip-ranges.json| jq <span class="cm-attribute">-r</span> <span class="cm-string">'.prefixes[] | select(.region=="us-east-1") | select(.service=="EC2_INSTANCE_CONNECT") | .ip_prefix'</span> </span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 66px;"></div><div class="CodeMirror-gutters" style="display: none; height: 66px;"></div></div></div></pre></li></ul><p><span>The last command returns the following IP address range: </span><code>18.206.107.24/29</code></p></li><li><p><span>Return to the tab where you are updating the security group.</span></p></li><li><p><span>Choose </span><strong><span>Add rule</span></strong><span> and configure the following:</span></p><ul><li><p><span>Type: </span><strong><span>SSH</span></strong></p></li><li><p><span>Source: </span><code>18.206.107.24/29</code><span> </span></p></li><li><p><span>Description: </span><code>SSH to allow EC2 Instance Connect</code><span> </span></p></li></ul></li><li><p><span>Choose </span><strong><span>Save rules</span></strong><span>. </span></p></li></ul><p><strong><span>Solution to step 4:</span></strong></p><ul><li><p><span>To test access from port 22 to the </span><em><span>WebServer</span></em><span> instance again, return to the AWS Cloud9 IDE and run the following command. Replace </span><code>&lt;WebServer-public-IP&gt;</code><span> with the public IP address of the </span><em><span>WebServer</span></em><span> instance.</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="bash"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: currentcolor;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: currentcolor;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">nc</span> <span class="cm-attribute">-vz</span> &lt;WebServer-public-IP&gt; <span class="cm-number">22</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 22px;"></div><div class="CodeMirror-gutters" style="display: none; height: 22px;"></div></div></div></pre><p><span>The test should be successful.  </span></p></li></ul><p><strong><span>Solution to step 5:</span></strong></p><ul><li><p><span>Retrieve the public IPv4 address for the </span><em><span>WebServer</span></em><span> instance.</span></p><ul><li><p><span>Navigate to the Amazon EC2 console.</span></p></li><li><p><span>Choose </span><strong><span>Instances</span></strong><span>.</span></p></li><li><p><span>Select the </span><strong><span>WebServer</span></strong><span> instance.</span></p></li><li><p><span>From the </span><strong><span>Details</span></strong><span> tab in the lower pane, copy the </span><strong><span>Public IPv4 address</span></strong><span>.</span></p></li></ul></li><li><p><span>In a new browser tab, try to load </span><code>http://&lt;WebServer-public-IP&gt;</code><span> where </span><code>&lt;WebServer-public-IP&gt;</code><span> is the public IP address of the </span><em><span>WebServer</span></em><span> instance.</span></p><p><span>The test should be successful. The message "Hello world from WebServer!" displays.</span></p></li></ul><p><strong><span>Solution to step 6:</span></strong></p><ul><li><p><span>Navigate to the Amazon EC2 console.</span></p></li><li><p><span>Choose </span><strong><span>Instances</span></strong><span>.</span></p></li><li><p><span>Select the </span><strong><span>WebServer</span></strong><span> instance, and then choose </span><strong><span>Connect</span></strong><span>.</span></p></li><li><p><span>On the </span><strong><span>EC2 Instance Connect</span></strong><span> tab, choose </span><strong><span>Connect</span></strong><span>. </span></p><p><span>An EC2 Instance Connect terminal session opens and displays a </span><code>$</code><span> prompt. </span></p></li><li><p><span>To ping a public website (Amazon.com) three times, run the following command:</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="bash"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: currentcolor;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: currentcolor;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">ping</span> <span class="cm-attribute">-c</span> <span class="cm-number">3</span> www.amazon.com</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 22px;"></div><div class="CodeMirror-gutters" style="display: none; height: 22px;"></div></div></div></pre><p><span>The result shows that three responses are sent back. Each response has 64 bytes of data.</span></p></li><li><p><span>Answer to the question "</span><em><span>What were the essential configurations you made that enabled internet access from the instance but also secured it?</span></em><span>"</span></p><ul><li><p><span>Added a route for the </span><em><span>WebServer</span></em><span> instance to and from the internet via an Internet Gateway. </span></p></li><li><p><span>Added an inbound rule for port 80 (HTTP) to the security group for the instance.</span></p></li><li><p><span>Restricted access so that SSH connections are only accepted from your AWS Cloud9 instance or EC2 Instance Connect. </span></p></li><li><p><span>Besides HTTP and SSH, no other TCP ports were opened in the security group.</span></p></li></ul></li></ul><p>&nbsp;</p><h3 id="a-idp2t5atask-25-secure-the-webserversubnet-with-a-network-acl"><a id="p2t5"></a><span>Task 2.5: Secure the WebServerSubnet with a network ACL</span></h3><p><a href="file:///C:/Users/chara/Downloads/IG.html#top" target="_self"><span>Return to table of contents</span></a></p><p><em><span>Reference the student instructions for details about what students should do in this task.</span></em></p><p><strong><span>Solution to step 1:</span></strong></p><ul><li><p><span>Navigate to the Amazon VPC console.</span></p></li><li><p><span>Choose </span><strong><span>Network ACLs</span></strong><span>.</span></p></li><li><p><span>Choose the </span><strong><span>Network ACL ID</span></strong><span> link for the network ACL that is associated with </span><em><span>WebServerSubnet</span></em><span> in </span><em><span>LabVPC</span></em><span>. </span></p></li></ul><p><strong><span>Solution to step 2:</span></strong></p><ul><li><p><span>On the details page for the network ACL, on the </span><strong><span>Inbound rules</span></strong><span> tab, choose </span><strong><span>Edit inbound rules</span></strong><span>.</span></p></li><li><p><span>For rule number </span><strong><span>100</span></strong><span>, in the </span><strong><span>Allow/Deny</span></strong><span> column, choose </span><strong><span>Deny</span></strong><span>.</span></p></li><li><p><span>Choose </span><strong><span>Save changes</span></strong><span>. </span></p></li><li><p><span>In the AWS Cloud9 IDE, to test access to port 22 on the </span><em><span>WebServer</span></em><span> instance again, run the following command. Replace </span><code>&lt;WebServer-public-IP&gt;</code><span> with the public IPv4 address of the </span><em><span>WebServer</span></em><span> instance:</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="bash"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: currentcolor;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: currentcolor;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">nc</span> <span class="cm-attribute">-vz</span> &lt;WebServer-public-IP&gt; <span class="cm-number">22</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 22px;"></div><div class="CodeMirror-gutters" style="display: none; height: 22px;"></div></div></div></pre><p><span>The connection fails.</span></p></li></ul><p><strong><span>Solution to step 3:</span></strong></p><ul><li><p><span>Retrieve the public IPv4 address for the </span><em><span>WebServer</span></em><span> instance.</span></p><ul><li><p><span>Navigate to the Amazon EC2 console.</span></p></li><li><p><span>Choose </span><strong><span>Instances</span></strong><span>.</span></p></li><li><p><span>Select the </span><strong><span>WebServer</span></strong><span> instance.</span></p></li><li><p><span>From the </span><strong><span>Details</span></strong><span> tab in the lower pane, copy the </span><strong><span>Public IPv4 address</span></strong><span>.</span></p></li></ul></li><li><p><span>In a new browser tab, try to load </span><code>http://&lt;WebServer-public-IP&gt;</code><span> where </span><code>&lt;WebServer-public-IP&gt;</code><span> is the public IP address of the </span><em><span>WebServer</span></em><span> instance.</span></p><p><span>The connection times out.</span></p></li></ul><p><strong><span>Solution to step 4:</span></strong></p><ul><li><p><span>On the </span><strong><span>Inbound rules</span></strong><span> tab for the network ACL, choose </span><strong><span>Edit inbound rules</span></strong><span>.</span></p></li><li><p><span>Modify rule number </span><strong><span>100</span></strong><span> as follows:</span></p><ul><li><p><span>Type: </span><strong><span>SSH (22)</span></strong></p></li><li><p><span>Allow/Deny: </span><strong><span>Allow</span></strong></p></li><li><p><span>Choose </span><strong><span>Save changes</span></strong><span>.</span></p></li></ul></li><li><p><span>In the AWS Cloud9 IDE, to test access to port 22 on the </span><em><span>WebServer</span></em><span> instance again, run the following command. Replace </span><code>&lt;WebServer-public-IP&gt;</code><span> with the public IPv4 address of the </span><em><span>WebServer</span></em><span> instance:</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="bash"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: currentcolor;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: currentcolor;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">nc</span> <span class="cm-attribute">-vz</span> &lt;WebServer-public-IP&gt; <span class="cm-number">22</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 22px;"></div><div class="CodeMirror-gutters" style="display: none; height: 22px;"></div></div></div></pre><p><span>The connection attempt should succeed.</span></p></li></ul><p><strong><span>Solution to step 5:</span></strong></p><ul><li><p><span>On the </span><strong><span>Inbound rules</span></strong><span> tab for the network ACL, choose </span><strong><span>Edit inbound rules</span></strong><span>.</span></p></li><li><p><span>Choose </span><strong><span>Add new rule</span></strong><span> and configure the following:</span></p><ul><li><p><span>Rule number: </span><code>90</code></p></li><li><p><span>Type: </span><strong><span>HTTP (80)</span></strong></p></li><li><p><span>Source: </span><strong><span>0.0.0.0/0</span></strong></p></li><li><p><span>Allow/Deny: </span><strong><span>Allow</span></strong><span> </span></p></li><li><p><span>Choose </span><strong><span>Save changes</span></strong><span>.</span></p></li></ul></li><li><p><span>In a new browser tab, try to load </span><code>http://&lt;WebServer-public-IP&gt;</code><span> where </span><code>&lt;WebServer-public-IP&gt;</code><span> is the public IP address of the </span><em><span>WebServer</span></em><span> instance.</span></p><p><span>The webpage should load without error and display the "Hello world from WebServer!" message.</span></p></li></ul><h3 id="a-idp2t6atask-26-review-networkfirewallvpc-and-its-associated-resources"><a id="p2t6"></a><span>Task 2.6: Review NetworkFirewallVPC and its associated resources</span></h3><p><a href="file:///C:/Users/chara/Downloads/IG.html#top" target="_self"><span>Return to table of contents</span></a></p><p><em><span>Reference the student instructions for details about what students should do in this task.</span></em></p><p><strong><span>Solution to step 1:</span></strong></p><ul><li><p><span>Observe the VPC settings:</span></p><ul><li><p><span>Navigate to the Amazon VPC console.</span></p></li><li><p><span>Choose </span><strong><span>VPCs</span></strong><span>.</span></p></li><li><p><span>Select </span><strong><span>NetworkFirewallVPC</span></strong><span>, and choose the </span><strong><span>Resource map</span></strong><span> tab.</span></p></li></ul></li><li><p><span>Observe the network ACL settings:</span></p><ul><li><p><span>In the navigation pane, choose </span><strong><span>Network ACLs</span></strong><span>.</span></p></li><li><p><span>Choose the </span><strong><span>Network ACL ID</span></strong><span> link for the network ACL that is associated with </span><em><span>NetworkFirewallVPC</span></em><span>.</span></p><p><strong><span>Tip</span></strong><span>: You might need to scroll to the right to see the </span><strong><span>VPC ID</span></strong><span> column to determine which network ACL is associated with </span><em><span>NetworkFirewallVPC</span></em><span>.</span></p></li><li><p><span>On the </span><strong><span>Inbound rules</span></strong><span> tab, notice the two rules. They conform with default network ACL settings, where rule 100 allows all traffic from anywhere (0.0.0.0/0).</span></p></li></ul></li><li><p><span>Observe the settings for the </span><em><span>WebServer2</span></em><span> instance:</span></p><ul><li><p><span>Navigate to the Amazon EC2 console.</span></p></li><li><p><span>Choose </span><strong><span>Instances</span></strong><span>.</span></p></li><li><p><span>Select </span><strong><span>WebServer2</span></strong><span>.</span></p></li><li><p><span>Choose the </span><strong><span>Networking</span></strong><span> tab.</span></p><p><span>Observe that this instance runs in </span><em><span>WebServer2Subnet</span></em><span>.</span></p></li><li><p><span>Copy the </span><strong><span>Public IPv4 address</span></strong><span> to your clipboard to use in the next step.</span></p></li><li><p><span>Choose the </span><strong><span>Security</span></strong><span> tab.</span></p><p><span>Notice that inbound traffic is allowed from anywhere (0.0.0.0/0) to ports 80 (HTTP), 22 (SSH), and 8080.</span></p></li></ul></li></ul><p>&nbsp;</p><p><strong><span>Solution to step 2:</span></strong></p><ul><li><p><span>In a new browser tab, try to load </span><code>http://&lt;WebServer2-public-IP&gt;</code><span> where </span><code>&lt;WebServer2-public-IP&gt;</code><span> is the public IP address of the </span><em><span>WebServer2</span></em><span> instance.</span></p><p><span>You should see the "Hello world from WebServer2!" message.</span></p></li><li><p><span>In the AWS Cloud9 IDE, to test access to port 22 on the </span><em><span>WebServer2</span></em><span> instance, run the following command. Replace </span><code>&lt;WebServer2-public-IP&gt;</code><span> with the public IPv4 address of the </span><em><span>WebServer2</span></em><span> instance:</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="bash"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: currentcolor;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: currentcolor;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">nc</span> <span class="cm-attribute">-vz</span> &lt;WebServer2-public-IP&gt; <span class="cm-number">22</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 22px;"></div><div class="CodeMirror-gutters" style="display: none; height: 22px;"></div></div></div></pre><p><span>The connection attempt should succeed.</span></p><p>&nbsp;</p></li></ul><p><strong><span>Solution to step 3:</span></strong></p><ul><li><p><span>Navigate to the Amazon EC2 console.</span></p></li><li><p><span>Choose </span><strong><span>Instances</span></strong><span>.</span></p></li><li><p><span>Select </span><strong><span>WebServer2</span></strong><span>, and then choose </span><strong><span>Connect</span></strong><span>.</span></p></li><li><p><span>On the </span><strong><span>EC2 Instance Connect</span></strong><span> tab, choose </span><strong><span>Connect</span></strong><span>.</span></p></li><li><p><span>After you connect, run the following command: </span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="bash"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: currentcolor;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: currentcolor;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">python3 <span class="cm-attribute">-m</span> http.server <span class="cm-number">8080</span> &amp;</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 22px;"></div><div class="CodeMirror-gutters" style="display: none; height: 22px;"></div></div></div></pre></li><li><p><span>After running the command, press Enter to return to the prompt.</span></p><p><span>Keep the EC2 Instance Connect session open.</span></p></li><li><p><span>In a separate browser tab, try to load </span><code>http://&lt;WebServer2-public-IP&gt;:8080</code><span> where </span><code>&lt;WebServer2-public-IP&gt;</code><span> is the public IP address of the </span><em><span>WebServer2</span></em><span> instance.</span></p><p><span>The attempt should be successful, and you should see the "Hello world from WebServer2 port 8080!" message.</span></p></li></ul><h3 id="a-idp2diaadiagramming-activity"><a id="p2dia"></a><span>Diagramming activity</span></h3><p><a href="file:///C:/Users/chara/Downloads/IG.html#top" target="_self"><span>Return to table of contents</span></a></p><p><span>The following diagram shows what students will build in tasks 2.7 through 2.10. Students have been provided with a fill-in-the-blank version of this diagram, which you might want to review with students for accuracy. </span></p><p><img src="file:///C:/Users/chara/Downloads/images/network-firewall-intro.png" referrerpolicy="no-referrer" alt="solution diagram showing Route tables and firewall rules built in this task"></p><p><strong><span>Question posed to students</span></strong></p><p><span>The activity challenges students to explain how the network routing configuration works, in terms of traffic from the internet being routed to </span><em><span>WebServer2</span></em><span> and traffic from </span><em><span>WebServer2</span></em><span> being routed to the internet.</span></p><p><strong><span>Answer</span></strong></p><p><span>A strong answer to the question will illustrate an understanding of how a request and response travel across the network. For example : </span></p><ul><li><p><span>A request originating from the internet to access the web server running on WebServer2 on HTTP port 80 will take the following network path:</span></p><ul><li><p><span>The request arrives at the internet gateway.</span></p></li><li><p><span>The IGW-Ingress-Route-Table then routes the traffic to the firewall endpoint.</span></p><ul><li><p><span>Notice that the </span><em><span>FirewallSubnet CIDR block</span></em><span> matches one of the route entries in the </span><em><span>IGW-Ingress-Route-Table</span></em><span>. This is how traffic is sent to the firewall endpoint that exists in the FirewallSubnet.</span></p></li></ul></li><li><p><span>The networks firewall rules are then evaluated. Since one of those rules defines a pass action for port 80, the request is allowed and makes it to WebServer2 (and the </span><em><span>WebServer2SecurityGroup</span></em><span> also allows port 80 inbound traffic).</span></p></li><li><p><span>The response from the httpd (web server) process running on WebServer2 is destined for the internet (to delivery the HTML webpage content to the requestor). </span></p><ul><li><p><span>The 0.0.0.0/0 rule defined in the </span><em><span>WebServer2-Route-Table</span></em><span> applies and the response is routed to the firewall endpoint.</span></p></li><li><p><span>In the firewall endpoint the network firewall rules are consulted and  the same rule that allowed the request in (pass action for port 80) also allows the response to go out. </span></p></li></ul></li><li><p><span>The </span><em><span>Firewall-Route-Table</span></em><span> route for 0.0.0.0/0 points to the internet gateway and the response is received by the requestor.</span></p></li></ul></li></ul><p><strong><span>Tip</span></strong><span>: the first diagram that appears in the </span><a href="https://aws.amazon.com/blogs/networking-and-content-delivery/deployment-models-for-aws-network-firewall/"><span>Deploment models for AWS Network Firewall</span></a><span> blog post has  arrows numbered 1 through 8 that show this type of traffic flow.  However that diagram shows an outbound request originating from the protected subnet, going out to the internet, and then shows the response coming back.</span></p><p>&nbsp;</p><h3 id="a-idp2t7atask-27-create-a-network-firewall"><a id="p2t7"></a><span>Task 2.7: Create a network firewall</span></h3><p><a href="file:///C:/Users/chara/Downloads/IG.html#top" target="_self"><span>Return to table of contents</span></a></p><p><strong><span>Solution:</span></strong></p><ul><li><p><span>Navigate to the Amazon VPC console.</span></p></li><li><p><span>In the navigation pane, choose </span><strong><span>Firewalls</span></strong><span>.</span></p></li><li><p><span>Choose </span><strong><span>Create firewall</span></strong><span> and configure the following:</span></p><ul><li><p><span>Name: </span><code>NetworkFirewall</code><span> </span></p></li><li><p><span>VPC: </span><strong><span>NetworkFirewallVPC</span></strong></p></li><li><p><span>Availability Zone: </span><strong><span>us-east-1a</span></strong></p></li><li><p><span>Subnet: </span><strong><span>FirewallSubnet</span></strong></p></li><li><p><span>IP address type: </span><strong><span>IPv4</span></strong></p></li><li><p><span>In the </span><strong><span>Associated firewall policy</span></strong><span> section, keep </span><strong><span>Create and associate an empty firewall policy</span></strong><span> selected.</span></p></li><li><p><span>New firewall policy name: </span><code>FirewallPolicy</code></p></li><li><p><span>Keep all other default settings, and choose </span><strong><span>Create firewall</span></strong><span> at the bottom of the page. </span></p><p><span>Wait for the firewall to attain the status of </span><em><span>Ready</span></em><span> before you continue to the next step. The process takes approximately 3 minutes to complete. </span></p></li></ul></li></ul><h3 id="a-idp2t8atask-28-create-route-tables"><a id="p2t8"></a><span>Task 2.8: Create route tables</span></h3><p><a href="file:///C:/Users/chara/Downloads/IG.html#top" target="_self"><span>Return to table of contents</span></a></p><p><strong><span>Solution to step 1:</span></strong></p><ul><li><p><span>Navigate to the Amazon VPC console.</span></p></li><li><p><span>Choose </span><strong><span>Route tables</span></strong><span>.</span></p></li><li><p><span>Choose </span><strong><span>Create route table</span></strong><span> and configure the following:</span></p><ul><li><p><span>Name: </span><code>IGW-Ingress-Route-Table</code></p></li><li><p><span>VPC: </span><strong><span>NetworkFirewallVPC</span></strong></p></li><li><p><span>Choose </span><strong><span>Create route table</span></strong><span>.</span></p></li></ul></li></ul><p><strong><span>Solution to step 2:</span></strong></p><ul><li><p><span>On the details page for the </span><em><span>IGW-Ingress-Route-Table</span></em><span>, on the </span><strong><span>Routes</span></strong><span> tab, choose </span><strong><span>Edit routes</span></strong><span>.</span></p></li><li><p><span>Choose </span><strong><span>Add route</span></strong><span> and configure the following:</span></p><ul><li><p><span>Destination: </span><code>10.1.3.0/28</code></p><p><strong><span>Note</span></strong><span>: This CIDR block was configured for the </span><em><span>WebServer2Subnet</span></em><span>, which the </span><em><span>WebServer2</span></em><span> instance runs in. To find this value, go to the Amazon EC2 console, and choose </span><strong><span>Instances</span></strong><span>. Select the </span><strong><span>WebServer2</span></strong><span> instance. On the </span><strong><span>Networking</span></strong><span> tab, choose the link for the </span><strong><span>Subnet ID</span></strong><span>. In the Amazon VPC console page that opens, you can find the </span><strong><span>IPv4 CIDR</span></strong><span> value for the subnet.</span></p></li><li><p><span>Target: Choose </span><strong><span>Gateway Load Balancer Endpoint</span></strong><span>, and then select the only existing VPC endpoint ID.</span></p></li><li><p><span>Choose </span><strong><span>Save changes</span></strong><span> and then verify that the new route appears in the routes list.</span></p></li></ul></li></ul><p><strong><span>Solution to step 3:</span></strong></p><ul><li><p><span>On the details page for the </span><em><span>IGW-Ingress-Route-Table</span></em><span>, choose the </span><strong><span>Edge associations</span></strong><span> tab.</span></p></li><li><p><span>Choose </span><strong><span>Edit edge associations</span></strong><span>.</span></p></li><li><p><span>Select the </span><strong><span>NetworkFirewallIG</span></strong><span> internet gateway, and then choose </span><strong><span>Save changes</span></strong><span>.  </span></p></li></ul><p><strong><span>Solution to step 4:</span></strong></p><ul><li><p><span>In the Amazon VPC console, choose </span><strong><span>Route tables</span></strong><span>.</span></p></li><li><p><span>Choose </span><strong><span>Create route table</span></strong><span> and configure the following:</span></p><ul><li><p><span>Name: </span><code>Firewall-Route-Table</code></p></li><li><p><span>VPC: </span><strong><span>NetworkFirewallVPC</span></strong></p></li><li><p><span>Choose </span><strong><span>Create route table</span></strong><span>.</span></p></li></ul></li><li><p><span>On the </span><strong><span>Routes</span></strong><span> tab, choose </span><strong><span>Edit routes</span></strong><span>.</span></p></li><li><p><span>Choose </span><strong><span>Add route</span></strong><span> and configure the following:</span></p><ul><li><p><span>Destination: </span><code>0.0.0.0/0</code></p></li><li><p><span>Target: Choose </span><strong><span>Internet Gateway</span></strong><span>, and then select the internet gateway ID for </span><strong><span>NetworkFirewallIG</span></strong><span>.</span></p></li><li><p><span>Choose </span><strong><span>Save changes</span></strong><span>, and then verify that the new route appears in the routes list.</span></p></li></ul></li><li><p><span>Choose the </span><strong><span>Subnet associations</span></strong><span> tab.</span></p></li><li><p><span>In the </span><strong><span>Explicit subnet associations</span></strong><span> section, choose </span><strong><span>Edit subnet associations</span></strong><span>.</span></p></li><li><p><span>Select </span><strong><span>FirewallSubnet</span></strong><span>, and then choose </span><strong><span>Save associations</span></strong><span>. </span></p></li></ul><p><strong><span>Solution to step 5:</span></strong></p><ul><li><p><span>In the Amazon VPC console, choose </span><strong><span>Route tables</span></strong><span>. </span></p></li><li><p><span>Choose </span><strong><span>Create route table</span></strong><span> and configure the following:</span></p><ul><li><p><span>Name: </span><code>WebServer2-Route-Table</code><span> </span></p></li><li><p><span>VPC: </span><strong><span>NetworkFirewallVPC</span></strong></p></li><li><p><span>Choose </span><strong><span>Create route table</span></strong><span>.</span></p></li></ul></li><li><p><span>On the </span><strong><span>Routes</span></strong><span> tab, choose </span><strong><span>Edit routes</span></strong><span>.</span></p></li><li><p><span>Choose </span><strong><span>Add route</span></strong><span> and configure the following:</span></p><ul><li><p><span>Destination: </span><code>0.0.0.0/0</code></p></li><li><p><span>Target: Choose </span><strong><span>Gateway Load Balancer Endpoint</span></strong><span>, and then select the only existing VPC endpoint ID.</span></p></li><li><p><span>Choose </span><strong><span>Save changes</span></strong><span>, and then verify that the new route appears in the routes list.</span></p></li></ul></li><li><p><span>Choose the </span><strong><span>Subnet associations</span></strong><span> tab.</span></p></li><li><p><span>In the </span><strong><span>Explicit subnet associations</span></strong><span> section, choose </span><strong><span>Edit subnet associations</span></strong><span>.</span></p></li><li><p><span>Select </span><strong><span>WebServer2Subnet</span></strong><span>, and then choose </span><strong><span>Save associations</span></strong><span>.  </span></p><p><span>On the route tables page, the three new route tables should be configured as shown in the following image (although the numbers in the names of resources will be different):</span></p><p><img src="file:///C:/Users/chara/Downloads/images/route-tables-subnet2.png" referrerpolicy="no-referrer" alt="screenshot of 3 route tables configured and which have explicit subnet associates and edge associations"></p></li></ul><p>&nbsp;</p><h3 id="a-idp2t9atask-29-configure-logging-for-the-network-firewall"><a id="p2t9"></a><span>Task 2.9: Configure logging for the network firewall</span></h3><p><a href="file:///C:/Users/chara/Downloads/IG.html#top" target="_self"><span>Return to table of contents</span></a></p><p><strong><span>Solution to step 1:</span></strong></p><ul><li><p><span>Navigate to the CloudWatch console.</span></p></li><li><p><span>In the navigation pane, under </span><strong><span>Logs</span></strong><span>, choose </span><strong><span>Log groups</span></strong><span>.</span></p></li><li><p><span>Choose </span><strong><span>Create log group</span></strong><span> and configure the following:.  </span></p><ul><li><p><span>Log group name: </span><code>NetworkFirewallVPCLogs</code></p></li><li><p><span>Retention setting: </span><strong><span>6 months</span></strong><span>.</span></p></li><li><p><span>Choose </span><strong><span>Create</span></strong><span>. </span></p></li></ul></li></ul><p><strong><span>Solution to step 2:</span></strong></p><ul><li><p><span>Navigate to the Amazon VPC console.</span></p></li><li><p><span>Choose </span><strong><span>Firewalls</span></strong><span>.</span></p></li><li><p><span>Choose the link for the name of the </span><strong><span>NetworkFirewall</span></strong><span>.</span></p></li><li><p><span>On the </span><strong><span>Firewall details</span></strong><span> tab, scroll down to the </span><strong><span>Logging</span></strong><span> section, and choose </span><strong><span>Edit</span></strong><span>.</span></p></li><li><p><span>Configure the following:</span></p><ul><li><p><span>Log type: Select both </span><strong><span>Alert</span></strong><span> and </span><strong><span>Flow</span></strong><span>.</span></p></li><li><p><span>In the </span><strong><span>Log destination for alerts</span></strong><span> section:</span></p><ul><li><p><span>Log destination: </span><strong><span>CloudWatch log group</span></strong></p></li><li><p><span>CloudWatch log group: </span><strong><span>NetworkFirewallVPCLogs</span></strong></p></li></ul></li><li><p><span>In the </span><strong><span>Log destination for flows</span></strong><span> section:</span></p><ul><li><p><span>Log destination: </span><strong><span>CloudWatch log group</span></strong></p></li><li><p><span>CloudWatch log group: </span><strong><span>NetworkFirewallVPCLogs</span></strong></p></li></ul></li><li><p><span>Choose </span><strong><span>Save</span></strong><span>. </span></p></li></ul></li></ul><p><strong><span>Solution to step 3:</span></strong></p><ul><li><p><span>Navigate to the Amazon EC2 console.</span></p></li><li><p><span>Choose </span><strong><span>Instances</span></strong><span>.</span></p></li><li><p><span>Select </span><strong><span>WebServer2</span></strong><span>.</span></p></li><li><p><span>Copy the </span><strong><span>Public IPv4 address</span></strong><span> value.</span></p></li><li><p><span>In a new browser tab, try to load </span><code>http://&lt;WebServer2-public-IP&gt;</code><span> where </span><code>&lt;WebServer2-public-IP&gt;</code><span> is the public IP address of the </span><em><span>WebServer2</span></em><span> instance.</span></p></li></ul><p><strong><span>Solution to step 4:</span></strong><span> </span></p><ul><li><p><span>Navigate to the CloudWatch console.</span></p></li><li><p><span>In the navigation pane, choose </span><strong><span>Log groups</span></strong><span>.</span></p></li><li><p><span>Choose the </span><strong><span>Log group</span></strong><span> link for the </span><strong><span>NetworkFirewallVPCLogs</span></strong><span> log group.</span></p></li><li><p><span>On the </span><strong><span>Log streams</span></strong><span> tab, choose the link for the newest log stream.</span></p></li><li><p><span>Paste the IP address in the search field above the list of events, and press Enter.</span></p><p><i class="fa-solid fa-lightbulb" aria-label="Tip icon"></i><span> </span><strong><span>Tip:</span></strong><span> If you don’t know your public IP address, you can use a site such as </span><a href="https://www.whatismyip.com/" target="_blank" class="url">https://www.whatismyip.com</a><span> to discover it.</span></p><p><span>You should see log entries similar to the following example.</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="json" style="break-inside: unset;"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="json"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: currentcolor;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: currentcolor;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">{</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-string cm-property">"firewall_name"</span>: <span class="cm-string">"NetworkFirewall"</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-string cm-property">"availability_zone"</span>: <span class="cm-string">"us-east-1a"</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-string cm-property">"event_timestamp"</span>: <span class="cm-string">"1683642447"</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-string cm-property">"event"</span>: {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-string cm-property">"src_ip"</span>: <span class="cm-string">"192.63.xxx.xxx"</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-string cm-property">"src_port"</span>: <span class="cm-number">37064</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-string cm-property">"tcp"</span>: {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-string cm-property">"tcp_flags"</span>: <span class="cm-string">"02"</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-string cm-property">"syn"</span>: <span class="cm-atom">true</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  },</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-string cm-property">"netflow"</span>: {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-string cm-property">"pkts"</span>: <span class="cm-number">1</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-string cm-property">"bytes"</span>: <span class="cm-number">60</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-string cm-property">"start"</span>: <span class="cm-string">"2023-05-09T14:22:46.442925+0000"</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-string cm-property">"end"</span>: <span class="cm-string">"2023-05-09T14:22:46.442925+0000"</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-string cm-property">"age"</span>: <span class="cm-number">0</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-string cm-property">"min_ttl"</span>: <span class="cm-number">40</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-string cm-property">"max_ttl"</span>: <span class="cm-number">40</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  },</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-string cm-property">"event_type"</span>: <span class="cm-string">"netflow"</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-string cm-property">"flow_id"</span>: <span class="cm-number">1589317603869229</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-string cm-property">"dest_ip"</span>: <span class="cm-string">"10.1.3.4"</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-string cm-property">"proto"</span>: <span class="cm-string">"TCP"</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-string cm-property">"dest_port"</span>: <span class="cm-number">80</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-string cm-property">"timestamp"</span>: <span class="cm-string">"2023-05-09T14:27:27.629806+0000"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 616px;"></div><div class="CodeMirror-gutters" style="display: none; height: 616px;"></div></div></div></pre></li></ul><p>&nbsp;</p><h3 id="a-idp2t10atask-210-configure-the-firewall-policy-and-test-access"><a id="p2t10"></a><span>Task 2.10: Configure the firewall policy and test access</span></h3><p><a href="file:///C:/Users/chara/Downloads/IG.html#top" target="_self"><span>Return to table of contents</span></a></p><p><strong><span>Step 1:</span></strong><span> </span><em><span>Full click-level guidance is available in the student lab instructions.</span></em></p><p><strong><span>Solution to step 2:</span></strong></p><ul><li><p><span>For </span><strong><span>Name</span></strong><span>, enter </span><code>NetworkFirewallVPCRuleGroup</code></p></li><li><p><span>For </span><strong><span>Capacity</span></strong><span>, enter </span><code>100</code></p></li><li><p><span>Scroll down to the </span><strong><span>Add rule</span></strong><span> section.</span></p></li><li><p><span>Create the first rule, which will block port 8080 traffic:</span></p><ul><li><p><span>Protocol: </span><strong><span>TCP</span></strong><span> </span></p></li><li><p><span>Source: </span><strong><span>Any</span></strong></p></li><li><p><span>Source port: </span><strong><span>Any port</span></strong></p></li><li><p><span>Destination: </span><strong><span>Any</span></strong></p></li><li><p><span>Destination port: Choose </span><strong><span>Custom</span></strong><span>, and enter </span><code>8080</code><span> for the port number.</span></p></li><li><p><span>Traffic direction: </span><strong><span>Forward</span></strong><span> </span></p></li><li><p><span>Action: </span><strong><span>Drop</span></strong></p></li><li><p><span>Choose </span><strong><span>Add rule</span></strong><span>.</span></p></li><li><p><span>Create the second rule, which will allow port 80 traffic:</span></p><ul><li><p><span>Protocol: </span><strong><span>TCP</span></strong><span> </span></p></li><li><p><span>Source: </span><strong><span>Any</span></strong></p></li><li><p><span>Source port: </span><strong><span>Any port</span></strong></p></li><li><p><span>Destination: </span><strong><span>Any</span></strong></p></li><li><p><span>Destination port: Choose </span><strong><span>Custom</span></strong><span>, and enter </span><code>80</code><span> for the port number.</span></p></li><li><p><span>Traffic direction: </span><strong><span>Forward</span></strong></p></li><li><p><span>Action: </span><strong><span>Pass</span></strong></p></li><li><p><span>Choose </span><strong><span>Add rule</span></strong><span>.</span></p></li></ul></li><li><p><span>Create the third rule, which will allow port 22 traffic:</span></p><ul><li><p><span>Protocol: </span><strong><span>TCP</span></strong><span> </span></p></li><li><p><span>Source: </span><strong><span>Any</span></strong></p></li><li><p><span>Source port: </span><strong><span>Any port</span></strong></p></li><li><p><span>Destination: </span><strong><span>Any</span></strong></p></li><li><p><span>Destination port: Choose </span><strong><span>Custom</span></strong><span>, and enter </span><code>22</code><span> for the port number.</span></p></li><li><p><span>Traffic direction: </span><strong><span>Forward</span></strong></p></li><li><p><span>Action: </span><strong><span>Pass</span></strong></p></li><li><p><span>Choose </span><strong><span>Add rule</span></strong><span>.</span></p></li></ul></li><li><p><span>Create the fourth rule, which will allow port 443 traffic:</span></p><ul><li><p><span>Protocol: </span><strong><span>TCP</span></strong><span> </span></p></li><li><p><span>Source: </span><strong><span>Any</span></strong></p></li><li><p><span>Source port: </span><strong><span>Any port</span></strong></p></li><li><p><span>Destination: </span><strong><span>Any</span></strong></p></li><li><p><span>Destination port: Choose </span><strong><span>Custom</span></strong><span>, and enter </span><code>443</code><span> for the port number.</span></p></li><li><p><span>Traffic direction: </span><strong><span>Forward</span></strong></p></li><li><p><span>Action: </span><strong><span>Pass</span></strong></p></li><li><p><span>Choose </span><strong><span>Add rule</span></strong><span>.</span></p></li></ul></li><li><p><span>Create a fifth rule, which will allow ICMP traffic:</span></p><ul><li><p><span>Protocol: </span><strong><span>ICMP</span></strong><span> (Note that this is different from the previous rules.)</span></p></li><li><p><span>Source: </span><strong><span>Any</span></strong></p></li><li><p><span>Source port: </span><strong><span>Any port</span></strong></p></li><li><p><span>Destination: </span><strong><span>Any</span></strong></p></li><li><p><span>Destination port: </span><strong><span>Any port</span></strong></p></li><li><p><span>Traffic direction: </span><strong><span>Forward</span></strong></p></li><li><p><span>Action: </span><strong><span>Pass</span></strong></p></li><li><p><span>Choose </span><strong><span>Add rule</span></strong><span>.</span></p></li></ul></li><li><p><span>Confirm that the rules are created as shown in the following image:</span></p></li></ul><p><img src="file:///C:/Users/chara/Downloads/images/five-rules.png" referrerpolicy="no-referrer" alt="screenshot showing the 5 network firewall rules configured"></p><ul><li><p><span>Choose </span><strong><span>Create and add to policy</span></strong><span>. </span></p><p><span>The </span><em><span>NetworkFirewallVPCRuleGroup</span></em><span> is created, and the new rules are added to the firewall policy.</span></p></li></ul></li></ul><p>&nbsp;</p><p><strong><span>Solution to step 3:</span></strong></p><ul><li><p><span>Test access to the website on the </span><em><span>WebServer2</span></em><span> instance:</span></p><ul><li><p><span>Navigate to the Amazon EC2 console.</span></p></li><li><p><span>Choose </span><strong><span>Instances</span></strong><span>.</span></p></li><li><p><span>Select </span><strong><span>WebServer2</span></strong><span>.</span></p></li><li><p><span>Copy the </span><strong><span>Public IPv4 address</span></strong><span> value.</span></p></li><li><p><span>In a new browser tab, try to load </span><code>http://&lt;WebServer2-public-IP&gt;</code><span> where </span><code>&lt;WebServer2-public-IP&gt;</code><span> is the public IP address of the </span><em><span>WebServer2</span></em><span> instance.</span></p><p><span>You should see the "Hello world from WebServer2!" message. </span></p></li></ul></li><li><p><span>In the AWS Cloud9 IDE, to test access to port 22 on the </span><em><span>WebServer2</span></em><span> instance, run the following command. Replace </span><code>&lt;WebServer2-public-IP&gt;</code><span> with the public IPv4 address of the </span><em><span>WebServer2</span></em><span> instance:</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="bash"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: currentcolor;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: currentcolor;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">nc</span> <span class="cm-attribute">-vz</span> &lt;WebServer2-public-address&gt; <span class="cm-number">22</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 22px;"></div><div class="CodeMirror-gutters" style="display: none; height: 22px;"></div></div></div></pre><p><span>The attempt should succeed.</span></p></li><li><p><span>Use EC2 Instance Connect to connect to the instance and run commands:</span></p><ul><li><p><span>Navigate to the Amazon EC2 console.</span></p></li><li><p><span>Choose </span><strong><span>Instances</span></strong><span>.</span></p></li><li><p><span>Select </span><strong><span>WebServer2</span></strong><span>, and then choose </span><strong><span>Connect</span></strong><span>.</span></p></li><li><p><span>On the </span><strong><span>EC2 Instance Connect</span></strong><span> tab, choose </span><strong><span>Connect</span></strong><span>.</span></p></li></ul><ul><li><p><span>After you connect, run the following commands:</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="bash"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: currentcolor;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: currentcolor;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">ping</span> <span class="cm-attribute">-c</span> <span class="cm-number">3</span> www.amazon.com</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">sudo</span> netstat <span class="cm-attribute">-tulpn</span> | <span class="cm-builtin">grep</span> <span class="cm-attribute">-i</span> listen</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 44px;"></div><div class="CodeMirror-gutters" style="display: none; height: 44px;"></div></div></div></pre></li></ul><p><strong><span>Tip</span></strong><span>: if the netstat command does not show a process listening on port 8080, see the troubleshooting tips on the student instructions of this step.</span></p></li></ul><ul><li><p><span>In a new browser tab, try to load </span><code>http://&lt;WebServer2-public-IP&gt;:8080</code><span> where </span><code>&lt;WebServer2-public-IP&gt;</code><span> is the public IPv4 address of the </span><em><span>WebServer2</span></em><span> EC2 instance.</span></p><p><span>The attempt fails because of the </span><em><span>deny</span></em><span> rule in the firewall policy.</span></p><p>&nbsp;</p></li></ul><p><strong><span>Solution to step 4:</span></strong></p><ul><li><p><span>Navigate to the CloudWatch console.</span></p></li><li><p><span>In the navigation pane, choose </span><strong><span>Log groups</span></strong><span>.</span></p></li><li><p><span>Choose the </span><strong><span>Log group</span></strong><span> link for the </span><strong><span>NetworkFirewallVPCLogs</span></strong><span> log group.</span></p></li><li><p><span>On the </span><strong><span>Log streams</span></strong><span> tab, choose the link for the newest log stream.</span></p></li><li><p><span>Expand one of the logs to see what type of information is collected. Optionally, filter the log events.</span></p><p>&nbsp;</p></li></ul><h3 id="a-idp2ceaacost-estimate-to-secure-a-vpc-with-a-network-firewall"><a id="p2cea"></a><span>Cost estimate to secure a VPC with a network firewall</span></h3><p><a href="file:///C:/Users/chara/Downloads/IG.html#top" target="_self"><span>Return to table of contents</span></a></p><p><em><span>Reference the lab instructions for details about what students should do in this task.</span></em></p><p><strong><span>Solution:</span></strong></p><p><i class="fa-solid fa-note-sticky" aria-label="Note icon"></i><span> </span><strong><span>Note:</span></strong><span> A single correct configuration of services and features doesn't exist. The point of the exercise is for students to understand how the service and feature configuration has a direct impact on cost. </span></p><ul><li><p><span>Go to the </span><a href="https://calculator.aws/"><span>AWS Pricing Calculator</span></a><span>.</span></p></li><li><p><span>Choose </span><strong><span>Create estimate</span></strong><span>.</span></p></li><li><p><span>For </span><strong><span>Choose a Region</span></strong><span>, choose </span><strong><span>US East (N. Virginia)</span></strong><span>.</span></p></li><li><p><span>Add the costs for Amazon EC2:</span></p><ul><li><p><span>Search for </span><code>EC2</code><span> and choose </span><strong><span>Configure</span></strong><span> on the </span><strong><span>Amazon EC2</span></strong><span> card.</span></p></li><li><p><span>In the </span><strong><span>Configure Amazon EC2</span></strong><span> panel, configure the following:</span></p><ul><li><p><span>Choose a Region: </span><strong><span>US East (N. Virginia)</span></strong></p></li><li><p><span>Tenancy: </span><strong><span>Shared Instances</span></strong></p></li><li><p><span>Number of instances: </span><strong><span>1</span></strong></p></li><li><p><span>Instance type: Search for and choose </span><strong><span>t3.micro</span></strong><span>.</span></p></li><li><p><span>Payment options: </span><strong><span>On-Demand</span></strong></p></li><li><p><span>Choose </span><strong><span>Save and add service</span></strong><span>.</span></p></li></ul></li></ul></li><li><p><span>Add the costs for Amazon VPC:</span></p><ul><li><p><span>Search for </span><code>VPC</code><span> and choose </span><strong><span>Configure</span></strong><span> on the </span><strong><span>Amazon Virtual Private Cloud (VPC)</span></strong><span> card.</span></p></li><li><p><span>In the </span><strong><span>Configure Amazon Virtual Private Cloud (VPC)</span></strong><span> panel, configure the following:</span></p><ul><li><p><span>Choose a Region: </span><strong><span>US East (N. Virginia)</span></strong></p></li><li><p><span>In the </span><strong><span>Select VPC services(s) that you want to estimate</span></strong><span> section:</span></p><ul><li><p><span>Turn </span><em><span>off</span></em><span> </span><strong><span>VPN Connection</span></strong><span>. (You might need to turn another setting on before you can turn this one off.)</span></p></li><li><p><span>Turn </span><em><span>on</span></em><span> </span><strong><span>IPAM</span></strong><span>. </span></p></li><li><p><span>Turn </span><em><span>on</span></em><span> </span><strong><span>Data Transfer</span></strong><span>.</span></p></li></ul></li><li><p><span>In the </span><strong><span>Data Transfer</span></strong><span> section:</span></p><ul><li><p><span>Under </span><strong><span>Inbound Data Transfer:</span></strong></p><ul><li><p><span>Data transfer from: </span><strong><span>Internet</span></strong></p></li><li><p><span>Enter Amount: </span><code>100</code></p></li><li><p><span>Data amount: </span><strong><span>GB per month</span></strong></p></li></ul></li><li><p><span>Under </span><strong><span>Outbound Data Transfer:</span></strong></p><ul><li><p><span>Data transfer to: </span><strong><span>Internet</span></strong></p></li><li><p><span>Enter Amount: </span><code>1</code></p></li><li><p><span>Data amount: </span><strong><span>TB per month</span></strong></p></li></ul></li></ul></li><li><p><span>In the </span><strong><span>IPAM feature</span></strong><span> section, for </span><strong><span>Number of active IP addresses</span></strong><span>, enter </span><code>2</code></p></li><li><p><span>Choose </span><strong><span>Save and add service</span></strong><span>.</span></p></li></ul></li></ul></li><li><p><span>Add the costs for Network Firewall:</span></p><ul><li><p><span>Search for </span><code>Network Firewall</code><span> and choose </span><strong><span>Configure</span></strong><span> on the </span><strong><span>AWS Network Firewall</span></strong><span> card.</span></p></li><li><p><span>In the </span><strong><span>Configure AWS Network Firewall</span></strong><span> panel, configure the following:</span></p><ul><li><p><span>In the </span><strong><span>AWS Network Firewall Endpoint Hourly Charges</span></strong><span> section:</span></p><ul><li><p><span>Number of AWS Network Firewall endpoints: </span><code>1</code></p></li><li><p><span>Usage per endpoint: </span><code>30</code><span> </span><strong><span>days</span></strong></p></li></ul></li><li><p><span>In the </span><strong><span>AWS Network Firewall Data Processing Charges</span></strong><span> section:</span></p><ul><li><p><span>Data processed per month: </span><code>2</code><span> </span><strong><span>TB</span></strong></p><p><i class="fa-solid fa-note-sticky" aria-label="Note icon"></i><span> </span><strong><span>Note:</span></strong><span> 2 TB considers the inbound and outbound data that Amazon S3 consumes and provides, but also considers overhead that is associated with serving the website.</span></p></li></ul></li><li><p><span>Choose </span><strong><span>Save and add service</span></strong><span>.</span></p></li></ul></li></ul></li><li><p><span>After all required services are added, choose </span><strong><span>View summary</span></strong><span> in the bottom-right corner.</span></p><p><span>The estimate displays the estimated upfront cost (if any), monthly cost, and total cost for 12 months.</span></p><p><i class="fa-solid fa-circle-exclamation" aria-label="Important icon"></i><span> </span><strong><span>Important:</span></strong><span> The AWS Pricing Calculator provides only an estimate of your AWS fees and doesn't include any taxes that might apply. Pricing is subject to change. The following estimate only shows an example price estimate from a point in time in which many assumptions were made. Your result might be different.</span></p><p><span>The following image provides an example of a cost estimate:</span></p><p><img src="file:///C:/Users/chara/Downloads/images/vpc-cost-est.png" referrerpolicy="no-referrer" alt="screenshot from AWS Pricing Calculator showing VPC cost estimate"></p><p><span>The following link provides a </span><em><span>sample</span></em><span> cost estimate. </span></p><p><a href="https://aws-tc-largeobjects.s3.us-west-2.amazonaws.com/CUR-TF-200-ACCAP6-DEV/capstone-6-security/s3/vpc-cost-estimate.csv"><span>Cost Estimate</span></a><span> </span><!--note: the link must be hardcoded because Kaizen does not process this markdown file--></p></li></ul><h4 id="optional-have-students-add-the-cost-estimate-to-a-presentation"><span>Optional: Have students add the cost estimate to a presentation</span></h4><p><span>You could ask students to document their work as they progress through this project. You could use this documentation along with the project rubric to assess student work.</span></p><p><span>If you decide to do this, we recommend that students capture at least two key artifacts: </span></p><ul><li><p><span>The cost estimate completed using the AWS Pricing Calculator at the end of phase 2 </span></p></li><li><p><span>The architectural diagram from the diagramming activity completed during phase 2</span></p></li></ul><p>&nbsp;</p><h2 id="a-idp3aphase-3-securing-aws-resources-by-using-aws-kms"><a id="p3"></a><span>Phase 3: Securing AWS resources by using AWS KMS</span></h2><p><a href="file:///C:/Users/chara/Downloads/IG.html#top" target="_self"><span>Return to table of contents</span></a></p><!--PER PRODUCT TEAM: This phase does NOT need to include a diagram activity.--><h3 id="a-idp3t1atask-31-create-a-customer-managed-key-and-configure-key-rotation"><a id="p3t1"></a><span>Task 3.1: Create a customer managed key and configure key rotation</span></h3><p><a href="file:///C:/Users/chara/Downloads/IG.html#top" target="_self"><span>Return to table of contents</span></a></p><p><em><span>Reference the lab instructions for details about what students should do in this task.</span></em></p><p><strong><span>Solution to step 1</span></strong></p><ul><li><p><span>Navigate to the AWS KMS console.</span></p></li><li><p><span>In the navigation pane, choose </span><strong><span>Customer managed keys</span></strong><span>.</span></p></li><li><p><span>Choose </span><strong><span>Create key</span></strong><span> and configure the following:</span></p><ul><li><p><span>On the </span><strong><span>Configure key</span></strong><span> page:</span></p><ul><li><p><span>Keep the default options.</span></p></li><li><p><span>Choose </span><strong><span>Next</span></strong><span>.</span></p></li></ul></li><li><p><span>On the </span><strong><span>Add labels</span></strong><span> page:</span></p><ul><li><p><span>Alias: </span><code>MyKMSKey</code></p></li><li><p><span>Choose </span><strong><span>Next</span></strong><span>.</span></p></li></ul></li><li><p><span>On the </span><strong><span>Define key administrative permissions</span></strong><span> page:</span></p><ul><li><p><span>Key administrators: Search for and select </span><strong><span>voclabs</span></strong><span>.</span></p><p><i class="fa-solid fa-note-sticky" aria-label="Note icon"></i><span> </span><strong><span>Note:</span></strong><span> </span><em><span>voclabs</span></em><span> is the IAM role that your default lab environment user has assumed. </span></p></li><li><p><span>Choose </span><strong><span>Next</span></strong><span>.</span></p></li></ul></li><li><p><span>On the </span><strong><span>Define key usage permissions</span></strong><span> page:</span></p><ul><li><p><span>Key users: Search for and select </span><strong><span>voclabs</span></strong><span>.</span></p></li><li><p><span>Choose </span><strong><span>Next</span></strong><span>.</span></p></li></ul></li><li><p><span>On the </span><strong><span>Review</span></strong><span> page:</span></p><ul><li><p><span>Review the configuration details, including the key policy that will be created.</span></p><p><strong><span>Analysis:</span></strong><span> The policy allows the </span><em><span>root</span></em><span> IAM user in your account to manage the key by granting them full AWS KMS action permissions on any resource. The policy also grants key administrator and key user privileges to the </span><em><span>voclabs</span></em><span> IAM role. </span></p></li><li><p><span>Choose </span><strong><span>Finish</span></strong><span>.</span></p></li></ul></li></ul><p><span>The MyKMSKey customer managed key is created.</span></p></li></ul><p>&nbsp;</p><p><strong><span>Solution to step 2:</span></strong></p><ul><li><p><span>Navigate to the AWS KMS console.</span></p></li><li><p><span>In the navigation pane, choose </span><strong><span>Customer managed keys</span></strong><span>.</span></p></li><li><p><span>Choose the link for </span><strong><span>MyKMSKey</span></strong><span>.</span></p></li><li><p><span>Choose the </span><strong><span>Key rotation</span></strong><span> tab.</span></p></li><li><p><span>Select </span><strong><span>Automatically rotate this KMS key every year</span></strong><span>.</span></p></li><li><p><span>Choose </span><strong><span>Save</span></strong><span>. </span></p><p><span>The key will now be rotated once every year.</span></p><p><strong><span>Analysis:</span></strong><span> When you set a customer managed key to automatically rotate every year, the key policy will remain the same, but the cryptographic material that is included with the key is replaced. AWS KMS saves all previous versions of the cryptographic material in perpetuity so that you can decrypt any data that was encrypted with that AWS KMS key. </span></p></li></ul><p>&nbsp;</p><h3 id="a-idp3t2atask-32-update-the-aws-kms-key-policy-and-analyze-an-iam-policy"><a id="p3t2"></a><span>Task 3.2: Update the AWS KMS key policy and analyze an IAM policy</span></h3><p><a href="file:///C:/Users/chara/Downloads/IG.html#top" target="_self"><span>Return to table of contents</span></a></p><p><em><span>Reference the lab instructions for details about what students should do in this task.</span></em></p><p><strong><span>Solution to step 1:</span></strong></p><ul><li><p><span>On the details page for </span><em><span>MyKMSKey</span></em><span>, choose the </span><strong><span>Key policy</span></strong><span> tab.</span></p></li><li><p><span>In the </span><strong><span>Key policy</span></strong><span> section, choose </span><strong><span>Switch to policy view</span></strong><span>, and then choose </span><strong><span>Edit</span></strong><span>.</span></p></li><li><p><span>Locate the line (around line 39) that reads </span><code>"Sid": "Allow use of the key",</code><span>.</span></p></li><li><p><span>Modify the code </span><em><span>inside</span></em><span> the </span><code>Principal {},</code><span> element so that the entire IAM statement matches what is shown in the following code block (where ACCOUNT-NUMBER is the actual account number):</span></p><p><strong><span>Tip</span></strong><span>: to find your account number (account ID), choose the </span><em><span>voclabs</span></em><span> drop down menu in the top right corner of the KMS console.</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="json" style="break-inside: unset;"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="json"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: currentcolor;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: currentcolor;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">{</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-string cm-property">"Sid"</span>: <span class="cm-string">"Allow use of the key"</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-string cm-property">"Effect"</span>: <span class="cm-string">"Allow"</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-string cm-property">"Principal"</span>: {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-string cm-property">"AWS"</span>: [</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-string">"arn:aws:iam::ACCOUNT-NUMBER:role/voclabs"</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-string">"arn:aws:iam::ACCOUNT-NUMBER:user/sofia"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  ] </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  },</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-string cm-property">"Action"</span>: [</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-string">"kms:Encrypt"</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-string">"kms:Decrypt"</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-string">"kms:ReEncrypt*"</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-string">"kms:GenerateDataKey*"</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-string">"kms:DescribeKey"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  ],</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-string cm-property">"Resource"</span>: <span class="cm-string">"*"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">},</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 396px;"></div><div class="CodeMirror-gutters" style="display: none; height: 396px;"></div></div></div></pre></li><li><p><span>Choose </span><strong><span>Save changes</span></strong><span>.</span></p></li></ul><p>&nbsp;</p><p><strong><span>Solution to step 2:</span></strong></p><ul><li><p><span>Navigate to the IAM console.</span></p></li><li><p><span>In the navigation pane, choose </span><strong><span>Policies</span></strong><span>.</span></p></li><li><p><span>Choose the link for </span><strong><span>PolicyForFinancialAdvisors</span></strong><span>.</span></p></li><li><p><span>On the </span><strong><span>Permissions</span></strong><span> tab, choose </span><strong><span>JSON</span></strong><span>.</span></p></li><li><p><span>Review the policy.</span></p><p><strong><span>Analysis:</span></strong><span> The policy allows full control of all S3 buckets within the account and grants the ability to encrypt and decrypt objects. This policy is attached to the </span><em><span>FinancialAdvisorGroup</span></em><span> IAM group, which the </span><em><span>sofia</span></em><span> user is a member of. </span></p><p>&nbsp;</p></li></ul><h3 id="a-idp3t3atask-33-use-aws-kms-to-encrypt-data-in-amazon-s3"><a id="p3t3"></a><span>Task 3.3: Use AWS KMS to encrypt data in Amazon S3</span></h3><p><a href="file:///C:/Users/chara/Downloads/IG.html#top" target="_self"><span>Return to table of contents</span></a></p><p><em><span>Reference the lab instructions for details about what students should do in this task.</span></em></p><p>&nbsp;</p><p><strong><span>Solution to step 1:</span></strong></p><ul><li><p><span>Navigate to the Amazon S3 console.</span></p></li><li><p><span>Choose the link for the </span><strong><span>data-bucket</span></strong><span>.</span></p></li><li><p><span>On the </span><strong><span>Properties</span></strong><span> tab, in the </span><strong><span>Default encryption</span></strong><span> section, choose </span><strong><span>Edit</span></strong><span> and configure the following:  </span></p><ul><li><p><span>Encryption type: </span><strong><span>Server-side encryption with AWS Key Management Service keys (SSE-KMS)</span></strong></p></li><li><p><span>AWS KMS key: </span><strong><span>Choose from your AWS KMS keys</span></strong></p></li><li><p><span>Available AWS KMS keys: </span><strong><span>MyKMSKey</span></strong></p></li><li><p><span>Choose </span><strong><span>Save changes</span></strong><span>.</span></p></li></ul></li></ul><p>&nbsp;</p><p><strong><span>Solution to step 2:</span></strong></p><ul><li><p><span>Use a text editor to create a CSV file with the column header and customer records that follow. Name the file </span><code>loan-data.csv</code><span>.</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="csv"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="csv"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: currentcolor;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: currentcolor;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">date,description,amount,principal,interest</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">2023-01-14,payment,1000.00,845.52,154.48</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">2022-12-22,payment,1021.52,742.80,278.72</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">2022-11-15,payment,1000.00,855.27,144.73</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 88px;"></div><div class="CodeMirror-gutters" style="display: none; height: 88px;"></div></div></div></pre></li><li><p><span>Save the changes.</span></p><p>&nbsp;</p></li></ul><p><strong><span>Solution to step 3:</span></strong></p><ul><li><p><span>Find the IAM user console sign-in link: </span><!--as voclabs--></p><ul><li><p><span>In the IAM console navigation pane, choose </span><strong><span>Users</span></strong><span>.</span></p></li><li><p><span>Choose the link for </span><strong><span>sofia</span></strong><span>.</span></p></li><li><p><span>On the </span><strong><span>Security credentials</span></strong><span> tab, copy the </span><strong><span>Console sign-in link</span></strong><span>.</span></p></li></ul></li><li><p><span>Log in to the console as the </span><em><span>sofia</span></em><span> user:</span></p><ul><li><p><span>Open a new incognito or private browser window and load the sign-in page.</span></p></li><li><p><span>Log in with the following credentials:</span></p><ul><li><p><span>IAM user name: Enter </span><code>sofia</code></p></li><li><p><span>Password: To find the password, choose </span><strong><span>AWS Details</span></strong><span> above the student instructions in the lab environment.</span></p></li></ul></li></ul></li><li><p><span>Upload the file to the </span><em><span>data-bucket</span></em><span>:</span></p><ul><li><p><span>Navigate to the Amazon S3 console.</span></p></li><li><p><span>Choose the link for </span><strong><span>data-bucket</span></strong><span>.</span></p></li><li><p><span>Choose </span><strong><span>Upload</span></strong><span>.</span></p></li><li><p><span>Choose </span><strong><span>Add files</span></strong><span>.</span></p></li><li><p><span>Browse to and select the </span><strong><span>loan-data.csv</span></strong><span> file, and then choose </span><strong><span>Open</span></strong><span>.</span></p></li><li><p><span>Choose </span><strong><span>Upload</span></strong><span>.</span></p><p><span>The upload should be successful. </span></p></li><li><p><span>Choose </span><strong><span>Close</span></strong><span>.</span></p></li></ul></li></ul><p><strong><span>Solution to step 4:</span></strong></p><ul><li><p><span>In the Amazon S3 console, choose the link for the </span><strong><span>loan-data.csv</span></strong><span> file.</span><!--as sofia--></p></li><li><p><span>On the Properties tab for the object, scroll down to the </span><strong><span>Server-side encryption settings</span></strong><span> section.  </span></p><p><span>Notice that the object is encrypted with AWS KMS keys.</span></p><p>&nbsp;</p></li></ul><p><strong><span>Solution to step 5:</span></strong><span> </span><!--as sofia--></p><ul><li><p><span>On the details page for the </span><em><span>loan-data.csv</span></em><span> object, choose </span><strong><span>Download</span></strong><span> or </span><strong><span>Open</span></strong><span>.</span></p><p><span>The file should open or download, depending on your browser settings.</span></p></li></ul><p><strong><span>Solution to step 6:</span></strong></p><ul><li><p><span>To sign the </span><em><span>sofia</span></em><span> user out of the console, choose </span><strong><span>sofia @ xxxxx</span></strong><span> in the top-right corner, and choose </span><strong><span>Sign out</span></strong><span>. </span><!--as sofia--></p></li><li><p><span>Find the IAM user console sign-in link: </span><!--as voclabs--></p><ul><li><p><span>Return to the browser window where you are logged in as the </span><em><span>voclabs</span></em><span> role.</span></p></li><li><p><span>In the IAM console navigation pane, choose </span><strong><span>Users</span></strong><span>.</span></p></li><li><p><span>Choose the link for </span><strong><span>paulo</span></strong><span>.</span></p></li><li><p><span>On the </span><strong><span>Security credentials</span></strong><span> tab, copy the </span><strong><span>Console sign-in link</span></strong><span>.</span></p></li></ul></li><li><p><span>Log in to the console as the </span><em><span>paulo</span></em><span> user:</span></p><ul><li><p><span>Open a new incognito or private browser window and load the sign-in page.</span></p></li><li><p><span>Log in with the following credentials:</span></p><ul><li><p><span>IAM user name: Enter </span><code>paulo</code></p></li><li><p><span>Password: To find the password, choose </span><strong><span>AWS Details</span></strong><span> above the student instructions in the lab environment.</span></p></li></ul></li></ul></li><li><p><span>Test whether the </span><em><span>paulo</span></em><span> user can open or download the </span><em><span>loan-data.csv</span></em><span> file:</span></p><ul><li><p><span>Navigate to the Amazon S3 console.</span></p></li><li><p><span>Choose the link for </span><strong><span>data-bucket</span></strong><span>.</span></p></li><li><p><span>Choose the link for the </span><strong><span>loan-data.csv</span></strong><span> object.</span></p></li><li><p><span>Choose </span><strong><span>Open</span></strong><span> or </span><strong><span>Download</span></strong><span>.</span></p><p><span>A message indicates that access is denied.</span></p></li></ul></li><li><p><span>When done testing, log out and exit the incognito browser tab.</span></p></li></ul><p><strong><span>Example answer to the question</span></strong><span> </span><em><span>"Can you imagine a scenario where the security policies you applied would be useful to AnyCompany Financial?"</span></em><span> : This example shows that even if an employee (Sofia) uploaded a document with sensitive data to a bucket that can be accessed by people who shouldn't have access to the document (Paulo), those users won't be able to read the document if it's encrypted. Only those users who should be allowed to read the document have access to the encryption key.</span></p><p>&nbsp;</p><h3 id="a-idp3t4atask-34-use-aws-kms-to-encrypt-the-root-volume-of-an-ec2-instance"><a id="p3t4"></a><span>Task 3.4: Use AWS KMS to encrypt the root volume of an EC2 instance</span></h3><p><a href="file:///C:/Users/chara/Downloads/IG.html#top" target="_self"><span>Return to table of contents</span></a></p><p><em><span>Reference the lab instructions for details about what students should do in this task.</span></em></p><p><strong><span>Solution to step 1:</span></strong></p><ul><li><p><span>Return to the browser tab where you are logged in with the </span><em><span>voclabs</span></em><span> role.</span></p></li><li><p><span>Navigate to the Amazon EC2 console.</span></p></li><li><p><span>Choose </span><strong><span>Launch instance</span></strong><span> &gt; </span><strong><span>Launch instance</span></strong><span> and configure the following:</span></p><ul><li><p><span>Name: </span><code>EncryptedInstance</code></p></li><li><p><span>Amazon Machine Image (AMI): Choose </span><strong><span>Amazon Linux 2 AMI (HVM)</span></strong><span>.</span></p><p><i class="fa-solid fa-circle-exclamation" aria-label="Important icon"></i><span>  </span><strong><span>Important:</span></strong><span> You must choose Amazon Linux 2 (not Amazon Linux 2023) as the AMI type.</span></p></li><li><p><span>Instance type: </span><strong><span>t2.micro</span></strong></p></li><li><p><span>Key pair name: </span><strong><span>vockey</span></strong></p></li><li><p><span>In the </span><strong><span>Network settings</span></strong><span> section, choose </span><strong><span>Edit</span></strong><span> and configure the following:</span></p><ul><li><p><span>VPC: </span><strong><span>NetworkFirewallVPC</span></strong><span> </span></p></li><li><p><span>Subnet: </span><strong><span>WebServer2Subnet</span></strong><span> </span></p></li><li><p><span>Firewall (security groups): </span><strong><span>Select existing security group</span></strong></p></li><li><p><span>Common security groups: </span><strong><span>WebServer2SecurityGroup</span></strong></p></li></ul></li><li><p><span>In the </span><strong><span>Configure storage</span></strong><span> section:</span></p><ul><li><p><span>Choose </span><strong><span>Advanced</span></strong><span>.</span></p></li><li><p><span>Expand the </span><strong><span>Volume 1</span></strong><span> details. </span></p></li><li><p><span>Encrypted: </span><strong><span>Encrypted</span></strong><span> </span></p></li><li><p><span>KMS key: </span><strong><span>MyKMSKey</span></strong></p></li></ul></li><li><p><span>Expand the </span><strong><span>Advanced details</span></strong><span> area.</span></p></li><li><p><span>For </span><strong><span>IAM instance profile</span></strong><span>, choose </span><strong><span>WebServerInstanceProfile</span></strong><span>.</span></p></li><li><p><span>At the bottom of the page, choose </span><strong><span>Launch instance</span></strong><span>. </span></p></li></ul><p>&nbsp;</p></li></ul><p><strong><span>Solution to step 2:</span></strong></p><ul><li><p><span>In the Amazon EC2 console, choose </span><strong><span>Instances</span></strong><span>.</span></p></li><li><p><span>Choose the </span><strong><span>Instance ID</span></strong><span> link for </span><strong><span>EncryptedInstance</span></strong><span>.</span></p></li><li><p><span>Choose the </span><strong><span>Storage</span></strong><span> tab. </span></p><p><span>In this view, you should see that the value in the </span><strong><span>Encrypted</span></strong><span> column is </span><em><span>Yes</span></em><span>. The KMS key ID is displayed and should match the key ID of </span><em><span>MyKMSKey</span></em><span>.</span></p><p><span>The tab should look similar to the following image:   </span></p><p><img src="file:///C:/Users/chara/Downloads/images/encrypted-volume.png" referrerpolicy="no-referrer" alt="Encrypted volume view"></p></li></ul><p>&nbsp;</p><h3 id="a-idp3t5atask-35-use-aws-kms-envelope-encryption-to-encrypt-data-in-place"><a id="p3t5"></a><span>Task 3.5: Use AWS KMS envelope encryption to encrypt data in place</span></h3><p><a href="file:///C:/Users/chara/Downloads/IG.html#top" target="_self"><span>Return to table of contents</span></a></p><p><em><span>Reference the lab instructions for details about what students should do in this task.</span></em></p><p><strong><span>Solution to step 1:</span></strong></p><ul><li><p><span>Navigate to the Amazon EC2 console.</span></p></li><li><p><span>Choose </span><strong><span>Instances</span></strong><span>.</span></p></li><li><p><span>Select the </span><strong><span>WebServer2</span></strong><span> instance, and then choose </span><strong><span>Connect</span></strong><span>.</span></p></li><li><p><span>On the </span><strong><span>EC2 Instance Connect</span></strong><span> tab, choose </span><strong><span>Connect</span></strong><span>.</span></p></li></ul><p><strong><span>Steps 2–6:</span></strong><span> </span><em><span>Full click-level guidance is available in the student lab instructions.</span></em></p><p>&nbsp;</p><h3 id="a-idp3t6atask-36-use-aws-kms-to-encrypt-a-secrets-manager-secret"><a id="p3t6"></a><span>Task 3.6: Use AWS KMS to encrypt a Secrets Manager secret</span></h3><p><a href="file:///C:/Users/chara/Downloads/IG.html#top" target="_self"><span>Return to table of contents</span></a></p><p><em><span>Reference the lab instructions for details about what students should do in this task.</span></em></p><p><strong><span>Solution to step 1:</span></strong></p><ul><li><p><span>Navigate to the Secrets Manager console.</span></p></li><li><p><span>Choose </span><strong><span>Store a new secret</span></strong><span> and configure the following:</span></p><ul><li><p><span>Secret type: </span><strong><span>Other type of secret</span></strong></p></li><li><p><span>In the </span><strong><span>Key/value pairs</span></strong><span> section:</span></p><ul><li><p><span>First field (key): </span><code>secret</code></p></li><li><p><span>Second field (value): </span><code>my secret data</code></p></li></ul></li><li><p><span>Encryption key: </span><strong><span>MyKMSKey</span></strong></p></li><li><p><span>Choose </span><strong><span>Next</span></strong><span>.</span></p></li><li><p><span>Secret name: </span><code>mysecret</code><span>  </span></p><p><i class="fa-solid fa-note-sticky" aria-label="Note icon"></i><span> </span><strong><span>Note:</span></strong><span>  This is how you will access the secret through the API.</span></p></li><li><p><span>Choose </span><strong><span>Next</span></strong><span>.</span></p></li><li><p><span>Keep automatic rotation </span><em><span>disabled</span></em><span>, and choose </span><strong><span>Next</span></strong><span>.</span></p></li><li><p><span>Choose </span><strong><span>Store</span></strong><span>.</span></p><p>&nbsp;</p></li></ul></li></ul><p><strong><span>Solution to step 2:</span></strong></p><ul><li><p><span>Navigate to the Amazon EC2 console.</span></p></li><li><p><span>Choose </span><strong><span>Instances</span></strong><span>.</span></p></li><li><p><span>Select the </span><strong><span>WebServer2</span></strong><span> instance, and then choose </span><strong><span>Connect</span></strong><span>.</span></p></li><li><p><span>On the </span><strong><span>EC2 Instance Connect</span></strong><span> tab, choose </span><strong><span>Connect</span></strong><span>.</span></p></li></ul><ul><li><p><span>In the EC2 Instance Connect session, run the following commands to list the secrets in Secrets Manager, store a secret to a variable, and then echo the results: </span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="bash"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: currentcolor;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: currentcolor;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-def">result</span><span class="cm-operator">=</span><span class="cm-quote">$(aws secretsmanager list-secrets)</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">echo</span> <span class="cm-def">$result</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 44px;"></div><div class="CodeMirror-gutters" style="display: none; height: 44px;"></div></div></div></pre></li><li><p><span>Parse the ARN of the </span><em><span>mysecret</span></em><span> key to a new variable named </span><em><span>key_arn</span></em><span>, by running the following command:</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="bash"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: currentcolor;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: currentcolor;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-def">key_arn</span><span class="cm-operator">=</span><span class="cm-quote">$(echo </span><span class="cm-def">$result</span><span class="cm-quote"> |jq '.SecretList[].ARN'|tr -d '"'|grep mysecret)</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">echo</span> <span class="cm-def">$key_arn</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 44px;"></div><div class="CodeMirror-gutters" style="display: none; height: 44px;"></div></div></div></pre></li><li><p><span>To retrieve the secret, run the following command:</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="bash"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: currentcolor;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: currentcolor;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">aws secretsmanager get-secret-value <span class="cm-attribute">--secret-id</span> <span class="cm-def">$key_arn</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 22px;"></div><div class="CodeMirror-gutters" style="display: none; height: 22px;"></div></div></div></pre><p><span>The result should be similar to the following:</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="json"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="json"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: currentcolor;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: currentcolor;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">{</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-string cm-property">"ARN"</span>: <span class="cm-string">"arn:aws:secretsmanager:us-east-1:160211610694:secret:mysecret-MpLOfw"</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-string cm-property">"Name"</span>: <span class="cm-string">"mysecret"</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-string cm-property">"VersionId"</span>: <span class="cm-string">"369d8dcb-fd0a-4fd0-982f-412bddbdf3e2"</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-string cm-property">"SecretString"</span>: <span class="cm-string">"{\"secret\":\"my secret data\"}"</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-string cm-property">"VersionStages"</span>: [</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-string">"AWSCURRENT"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  ],</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-string cm-property">"CreatedDate"</span>: <span class="cm-string">"2023-06-08T16:15:16.808000+00:00"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 220px;"></div><div class="CodeMirror-gutters" style="display: none; height: 220px;"></div></div></div></pre><p>&nbsp;</p></li></ul><h3 id="a-idp3caacost-assessment-for-using-aws-kms"><a id="p3ca"></a><span>Cost assessment for using AWS KMS</span></h3><p><a href="file:///C:/Users/chara/Downloads/IG.html#top" target="_self"><span>Return to table of contents</span></a></p><p><strong><span>Question</span></strong>
<span>In this lab, does your use of AWS KMS result in additional cost in the account? If so, what usage would you be charged for?</span></p><p><strong><span>Answer</span></strong>
<span>When students answer this question, they should attain their information from the </span><a href="https://aws.amazon.com/kms/pricing/"><span>AWS Key Management Service Pricing</span></a><span> page, then think about how the costs described apply to this project. Additional costs associated with this phase:</span></p><ul><li><p><strong><span>Each AWS KMS key:</span></strong><span> You pay a monthly charge for each key that you create.</span></p><p><span>For example, as of the time of this writing, in us-east-1, the cost was $1 per month per symmetric key.</span></p></li><li><p><strong><span>Automatic key rotation:</span></strong><span> If you enable automatic key rotation (which students did), each newly generated backing key incurs an additional cost. </span></p><p><span>For example, as of the time of this writing, in us-east-1, the cost was $1 per month per backing key retained to decrypt older ciphertexts.</span></p></li><li><p><strong><span>Key usage:</span></strong><span> AWS KMS provides a free tier up to a certain number of requests per month. The number of requests included in the free tier depends on the AWS service with which the KMS is being used. </span></p><p><span>For example, as of the time of this writing, in us-east-1, the first 20,000 requests that used the key were free tier. Usage beyond the free tier cost $0.03 per 10,000 requests. Such usage includes, for example:</span></p><ul><li><p><span>KMS key used to encrypte files on S3</span></p></li><li><p><span>KMS key used as a root key for encrypting EBS volumes</span></p><p>&nbsp;</p></li></ul></li></ul><p><i class="fa-solid fa-lightbulb" aria-label="Tip icon"></i><span> </span><strong><span>Tip:</span></strong><span> Have students focus on </span><em><span>what</span></em><span> customers are charged for instead of the actual dollar amount. An estimate of the actual cost could be considered extra effort.</span></p><p>&nbsp;</p><p>&nbsp;</p><h2 id="a-idp4aphase-4-monitoring-and-logging"><a id="p4"></a><span>Phase 4: Monitoring and logging</span></h2><p><a href="file:///C:/Users/chara/Downloads/IG.html#top" target="_self"><span>Return to table of contents</span></a></p><!--PER PRODUCT TEAM: currDev will add the diagram.--><h3 id="a-idp4t1atask-41-use-cloudtrail-to-record-amazon-s3-api-calls"><a id="p4t1"></a><span>Task 4.1: Use CloudTrail to record Amazon S3 API calls</span></h3><p><a href="file:///C:/Users/chara/Downloads/IG.html#top" target="_self"><span>Return to table of contents</span></a></p><p><em><span>Reference the lab instructions for details about what students should do in this task.</span></em></p><p>&nbsp;</p><p><strong><span>Solution to step 1</span></strong><span>:</span></p><ul><li><p><span>Navigate to the CloudTrail console.</span></p></li><li><p><span>To open the navigation pane, choose the menu icon (</span><i class="fas fa-bars"></i><span>).</span></p></li><li><p><span>Choose </span><strong><span>Trails</span></strong><span>.</span></p></li><li><p><span>Choose </span><strong><span>Create trail</span></strong><span> and configure the following:</span></p><p><i class="fa-solid fa-circle-exclamation" aria-label="Important icon"></i><span>  </span><strong><span>Important</span></strong><span>: Don't choose the option to create a trail from the main CloudTrail console page. This option takes you to the </span><em><span>Quick trail create</span></em><span> wizard, which won't provide you an opportunity to specify some of the configurations you will want.</span></p><ul><li><p><span>Trail name: </span><code>data-bucket-reads-writes</code></p></li><li><p><span>Storage location: </span><strong><span>Use existing S3 bucket</span></strong></p></li><li><p><span>Trail log bucket name: Choose </span><strong><span>Browse</span></strong><span>, choose the </span><strong><span>cloudtrail-logs</span></strong><span> bucket, and then select </span><strong><span>Choose</span></strong><span>.</span></p></li><li><p><span>Clear the </span><strong><span>Enabled</span></strong><span> check box for log file SSE-KMS encryption.</span></p></li><li><p><span>Choose </span><strong><span>Next</span></strong><span>.</span></p></li><li><p><span>Event type: Select </span><strong><span>Management events</span></strong><span> </span><em><span>and</span></em><span> </span><strong><span>Data events</span></strong><span>.</span></p></li><li><p><span>API activity: Keep </span><strong><span>Read</span></strong><span> and </span><strong><span>Write</span></strong><span> selected.</span></p></li><li><p><span>Data event type: </span><strong><span>S3</span></strong></p></li><li><p><span>Log selector template: </span><strong><span>Log all events</span></strong></p></li><li><p><span>Choose </span><strong><span>Next</span></strong><span>.</span></p></li><li><p><span>Choose </span><strong><span>Create trail</span></strong><span>.</span></p><p>&nbsp;</p></li></ul></li></ul><p><strong><span>Step 2:</span></strong><span> </span><em><span>Full click-level guidance is available in the student lab instructions.</span></em></p><p>&nbsp;</p><p><strong><span>Solution to step 3:</span></strong></p><ul><li><p><span>Navigate to the Amazon S3 console.</span></p></li><li><p><span>Choose the link for </span><strong><span>data-bucket</span></strong><span>.</span></p></li><li><p><span>Choose </span><strong><span>Upload</span></strong><span>.</span></p></li><li><p><span>Choose </span><strong><span>Add files</span></strong><span>.</span></p></li><li><p><span>Browse to and select the </span><strong><span>customer-data.csv</span></strong><span> file, and then choose </span><strong><span>Open</span></strong><span>.</span></p></li><li><p><span>Choose </span><strong><span>Upload</span></strong><span>.</span></p></li><li><p><span>Choose </span><strong><span>Close</span></strong><span>.</span></p></li><li><p><span>Choose the link for the </span><strong><span>customer-data.csv</span></strong><span> object.</span></p></li></ul><ul><li><p><span>Choose </span><strong><span>Open</span></strong><span>.</span></p><p><i class="fa-solid fa-note-sticky" aria-label="Note icon"></i><span> </span><strong><span>Note:</span></strong><span> Uploading the file generates a </span><em><span>PutObject</span></em><span> event in the CloudTrail trail. Choosing the link to open the object generates a </span><em><span>GetObject</span></em><span> event in the trail.</span></p><p>&nbsp;</p></li></ul><p><strong><span>Solution to step 4:</span></strong><span> </span></p><ul><li><p><span>Navigate to the CloudTrail console.</span></p></li><li><p><span>To open the navigation pane, choose the menu icon (</span><i class="fas fa-bars"></i><span>).</span></p></li><li><p><span>Choose </span><strong><span>Event history</span></strong><span>.</span></p></li><li><p><span>Choose </span><strong><span>Create Athena table</span></strong><span>.</span></p></li><li><p><span>For </span><strong><span>Storage location</span></strong><span>, choose the </span><strong><span>cloudtrail-logs</span></strong><span> bucket.</span></p></li><li><p><span>Choose </span><strong><span>Create table</span></strong><span>.</span></p><p>&nbsp;</p></li></ul><p><strong><span>Step 5:</span></strong><span> </span><em><span>Full click-level guidance is available in the student lab instructions.</span></em></p><ul><li><p><span>Navigate to the Athena console.</span></p></li><li><p><span>In the </span><strong><span>Tables</span></strong><span> area, to the right of the </span><strong><span>cloudtrail_logs</span></strong><span> table name, choose the ellipsis icon, and then choose </span><strong><span>Preview Table</span></strong><span>.</span></p><p><span>10 rows of data appear in the </span><strong><span>Results</span></strong><span> area. </span></p><p><strong><span>Important</span></strong><span>: Typically, CloudTrail delivers events within 5 minutes of an API call. You might need to wait a few minutes and then try to preview the table again before it returns results. Verify that data is returned in the preview before continuing to the next step.</span></p></li><li><p><span>Copy and paste the following query into a new query tab, but </span><em><span>don't</span></em><span> run it yet:</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="sql"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="sql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: currentcolor;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: currentcolor;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">SELECT</span> eventtime<span class="cm-punctuation">,</span> useridentity<span class="cm-variable-2">.principalid</span><span class="cm-punctuation">,</span> requestparameters<span class="cm-punctuation">,</span> eventname</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">FROM</span> <span class="cm-operator">&lt;</span><span class="cm-keyword">table</span> name<span class="cm-operator">&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">WHERE</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  eventname <span class="cm-keyword">in</span> <span class="cm-bracket">(</span><span class="cm-string">'PutObject'</span><span class="cm-bracket">)</span> <span class="cm-keyword">AND</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  requestparameters <span class="cm-keyword">LIKE</span> <span class="cm-string">'%customer-data.csv%'</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">limit</span> <span class="cm-number">10</span><span class="cm-punctuation">;</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 132px;"></div><div class="CodeMirror-gutters" style="display: none; height: 132px;"></div></div></div></pre></li><li><p><span>Replace </span><code>&lt;table name&gt;</code><span> with the name of the </span><em><span>cloudtrail_logs</span></em><span> table that you just created, which appears in the </span><strong><span>Tables</span></strong><span> area on the left side of the screen.</span></p></li><li><p><span>Choose </span><strong><span>Run</span></strong><span>.</span></p><p>&nbsp;</p></li></ul><p><strong><span>Solution to step 6:</span></strong></p><ul><li><p><span>In the Athena console, copy and paste the following query into the query editor:</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="sql"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="sql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: currentcolor;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: currentcolor;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">SELECT</span> eventtime<span class="cm-punctuation">,</span> useridentity<span class="cm-variable-2">.principalid</span><span class="cm-punctuation">,</span> requestparameters<span class="cm-punctuation">,</span> eventname<span class="cm-punctuation">,</span> sourceipaddress<span class="cm-punctuation">,</span> useragent</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">FROM</span> <span class="cm-operator">&lt;</span><span class="cm-keyword">table</span> name<span class="cm-operator">&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">WHERE</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  eventname <span class="cm-keyword">in</span> <span class="cm-bracket">(</span><span class="cm-string">'GetObject'</span><span class="cm-bracket">)</span> <span class="cm-keyword">AND</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  requestparameters <span class="cm-keyword">LIKE</span> <span class="cm-string">'%customer-data.csv%'</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">limit</span> <span class="cm-number">10</span><span class="cm-punctuation">;</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 154px;"></div><div class="CodeMirror-gutters" style="display: none; height: 154px;"></div></div></div></pre></li><li><p><span>Replace </span><code>&lt;table name&gt;</code><span> with the name of the </span><em><span>cloudtrail_logs</span></em><span> table, which appears in the </span><strong><span>Tables</span></strong><span> area on the left side of the screen.</span></p></li><li><p><span>Choose </span><strong><span>Run</span></strong><span>. </span></p><p><strong><span>Analysis:</span></strong><span> The results are similar to what is returned for the PutObject event. However, the </span><em><span>eventname</span></em><span> is now </span><em><span>GetObject</span></em><span>. The </span><strong><span>sourceipaddress</span></strong><span> column shows the IP address of the computer that the GetObject request was made from. The </span><strong><span>useragent</span></strong><span> column shows the browser type that was used to make the request. </span></p></li></ul><p>&nbsp;</p><h3 id="a-idp4t2atask-42-use-cloudwatch-logs-to-monitor-secure-logs"><a id="p4t2"></a><span>Task 4.2: Use CloudWatch Logs to monitor secure logs</span></h3><p><a href="file:///C:/Users/chara/Downloads/IG.html#top" target="_self"><span>Return to table of contents</span></a></p><p><em><span>Reference the lab instructions for details about what students should do in this task.</span></em></p><p>&nbsp;</p><p><strong><span>Solution to step 1:</span></strong></p><ul><li><p><span>Navigate to the CloudWatch console.</span></p></li><li><p><span>In the navigation pane, choose </span><strong><span>Log groups</span></strong><span>.</span></p></li><li><p><span>Choose </span><strong><span>Create log group</span></strong><span> and configure the following:</span></p><ul><li><p><span>Log group name: </span><code>EncryptedInstanceSecureLogs</code></p></li><li><p><span>Retention setting: Keep the default of </span><strong><span>Never expire</span></strong><span>.</span></p></li><li><p><span>Choose </span><strong><span>Create</span></strong><span>.</span></p></li></ul></li></ul><p><strong><span>Solution to step 2:</span></strong></p><ul><li><p><span>Navigate to the Amazon EC2 console.</span></p></li><li><p><span>Choose </span><strong><span>Instances</span></strong><span>.</span></p></li><li><p><span>Select the </span><strong><span>EncryptedInstance</span></strong><span> instance, and then choose </span><strong><span>Connect</span></strong><span>.</span></p></li><li><p><span>On the </span><strong><span>EC2 Instance Connect</span></strong><span> tab, choose </span><strong><span>Connect</span></strong><span>.</span></p></li><li><p><span>In the EC2 Instance Connect session, run the following commands to install the CloudWatch agent and a Linux daemon named collectd, which the CloudWatch agent will use:</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="bash"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: currentcolor;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: currentcolor;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">sudo</span> yum install <span class="cm-attribute">-y</span> amazon-cloudwatch-agent</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">sudo</span> amazon-linux-extras install <span class="cm-attribute">-y</span> collectd</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 44px;"></div><div class="CodeMirror-gutters" style="display: none; height: 44px;"></div></div></div></pre></li></ul><p>&nbsp;</p><p><strong><span>Steps 3–4:</span></strong><span> </span><em><span>Full click-level guidance is available in the student lab instructions</span></em></p><p>&nbsp;</p><p><strong><span>Solution to step 5:</span></strong></p><ul><li><p><span>Choose </span><strong><span>AWS Details</span></strong><span> above these lab instructions, and then choose </span><strong><span>Download PEM</span></strong><span>.</span></p><p><span>A file named </span><em><span>labsuser.pem</span></em><span> will be downloaded to your computer.</span></p></li><li><p><span>Navigate to the AWS Cloud9 console.</span></p></li><li><p><span>In the environments list, choose the </span><strong><span>Open</span></strong><span> link for the </span><strong><span>Cloud9Instance</span></strong><span> environment.</span></p></li><li><p><span>Choose </span><strong><span>File</span></strong><span> &gt; </span><strong><span>Upload Local Files</span></strong><span>.</span></p></li><li><p><span>Choose </span><strong><span>Select files</span></strong><span>.</span></p></li><li><p><span>Browse to and select the </span><strong><span>labsuser.pem</span></strong><span> file, and choose </span><strong><span>Open</span></strong><span>.</span></p></li><li><p><span>When the file appears in the file panel of the IDE, close the Upload Files dialog box by choosing the </span><strong><span>X</span></strong><span> icon in the top-right corner.</span></p><p><strong><span>Tip</span></strong><span>: Before you run the next command, you might want to arrange your browser tabs so that you can see the EC2 Instance Connect session that you still have open from the previous step.</span></p></li><li><p><span>In the AWS Cloud9 bash terminal, run the following commands. Replace </span><code>EncryptedInstance-public-IP</code><span> with the public IPv4 address of the </span><em><span>EncryptedInstance</span></em><span>:</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="bash"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: currentcolor;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: currentcolor;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">chmod</span> <span class="cm-number">400</span> labsuser.pem</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">ssh</span> <span class="cm-attribute">-i</span> labsuser.pem ec2-user@EncryptedInstance-public-IP</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 44px;"></div><div class="CodeMirror-gutters" style="display: none; height: 44px;"></div></div></div></pre></li><li><p><span>When prompted if you are sure that you want to connect, enter </span><code>yes</code></p><p><span>The connection should succeed. In the EC2 Instance Connect session, you should see that lines were recorded in the </span><em><span>/var/log/secure</span></em><span> file when you ran the previous commands.</span></p></li><li><p><span>In the AWS Cloud9 bash terminal, run the following commands to disconnect from the SSH session and then try to connect with a username that isn't valid. Replace </span><code>EncryptedInstance-public-IP</code><span> with the public IPv4 address of the </span><em><span>EncryptedInstance</span></em><span>:</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="bash"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: currentcolor;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: currentcolor;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">exit</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">ssh</span> <span class="cm-attribute">-i</span> labsuser.pem ubuntu@EncryptedInstance-public-IP</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 44px;"></div><div class="CodeMirror-gutters" style="display: none; height: 44px;"></div></div></div></pre><p><strong><span>Tip</span></strong><span>: To find the the public IP address of the EncryptedInstance. </span></p><ul><li><p><span>Navigate to the Amazon EC2 console.</span></p></li><li><p><span>Choose </span><strong><span>Instances</span></strong><span>.</span></p></li><li><p><span>Select the </span><strong><span>EncryptedInstance</span></strong><span> instance.</span></p><p><span>Details about the instance appear in the lower pane.</span></p></li><li><p><span>On the </span><strong><span>Details</span></strong><span> tab, copy the public IPv4 address.</span></p></li></ul><p><span>The connection attempt fails with a "Permission denied" message.</span></p></li></ul><p>&nbsp;</p><p><strong><span>Solution to step 6:</span></strong></p><ul><li><p><span>Navigate to the CloudWatch console.</span></p></li><li><p><span>In the navigation pane, choose </span><strong><span>Log groups</span></strong><span>.</span></p></li><li><p><span>Choose the link for </span><strong><span>EncryptedInstanceSecureLogs</span></strong><span>.</span></p></li><li><p><span>Open the latest log stream.</span></p></li><li><p><span>Toward the bottom of the log stream, you should see an event that is similar to the following:</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="bash"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: currentcolor;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: currentcolor;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">...Accepted publickey <span class="cm-keyword">for</span> ec2-user from ...</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 22px;"></div><div class="CodeMirror-gutters" style="display: none; height: 22px;"></div></div></div></pre></li><li><p><span>Expand the event to view the details, which should look similar to the following:</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="bash"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: currentcolor;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: currentcolor;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Jun &nbsp;<span class="cm-number">9</span> <span class="cm-number">17</span>:08:35 ip-10-1-3-6 sshd[4051]: Accepted publickey <span class="cm-keyword">for</span> ec2-user from <span class="cm-number">52</span>.201.134.169 port <span class="cm-number">39414</span> ssh2: RSA SHA256:3tFXUjTgeK...</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 44px;"></div><div class="CodeMirror-gutters" style="display: none; height: 44px;"></div></div></div></pre><p><strong><span>Analysis:</span></strong><span> This example log entry indicates that a user at the IP address for the AWS Cloud9 instance successfully logged in to the </span><em><span>EncryptedInstance</span></em><span> on June 9 using the SSH protocol. When the login occurred, the public key for ec2-user was accepted.</span></p></li><li><p><span>To observe the failed attempt to access the EncryptedInstance, filter the log events for </span><code>Invalid user</code></p><p><span>You should see an event that is similar to the following:</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="bash"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: currentcolor;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: currentcolor;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Jun <span class="cm-number">9</span> <span class="cm-number">17</span>:08:47 ip-10-1-3-6 sshd[4092]: Invalid user ubuntu from <span class="cm-number">52</span>.201.134.169 port <span class="cm-number">35418</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 22px;"></div><div class="CodeMirror-gutters" style="display: none; height: 22px;"></div></div></div></pre><p><strong><span>Analysis:</span></strong><span> This example entry indicates that someone, or a bot, attempted to access the </span><em><span>EncryptedInstance</span></em><span> through SSH with the invalid user </span><em><span>ubuntu</span></em><span>. This incident is an example of a bot attempting a brute force login to the </span><em><span>EncryptedInstance</span></em><span>. The result set that you see may very well include many log entries of failed log attempts not initiated by you. This is not uncommon.</span></p><p>&nbsp;</p><p>&nbsp;</p></li></ul><h3 id="a-idp4t3atask-43-create-a-cloudwatch-alarm-to-send-notifications-for-security-incidents"><a id="p4t3"></a><span>Task 4.3: Create a CloudWatch alarm to send notifications for security incidents</span></h3><p><a href="file:///C:/Users/chara/Downloads/IG.html#top" target="_self"><span>Return to table of contents</span></a></p><p><em><span>Reference the lab instructions for details about what students should do in this task.</span></em></p><p>&nbsp;</p><p><strong><span>Solution to step 1:</span></strong></p><ul><li><p><span>Navigate to the CloudWatch console.</span></p></li><li><p><span>In the navigation pane, choose </span><strong><span>Log groups</span></strong><span>.</span></p></li><li><p><span>Choose the link for </span><strong><span>EncryptedInstanceSecureLogs</span></strong><span>.</span></p></li><li><p><span>Choose the </span><strong><span>Metric filters</span></strong><span> tab.</span></p></li><li><p><span>Choose </span><strong><span>Create metric filter</span></strong><span> and configure the following:</span></p><ul><li><p><span>Filter pattern: </span><code>"Invalid user"</code><span> (Be sure to include the quotation marks.)</span></p></li><li><p><span>In the </span><strong><span>Test pattern</span></strong><span> section:</span></p><ul><li><p><span>Select log data to test: </span><strong><span>EncryptedInstanceSecureLogs...</span></strong></p></li><li><p><span>Choose </span><strong><span>Test pattern</span></strong><span>.</span></p><p><span>The test results should display at least one event (the log entry from when you tried to log in as </span><em><span>ubuntu</span></em><span>).</span></p></li></ul></li><li><p><span>Choose </span><strong><span>Next</span></strong><span>.</span></p></li><li><p><span>Filter name: </span><code>Not valid users</code></p></li><li><p><span>Metric namespace: </span><code>secure</code></p></li><li><p><span>Metric name: </span><code>NotValidUsers</code></p></li><li><p><span>Metric value: </span><code>1</code></p></li><li><p><span>Default value: </span><code>0</code></p></li><li><p><span>Unit: </span><strong><span>Count</span></strong></p></li><li><p><span>Choose </span><strong><span>Next</span></strong><span>.</span></p></li><li><p><span>Choose </span><strong><span>Create metric filter</span></strong><span>. </span></p><p>&nbsp;</p></li></ul></li></ul><p><strong><span>Solution to step 2:</span></strong></p><ul><li><p><span>On the details page for the </span><em><span>EncryptedInstanceSecureLogs</span></em><span> log group, on the </span><strong><span>Metric filters</span></strong><span> tab, choose the </span><strong><span>Invalid Users</span></strong><span> metric filter.</span></p></li><li><p><span>Select the check box for the </span><strong><span>Not valid users</span></strong><span> metric filter.</span></p></li><li><p><span>Choose </span><strong><span>Create alarm</span></strong><span>.</span></p><p><span>A new browser tab opens.</span></p></li><li><p><span>Configure the alarm as follows:</span></p><ul><li><p><span>On the </span><strong><span>Specify metric and conditions</span></strong><span> page:</span></p><ul><li><p><span>In the </span><strong><span>Metric</span></strong><span> section, for </span><strong><span>Period</span></strong><span>, choose </span><strong><span>1 day</span></strong><span>.</span></p></li><li><p><span>In the </span><strong><span>Conditions</span></strong><span> section:</span></p><ul><li><p><span>Whenever NotValidUsers is...: </span><strong><span>Greater/Equal</span></strong></p></li><li><p><span>than... </span><code>5</code></p><p><strong><span>Analysis</span></strong><span>: This configuration specifies that, in any given 24-hour period, if /var/log/secure has five entries, which could indicate a malicious attempt to access the server over SSH, the alarm will notify the team.</span></p></li></ul></li><li><p><span>Choose </span><strong><span>Next</span></strong><span>.</span></p></li></ul></li><li><p><span>On the </span><strong><span>Configure actions</span></strong><span> page:</span></p><ul><li><p><span>In the </span><strong><span>Notification</span></strong><span> section:</span></p><ul><li><p><span>Send a notification to the following SNS topic: </span><strong><span>Create new topic</span></strong><span>  </span></p></li></ul></li><li><p><span>Create a new topic...: </span><code>Not_valid_users_exceeding_limit</code></p></li><li><p><span>Email endpoints that will receive the notification...: Enter an email address that you have access to.</span></p></li><li><p><span>Choose </span><strong><span>Create topic</span></strong><span>.</span></p></li><li><p><span>Choose </span><strong><span>Next</span></strong><span>.</span></p></li></ul></li><li><p><span>On the </span><strong><span>Add name and description</span></strong><span> page:</span></p><ul><li><p><span>Alarm name: </span><code>Not valid users exceeding limit on EncryptedInstance</code></p><p><i class="fa-solid fa-note-sticky" aria-label="Note icon"></i><span> </span><strong><span>Note:</span></strong><span> This will also be the subject line in email notifications that are sent based on the alarm.</span></p></li><li><p><span>Alarm description: </span><code>Not valid access attempts over SSH to the EncryptedInstance server have exceeded 4 in the last 24 hours.</code><span> </span></p></li><li><p><span>Choose </span><strong><span>Next</span></strong><span>.</span></p></li></ul></li><li><p><span>Choose </span><strong><span>Create alarm</span></strong><span>. </span></p><p>&nbsp;</p></li></ul></li></ul><p><strong><span>Step 3:</span></strong><span> </span><em><span>Full click-level guidance is available in the student lab instructions.</span></em></p><p><strong><span>Solution to step 4:</span></strong></p><ul><li><p><span>Return to the AWS Cloud9 IDE.</span></p></li><li><p><span>In the bash terminal, run at least five invalid SSH access attempts to connect to the </span><em><span>EncryptedInstance</span></em><span> public IP address over SSH. The following code block provides an example of the commands you could use.</span></p><p><strong><span>Tip</span></strong><span>: Be sure to replace </span><code>EncryptedInstance-Public-IP</code><span> in the first example command with the actual public IPv4 address of the </span><em><span>EncryptedInstance</span></em><span>.</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="bash"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: currentcolor;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: currentcolor;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-def">publicIP</span><span class="cm-operator">=</span><span class="cm-string">"EncryptedInstance-Public-IP"</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">ssh</span> ec2-user@<span class="cm-def">$publicIP</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">ssh</span> <span class="cm-attribute">-i</span> labsuser.pem <span class="cm-builtin">chroot</span>@<span class="cm-def">$publicIP</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">ssh</span> <span class="cm-attribute">-i</span> labsuser.pem random@<span class="cm-def">$publicIP</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">ssh</span> random2@<span class="cm-def">$publicIP</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">ssh</span> random3@<span class="cm-def">$publicIP</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">ssh</span> random4@<span class="cm-def">$publicIP</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 154px;"></div><div class="CodeMirror-gutters" style="display: none; height: 154px;"></div></div></div></pre></li></ul><p><strong><span>Solution to step 5:</span></strong></p><ul><li><p><span>Navigate to the CloudWatch console.</span></p></li><li><p><span>In the navigation pane, choose </span><strong><span>Log groups</span></strong><span>.</span></p></li><li><p><span>Choose the link for </span><strong><span>EncryptedInstanceSecureLogs</span></strong><span>.</span></p></li><li><p><span>Open the latest log stream.</span></p></li><li><p><span>Filter the log events for </span><code>Invalid user</code></p><p>&nbsp;</p></li></ul><p><strong><span>Solution to step 6:</span></strong></p><ul><li><p><span>In the CloudWatch navigation pane, choose </span><strong><span>Alarms</span></strong><span> &gt; </span><strong><span>All alarms</span></strong><span>.</span></p></li><li><p><span>Next, check your email for a notification that the alarm threshold was crossed.</span></p><p>&nbsp;</p></li></ul><h3 id="a-idp4t4atask-44-configure-aws-config-to-assess-security-settings-and-remediate-the-configuration-of-aws-resources"><a id="p4t4"></a><span>Task 4.4: Configure AWS Config to assess security settings and remediate the configuration of AWS resources</span></h3><p><a href="file:///C:/Users/chara/Downloads/IG.html#top" target="_self"><span>Return to table of contents</span></a></p><p><em><span>Reference the lab instructions for details about what students should do in this task.</span></em></p><p><strong><span>Solution to step 1:</span></strong></p><ul><li><p><span>Navigate to the IAM console.</span></p></li></ul><ul><li><p><span>In the navigation pane, choose </span><strong><span>Roles</span></strong><span>.</span></p></li><li><p><span>Review the following IAM roles and their associated IAM policies:</span></p><ul><li><p><strong><span>AWSConfigRole:</span></strong><span> This role was created for you in this lab environment. The role grants permissions that you will need to set up AWS Config.</span></p></li><li><p><strong><span>SSMAutomationRole:</span></strong><span> This is the role that AWS Systems Manager will use when it performs remediation actions with an AWS Config managed rule that you will use.</span></p></li></ul></li></ul><ul><li><p><span>Navigate to the Amazon S3 console.</span></p></li><li><p><span>Review the configuration for the </span><strong><span>aws-config</span></strong><span> bucket. AWS Config will use this bucket for logging purposes.</span></p><p><span>    </span></p></li></ul><p><strong><span>Solution to step 2:</span></strong></p><ul><li><p><span>Navigate to the Amazon S3 console.</span></p></li><li><p><span>On the buckets page, choose </span><strong><span>Create bucket</span></strong><span> and configure the following:</span></p><ul><li><p><span>Bucket name: </span><code>compliance-bucket-unique-ID</code><span> (where </span><code>unique-ID</code><span> is the unique ID that all the other buckets in the account contain)</span></p></li><li><p><span>AWS Region: </span><strong><span>US East (N. Virginia)</span></strong></p></li><li><p><span>Choose </span><strong><span>ACLs enabled</span></strong><span>.</span></p></li><li><p><span>Choose </span><strong><span>Create bucket</span></strong><span>. </span></p><p>&nbsp;</p></li></ul></li></ul><p><strong><span>Step 3:</span></strong><span> </span><em><span>Full click-level guidance is available in the student lab instructions.</span></em></p><p>&nbsp;</p><p><strong><span>Solution to step 4:</span></strong></p><ul><li><p><span>Navigate to the AWS Config console.</span></p></li><li><p><span>Choose </span><strong><span>Get started</span></strong><span> and configure the following: </span></p><ul><li><p><span>Recording strategy: </span><strong><span>Record all current and future resource types supported in this region</span></strong></p></li><li><p><span>AWS Config role: </span><strong><span>Choose a role from your account</span></strong></p></li><li><p><span>Existing roles: </span><strong><span>AWSConfigRole</span></strong></p></li><li><p><span>Amazon S3 bucket: </span><strong><span>Choose a bucket from your account</span></strong></p></li><li><p><span>S3 Bucket name: </span><strong><span>aws-config</span></strong></p></li><li><p><span>Choose </span><strong><span>Next</span></strong><span>.</span></p></li><li><p><span>Don’t select any managed rules.</span></p></li><li><p><span>Choose </span><strong><span>Next</span></strong><span>.</span></p></li><li><p><span>Choose </span><strong><span>Confirm</span></strong><span>.</span></p><p>&nbsp;</p></li></ul></li></ul><p><strong><span>Solution to step 5:</span></strong></p><ul><li><p><span>In the navigation pane of the AWS Config console, choose </span><strong><span>Rules</span></strong><span>.</span></p></li><li><p><span>Choose </span><strong><span>Add rule</span></strong><span> and configure the following:</span></p><ul><li><p><span>Select rule type: </span><strong><span>Add AWS managed rule</span></strong><span> </span></p></li><li><p><span>In the </span><strong><span>AWS Managed Rules</span></strong><span> section, search for and choose the rule named </span><code>s3-bucket-logging-enabled</code></p></li><li><p><span>Choose </span><strong><span>Next</span></strong><span>.</span></p></li><li><p><span>Choose </span><strong><span>Next</span></strong><span> again.</span></p></li><li><p><span>Choose </span><strong><span>Save</span></strong><span>.</span></p></li></ul><p>&nbsp;</p></li></ul><p><strong><span>Solution to step 6:</span></strong></p><ul><li><p><span>In the navigation pane of the AWS Config console, choose </span><strong><span>Rules</span></strong><span>.</span></p></li><li><p><span>Choose the link for the </span><strong><span>s3-bucket-logging-enabled</span></strong><span> rule.</span></p></li><li><p><span>Wait until you see S3 buckets listed in the </span><strong><span>Resources in scope</span></strong><span> section of the page.</span></p><p><i class="fa-solid fa-note-sticky" aria-label="Note icon"></i><span> </span><strong><span>Note:</span></strong><span> If you don't see the bucket listed, you might need to wait up to 15 minutes before it appears. Refresh the page periodically until you see it before continuing.</span></p></li><li><p><span>Notice that the </span><em><span>compliance-bucket</span></em><span> is flagged as </span><em><span>Noncompliant</span></em><span>.</span></p></li><li><p><span>Choose the </span><strong><span>ID</span></strong><span> link for the </span><em><span>compliance-bucket</span></em><span>.</span></p></li><li><p><span>Choose </span><strong><span>Manage Resource</span></strong><span>.</span></p></li><li><p><span>On the </span><strong><span>Properties</span></strong><span> tab, verify that server access logging is disabled.</span></p><p>&nbsp;</p></li></ul><p><strong><span>Steps 7 and 8:</span></strong><span> </span><em><span>Full click-level guidance is available in the student lab instructions.</span></em></p><p>&nbsp;</p><p><strong><span>Solution to step 9:</span></strong></p><ul><li><p><span>Navigate to the Amazon S3 console.</span></p></li><li><p><span>In the buckets list, choose the link for the </span><strong><span>compliance-bucket</span></strong><span>.</span></p></li><li><p><span>Choose </span><strong><span>Properties</span></strong><span>.</span></p></li><li><p><span>Scroll down to the </span><strong><span>Server access logging</span></strong><span> section.</span></p><p><span>Notice that logging is now enabled.</span></p></li></ul><p>&nbsp;</p><h3 id="a-idp4caacost-assessment-for-monitoring-and-logging"><a id="p4ca"></a><span>Cost assessment for monitoring and logging </span></h3><p><a href="file:///C:/Users/chara/Downloads/IG.html#top" target="_self"><span>Return to table of contents</span></a></p><p><strong><span>Question</span></strong></p><p><span>In this lab, does your use of CloudTrail, CloudWatch, and AWS Config security features result in additional cost in the account? If so, how much do you estimate that it will cost?</span></p><p><strong><span>Answer</span></strong></p><p><span>Answers will vary, however the details provided below may be helpful to you as you assess student comprehension.</span></p><p><em><span>CloudTrail</span></em></p><p><span>With CloudTrail, the paid tier has costs for CloudTrail Lake, CloudTrail Insights, and trails. Disregard costs that are associated with CloudTrail Lake and CloudTrail Insights because they aren't used in this project. For trails, the following costs are incurred in this solution:</span></p><ul><li><p><strong><span>Management events delivered to Amazon S3:</span></strong><span> Costs are incurred for each 100,000 management events that are delivered.</span></p></li><li><p><strong><span>Data events delivered to Amazon S3:</span></strong><span> Costs are incurred for each 100,000 data events that are delivered. An example of a data event is when students uploaded the </span><em><span>customer-data.csv</span></em><span> file to a bucket.</span></p></li></ul><p><span>For more information, see the </span><a href="https://aws.amazon.com/cloudtrail/pricing/"><span>AWS CloudTrail Pricing</span></a><span> page.</span></p><p><em><span>CloudWatch</span></em></p><p><span>With CloudWatch, the paid tier has costs for custom alarms and logs, and the solution uses these resources. The following costs are incurred:</span></p><ul><li><p><strong><span>Alarms:</span></strong><span> Alarm costs are incurred by the hour, from the first hour in which your alarm exists. Metric alarms incur costs for each metric that you list in the alarm metric expression (up to 10 metrics using metric math). This is a cost for metrics listed directly in the alarm, per alarm, per month.</span></p></li><li><p><strong><span>Logs:</span></strong><span> You incur charges when logs are transferred out of CloudWatch Logs to Amazon S3. You’re not charged for data transfer in.</span></p><p><i class="fa-solid fa-note-sticky" aria-label="Note icon"></i><span> </span><strong><span>Note:</span></strong><span> Other charges are associated with CloudWatch Logs, but these don’t apply to this project.</span></p></li></ul><p><span>For more information, see the </span><a href="https://aws.amazon.com/cloudwatch/pricing/"><span>Amazon CloudWatch Pricing</span></a><span> page.</span></p><p><em><span>AWS Config</span></em></p><p><span>With AWS Config, the paid tier has costs for the number of configuration items that are recorded, active AWS Config rule evaluations, and conformance pack evaluations in your account. This lab project doesn’t use conformance pack evaluations.</span></p><ul><li><p><strong><span>Configuration items:</span></strong><span> A configuration item is recorded when a resource undergoes a configuration change or a relationship change. The resource could be an AWS, third-party, or custom resource. A relationship defines how a resource is related to other resources within an AWS account. As a result, even when no new resources are created (such as when a security group is attached to an EC2 instance), a configuration item can be recorded.</span></p></li><li><p><strong><span>AWS Config rules:</span></strong><span> You’re charged based on the number of AWS Config rule evaluations that are recorded. A rule evaluation is recorded every time a resource is evaluated for compliance against an AWS Config rule. Rule evaluations can be run in detective mode or proactive mode, if available. For more information about these modes, see </span><a href="https://docs.aws.amazon.com/config/latest/developerguide/evaluate-config_manage-rules.html"><span>Adding, Updating, and Deleting AWS Config Rules</span></a><span> in the </span><em><span>AWS Config Developer Guide</span></em><span>. If you’re running a rule in both detective mode and proactive mode, you will be charged for only the evaluations in detective mode.</span></p></li></ul><p><span>For more information, see the </span><a href="https://aws.amazon.com/config/pricing/"><span>AWS Config Pricing</span></a><span> page.</span></p><p>&nbsp;</p><p><a href="file:///C:/Users/chara/Downloads/IG.html#top" target="_self"><span>Return to table of contents</span></a></p><p>&nbsp;</p><h3 id="a-idapp2areferences"><a id="app2"></a><span>References</span></h3><p><a href="file:///C:/Users/chara/Downloads/IG.html#top" target="_self"><span>Return to table of contents</span></a></p><p><span>An online Linux Bash reference is </span><a href="https://linux.die.net/man/" target="_blank" class="url">https://linux.die.net/man/</a><span>. Students can type a command into the search box at the top of that page to learn more about that command.</span></p><p><strong><span>Phase 1</span></strong></p><ul><li><p><a href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/storage-inventory.html#storage-inventory-contents"><span>Amazon S3 Inventory - Amazon Simple Storage Service</span></a></p></li><li><p><a href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/ServerLogs.html"><span>S3 server logs documentation</span></a></p></li><li><p><a href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/using-s3-access-logs-to-identify-requests.html#querying-s3-access-logs-for-requests"><span>Athena - table definition schema</span></a><span>.</span></p></li></ul><p><strong><span>Phase 2</span></strong></p><ul><li><p><a href="https://docs.aws.amazon.com/vpc/latest/userguide/flow-logs-records-examples.html"><span>Flow log record examples - Amazon Virtual Private Cloud</span></a></p></li><li><p><a href="https://www.whatismyip.com/"><span>whatismyip.com</span></a><span>: A way to find your public IP address</span></p></li><li><p><a href="https://www.whatismyip.com/"><span>Use the [AWS Pricing Calculator](https://calculator.aws) to create a cost estimate.</span></a></p></li><li><p><a href="https://aws.amazon.com/architecture/icons/"><span>AWS Architecture Icons</span></a><span>: This site provides tools to draw AWS architecture diagrams.</span></p></li><li><p><a href="https://aws.amazon.com/architecture/reference-architecture-diagrams"><span>AWS Reference Architecture Diagrams</span></a><span>: This site provides a list of AWS architecture diagrams for various use cases. You might want to use these diagrams as references.</span></p></li></ul><p><strong><span>Phase 3</span></strong></p><ul><li><p><a href="https://docs.aws.amazon.com/kms/latest/developerguide/rotate-keys.html"><span>Rotating AWS KMS keys - AWS Key Management Service (amazon.com)</span></a></p></li><li><p><a href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/UsingServerSideEncryption.html?icmpid=docs_s3_hp_properties_encryption_key_type"><span>Protecting data using server-side encryption with Amazon S3 managed encryption keys (SSE-S3) - Amazon Simple Storage Service</span></a></p></li></ul><p><strong><span>Phase 4</span></strong></p><ul><li><p><a href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/cloudtrail-logging.html"><span>Logging Amazon S3 API calls using AWS CloudTrail - Amazon Simple Storage Service</span></a></p></li><li><p><a href="https://docs.aws.amazon.com/config/latest/developerguide/s3-bucket-policy.html"><span>Permissions for the Amazon S3 Bucket - AWS Config</span></a></p></li><li><p><a href="https://docs.aws.amazon.com/config/latest/developerguide/evaluate-config_use-managed-rules.html"><span>AWS Config Managed Rules</span></a></p></li><li><p><a href="https://docs.aws.amazon.com/config/latest/developerguide/s3-bucket-logging-enabled.html"><span>s3-bucket-logging-enabled - AWS Config (amazon.com)</span></a></p></li><li><p><a href="https://docs.aws.amazon.com/systems-manager-automation-runbooks/latest/userguide/automation-aws-configures3bucketlogging.html"><span>AWS-ConfigureS3BucketLogging - AWS Systems Manager Automation runbook reference (amazon.com)</span></a></p></li></ul><p><a href="file:///C:/Users/chara/Downloads/IG.html#top" target="_self"><span>Return to table of contents</span></a></p><p>&nbsp;</p><p><span>© 2023, Amazon Web Services, Inc. or its affiliates. All rights reserved.</span></p></div></div>

</body></html>